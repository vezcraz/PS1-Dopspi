window.Chegg_Search_Define = function($,jQuery,_,Backbone,Eggshell){!function(e,t){return e=e||global,e.EVENTS_NO_REQUIRE?void(e.Events=t()):void("object"==typeof exports?module.exports.Events=t():e.Events=t())}(this,function(){function e(e,t){return e.indexOf?e.indexOf(t):String.prototype.indexOf(e,t)}function t(e){if(g.strict)throw new Error(e);"console"in window&&(console.error?console.error(e):console.warn?console.warn(e):console.log(e))}function s(e){return e.replace(/^on([A-Z])/,function(e,t){return t.toLowerCase()})}function i(e){var s=e.match(b);return e.split(":").length>2&&t("Library does not support multiple pseudo events"),{name:s[1],pseudo:s[2],args:s[3]}}function r(e){return i(s(e))}function n(e,t,s,i){var r;return m?(r=document.createEvent("UIEvents"),r.initUIEvent(e,i,!0,window,1)):r={},r.dispatcher=t,r.args=s,r.object_event=!0,r}function o(t,s,i){m?t.$event_element.addEventListener(s,i,!1):t.$events[s]?-1==e(t.$events[s],i)&&t.$events[s].push(i):t.$events[s]=[i]}function a(e,t,s){var i,r;if(m)e.$event_element.dispatchEvent(s);else{if(!e.$events[t])return;for(i=0;r=e.$events[t][i];i++)r.apply(null,[s])}}function l(t,s,i){var r;if(m)t.$event_element.removeEventListener(s,i,!1);else{if(!t.$events[s])return;if(r=e(t.$events[s],i),0>r)return;t.$events[s].splice(r,1)}}var c,h,d,u,p,g,f,m=!1,b=/([^:]+)(?:\:([^(]*)(?:\((.*)\))?)?/;try{m=document&&"addEventListener"in document}catch(v){}return g=function y(e,t){var s,i=this,r="$event_element $latched $events $once addEvent addEvents fireEvent removeEvent addEventOnce fireLatchedEvent".split(" ");m?this.$event_element=e||document.createElement("events"):this.$events={},this.$has_events=!0,this.$latched={},this.$once={},this.addEvent=c,this.addEvents=h,this.fireEvent=d,this.removeEvent=u,this.addEventOnce=p,this.fireLatchedEvent=f;for(s in y.aliases)this[s]=this[y.aliases[s]],r.push(s);t||this.addEvent("destroy:delay(0)",function(){var e,t;if(!i.$no_ev_destroy){for(e=0;t=r[e];e++)i[t]=null;i.$events_destroyed=!0}})},g.removeOn=s,g.getPseudos=i,g.processType=r,g.createEvent=n,g.strict=!1,g.aliases={on:"addEvent",addListener:"addEvent",once:"addEventOnce",removeListener:"removeEvent",off:"removeEvent",emit:"fireEvent"},g.Pseudoes={once:{addEvent:function(e,t){return this.addEventOnce(e,t)}},latched:{fireEvent:function(e,t){return this.fireLatchedEvent(e,t)}},times:{addEvent:function(e,t,s){var i=0,r=this;this.addEvent(e,function n(){t.apply(null,arguments),i+=1,i==s&&r.removeEvent(e,n)})}},delay:{addEvent:function(e,t,s){this.addEvent(e,function(){setTimeout(t,s)})},fireEvent:function(e,t,s){var i=this;setTimeout(function(){i.fireEvent(e,t)},s)}}},c=function(e,t){if(this.$events_destroyed)return this;var s,i=r(e),a=g.Pseudoes[i.pseudo]&&g.Pseudoes[i.pseudo].addEvent,l=this.$latched[i.name]&&this.$latched[i.name].args;return a?a.apply(this,[i.name,t,i.args]):(o(this,i.name,t),this.$latched&&this.$latched[i.name]&&(s=n(i.name,this,l),t.apply(null,[s])),this)},h=function(e){if(this.$events_destroyed)return this;var t;for(t in e)e.hasOwnProperty(t)&&this.addEvent(t,e[t]);return this},d=function(e,t,s){if(this.$events_destroyed)return this;var i,o,l,c=r(e),h=g.Pseudoes[c.pseudo]&&g.Pseudoes[c.pseudo].fireEvent;if(null==s&&(s=!0),h)return h.call(this,c.name,t);if(l=this.$once[c.name],this.$once[c.name]=null,i=n(c.name,this,t,s),a(this,c.name,i),!l)return this;for(;o=l.pop();)this.removeEvent(c.name,o,!0);return this},u=function(t,s,i){if(this.$events_destroyed)return this;var n,o=r(t);return l(this,o.name,s),!i&&this.$once[o.name]&&(n=e(this.$once[o.name],s))>-1&&this.$once[o.name].splice(n,1),this},p=function(t,s){if(this.$events_destroyed)return this;var i=r(t);return this.$once[i.name]||(this.$once[i.name]=[]),-1==e(this.$once[i.name],s)&&this.$once[i.name].push(s),this.addEvent(i.name,s)},f=function(e,t){return this.$events_destroyed?this:(this.$latched||(this.$latched={}),this.$latched[e]={args:t},this.fireEvent(e,t),this)},g.addEvent=c,g.addEvents=h,g.addEventOnce=p,g.fireEvent=d,g.fireLatchedEvent=f,g.removeEvent=u,g.processType=r,g}),Eggshell.define("C.common.bookcover",{inputs:["show","hide","set book image","set book alt","set book link","set book cover size","set book cover type","set book data","get book data","turn on shadow","turn off shadow","add class"],outputs:["ready","error","clicked","returned book data"]},Backbone.View.extend({events:{"click a":"bookOnClick"},initialize:function(){this.model=new Backbone.Model,this.$el.addClass("centered shadow-enabled"),"undefined"!=typeof $.browser&&$.browser&&$.browser.msie&&$.browser.version<=8&&this.$el.addClass("ie-old"),Eggshell.find(this).on("set book cover type",this.setBookCoverType).on("set book cover size",this.setBookCoverSize).on("set book image",this.setBookImage).on("set book alt",this.setBookAlt).on("set book link",this.setBookLink).on("add class",this.setBookClassName).on("turn on shadow",this.enableShadow).on("turn off shadow",this.disableShadow).on("set book data",this.setData).on("get book data",this.getData).trigger("ready")},setData:function(e,t){this.model.set("data",t)},getData:function(){Eggshell.find(this).trigger("returned book data",this.model.get("data"))},render:function(){this.$el.removeClass("img-wrapper"),this.$el.empty();var e=this.$el;if(this.model.get("image")){this.model.get("link")&&(e=$("<a></a>").attr("href",this.model.get("link")).appendTo(this.$el)),this.$el.hasClass("centered")&&e.addClass("img-wrapper");var t=$("<img/>").appendTo(e);t.error($.proxy(function(){this.$el.addClass("error"),this.$("img").remove(),this.Eggshell.trigger("error")},this)),t.attr("src",this.model.get("image"))}},setBookCoverType:function(e,t){if(!t||"string"!=typeof t)throw"Invalid book cover type. Type needs to be a string value.";this.$el.removeClass("flexible centered shadow-enabled img-wrapper"),"flexible"===t?this.$el.addClass("flexible"):"centered"===t&&this.$el.addClass("centered shadow-enabled")},setBookCoverSize:function(e,t){if(!t||"string"!=typeof t)throw"Invalid book cover size. Size needs to be a string value.";this.$el.removeClass("large medium small"),"small"===t?this.$el.addClass("small"):"medium"===t?this.$el.addClass("medium"):"large"===t&&this.$el.addClass("large")},setBookImage:function(e,t){if(!t&&"string"!=typeof t)throw"Invalid book image url. Url needs to be a string value.";this.model.set("image",t),this.render()},setBookAlt:function(e,t){if(!t&&"string"!=typeof t)throw"Invalid book alt. Alt needs to be a string value.";this.$("img").attr("alt",t)},setBookLink:function(e,t){if(!t&&"string"!=typeof t)throw"Invalid link. Link needs to be a string value.";this.model.set("link",t),this.render()},setBookClassName:function(e,t){if(!t&&"string"!=typeof t)throw"Invalid class name";this.$("img").addClass(t)},enableShadow:function(){this.$el.addClass("shadow-enabled")},disableShadow:function(){this.$el.removeClass("shadow-enabled")},bookOnClick:function(e){this.Eggshell.trigger("clicked")}})),function(e){var t={init:function(s){var i=e.extend({items:1,itemsOnPage:1,pages:0,displayedPages:5,edges:2,currentPage:1,hrefTextPrefix:"#page-",hrefTextSuffix:"",prevText:"Prev",nextText:"Next",ellipseText:"&hellip;",cssStyle:"light-theme",labelMap:[],selectOnClick:!0,onPageClick:function(e,t){},onInit:function(){}},s||{}),r=this;return i.pages=i.pages?i.pages:Math.ceil(i.items/i.itemsOnPage)?Math.ceil(i.items/i.itemsOnPage):1,i.currentPage=i.currentPage-1,i.halfDisplayed=i.displayedPages/2,this.each(function(){r.addClass(i.cssStyle+" simple-pagination").data("pagination",i),t._draw.call(r)}),i.onInit(),this},selectPage:function(e){return t._selectPage.call(this,e-1),this},prevPage:function(){var e=this.data("pagination");return e.currentPage>0&&t._selectPage.call(this,e.currentPage-1),this},nextPage:function(){var e=this.data("pagination");return e.currentPage<e.pages-1&&t._selectPage.call(this,e.currentPage+1),this},getPagesCount:function(){return this.data("pagination").pages},getCurrentPage:function(){return this.data("pagination").currentPage+1},destroy:function(){return this.empty(),this},drawPage:function(e){var s=this.data("pagination");return s.currentPage=e-1,this.data("pagination",s),t._draw.call(this),this},redraw:function(){return t._draw.call(this),this},disable:function(){var e=this.data("pagination");return e.disabled=!0,this.data("pagination",e),t._draw.call(this),this},enable:function(){var e=this.data("pagination");return e.disabled=!1,this.data("pagination",e),t._draw.call(this),this},updateItems:function(e){var s=this.data("pagination");s.items=e,s.pages=t._getPages(s),this.data("pagination",s),t._draw.call(this)},updateItemsOnPage:function(e){var s=this.data("pagination");return s.itemsOnPage=e,s.pages=t._getPages(s),this.data("pagination",s),t._selectPage.call(this,0),this},_draw:function(){var s,i,r=this.data("pagination"),n=t._getInterval(r);t.destroy.call(this),i="function"==typeof this.prop?this.prop("tagName"):this.attr("tagName");var o="UL"===i?this:e("<ul></ul>").appendTo(this);if(r.prevText&&t._appendItem.call(this,r.currentPage-1,{text:r.prevText,classes:"prev"}),n.start>0&&r.edges>0){var a=Math.min(r.edges,n.start);for(s=0;a>s;s++)t._appendItem.call(this,s);r.edges<n.start&&n.start-r.edges!=1?o.append('<li class="disabled"><span class="ellipse">'+r.ellipseText+"</span></li>"):n.start-r.edges==1&&t._appendItem.call(this,r.edges)}for(s=n.start;s<n.end;s++)t._appendItem.call(this,s);if(n.end<r.pages&&r.edges>0){r.pages-r.edges>n.end&&r.pages-r.edges-n.end!=1?o.append('<li class="disabled"><span class="ellipse">'+r.ellipseText+"</span></li>"):r.pages-r.edges-n.end==1&&t._appendItem.call(this,n.end++);var l=Math.max(r.pages-r.edges,n.end);for(s=l;s<r.pages;s++)t._appendItem.call(this,s)}r.nextText&&t._appendItem.call(this,r.currentPage+1,{text:r.nextText,classes:"next"})},_getPages:function(e){var t=Math.ceil(e.items/e.itemsOnPage);return t||1},_getInterval:function(e){return{start:Math.ceil(e.currentPage>e.halfDisplayed?Math.max(Math.min(e.currentPage-e.halfDisplayed,e.pages-e.displayedPages),0):0),end:Math.ceil(e.currentPage>e.halfDisplayed?Math.min(e.currentPage+e.halfDisplayed,e.pages):Math.min(e.displayedPages,e.pages))}},_appendItem:function(s,i){var r,n,o=this,a=o.data("pagination"),l=e("<li></li>"),c=o.find("ul");s=0>s?0:s<a.pages?s:a.pages-1,r={text:s+1,classes:""},a.labelMap.length&&a.labelMap[s]&&(r.text=a.labelMap[s]),r=e.extend(r,i||{}),s==a.currentPage||a.disabled?(a.disabled?l.addClass("disabled"):l.addClass("active"),n=e('<span class="current">'+r.text+"</span>")):(n=e('<a href="'+a.hrefTextPrefix+(s+1)+a.hrefTextSuffix+'" class="page-link" aria-label="Page '+r.text+'">'+r.text+"</a>"),n.click(function(e){return t._selectPage.call(o,s,e)})),r.classes&&n.addClass(r.classes),l.append(n),c.length?c.append(l):o.append(l)},_selectPage:function(e,s){var i=this.data("pagination");return i.currentPage=e,i.selectOnClick&&t._draw.call(this),i.onPageClick(e+1,s)}};e.fn.pagination=function(s){return t[s]&&"_"!=s.charAt(0)?t[s].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof s&&s?void e.error("Method "+s+" does not exist on jQuery.pagination"):t.init.apply(this,arguments)}}(jQuery),Eggshell.define("C.Eggshell.pagination",{inputs:["totalItemsNum","itemsPerPage","currentPage","pages","displayedPages","pageNumAtEdges","previousText","nextText","hrefTextPrefix","hrefTextSuffix","theme","selectOnClick","showPageDesc","limitMaxPages"],outputs:[]},Backbone.View.extend({$el:null,totalItemsNum:1,showPageDesc:!0,itemsPerPage:1,currentPage:1,displayedPages:3,pageNumAtEdges:1,nextText:"Next",previousText:"Previous",hrefTextPrefix:"",hrefTextSuffix:"",theme:"chegg-sunkist-theme",selectOnClick:!1,initialize:function(){this.registerListeners()},render:function(){var e=(this.currentPage-1)*this.itemsPerPage+1,t=e-1+this.itemsPerPage;t=t>this.totalItemsNum?this.totalItemsNum:t;var s=this.totalItemsNum/this.itemsPerPage;this.limitMaxPages&&this.limitMaxPages<s&&(this.totalItemsNum=this.limitMaxPages*this.itemsPerPage),this.$el&&($(this.$el).pagination({items:this.totalItemsNum,itemsOnPage:this.itemsPerPage,currentPage:this.currentPage,displayedPages:this.displayedPages,edges:this.pageNumAtEdges,nextText:this.nextText,prevText:this.previousText,hrefTextPrefix:this.hrefTextPrefix,hrefTextSuffix:this.hrefTextSuffix,selectOnClick:this.selectOnClick,showPageDesc:this.showPageDesc,cssStyle:this.theme}),this.showPageDesc&&$(this.$el).find("ul").before('<div class="item-desc">Showing <span class="startNum">'+e+'</span> - <span class="endNum">'+t+'</span><span class="of"> of </span><span class="totalItemsNum">'+this.totalItemsNum+"</span></div>"),$(this.$el).find("ul li").has(".prev").addClass("prev").end().has(".next").addClass("next"))},registerListeners:function(){this.Eggshell.listen("totalItemsNum",function(e,t){this.throwNumError("totalItemsNum",t),this.totalItemsNum=t}),this.Eggshell.listen("itemsPerPage",function(e,t){this.throwNumError("itemsPerPage",t),this.itemsPerPage=t}),this.Eggshell.listen("currentPage",function(e,t){this.throwNumError("currentPage",t),this.currentPage=t}),this.Eggshell.listen("displayedPages",function(e,t){this.throwNumError("displayedPages",t),this.displayedPages=t}),this.Eggshell.listen("pageNumAtEdges",function(e,t){this.throwNumError("pageNumAtEdges",t),this.pageNumAtEdges=t}),this.Eggshell.listen("nextText",function(e,t){this.nextText=t}),this.Eggshell.listen("previousText",function(e,t){this.previousText=t}),this.Eggshell.listen("hrefTextPrefix",function(e,t){this.hrefTextPrefix=t}),this.Eggshell.listen("hrefTextSuffix",function(e,t){this.hrefTextSuffix=t}),this.Eggshell.listen("theme",function(e,t){this.theme=t}),this.Eggshell.listen("showPageDesc",function(e,t){this.showPageDesc=t}),this.Eggshell.listen("selectOnClick",function(e,t){this.selectOnClick=t}),this.Eggshell.listen("limitMaxPages",function(e,t){this.limitMaxPages=t}),this.Eggshell.listen("render",function(e,t){this.render()})},throwNumError:function(e,t){if(!t||"number"!=typeof t)throw"Invalid "+e},destory:function(){$(this.$el).pagination("destroy")}})),Eggshell.define("C.Eggshell.window.resize.tracker",{inputs:{"trigger resize":{payload:null}},outputs:["resize"],singleton:!0},function(){this.resize=function(){var e=$(window).width(),t=$(window).height();this.viewportWidth&&this.viewportHeight&&this.viewportWidth==e&&this.viewportHeight==t||(this.viewportWidth=e,this.viewportHeight=t,this.Eggshell.trigger("resize",{width:e,height:t}))},$(window).on("resize",$.proxy(function(e){this.resize()},this)),Eggshell.find(this).on("trigger resize",function(){this.resize()},this)}),!function(e,t){function s(e,t,s){var i=e.children(),r=!1;e.empty();for(var o=0,a=i.length;a>o;o++){var l=i.eq(o);if(e.append(l),s&&e.append(s),n(e,t)){l.remove(),r=!0;break}s&&s.detach()}return r}function i(t,s,o,a,l){var c=t.contents(),h=!1;t.empty();for(var d="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style",u=0,p=c.length;p>u&&!h;u++){var g=c[u],f=e(g);"undefined"==typeof g||3==g.nodeType&&0==e.trim(g.data).length||(t.append(f),l&&t[t.is(d)?"after":"append"](l),n(o,a)&&(h=3==g.nodeType?r(f,s,o,a,l):i(f,s,o,a,l),h||(f.remove(),h=!0)),h||l&&l.detach())}return h}function r(t,s,i,r,a){var h=t[0];if(!h)return!1;for(var u=c(h),p=-1!==u.indexOf(" ")?" ":"　",g="letter"==r.wrap?"":p,f=u.split(g),m=-1,b=-1,v=0,y=f.length-1;y>=v&&(0!=v||0!=y);){var k=Math.floor((v+y)/2);if(k==b)break;b=k,l(h,f.slice(0,b+1).join(g)+r.ellipsis),n(i,r)?y=b:(m=b,v=b),y==v&&0==y&&r.fallbackToLetter&&(g="",f=f[0].split(g),m=-1,b=-1,v=0,y=f.length-1)}if(-1==m||1==f.length&&0==f[0].length){var C=t.parent();t.remove();var x=a&&a.closest(C).length?a.length:0;C.contents().length>x?h=d(C.contents().eq(-1-x),s):(h=d(C,s,!0),x||C.remove()),h&&(u=o(c(h),r),l(h,u),x&&a&&e(h).parent().append(a))}else u=o(f.slice(0,m+1).join(g),r),l(h,u);return!0}function n(e,t){return e.innerHeight()>t.maxHeight}function o(t,s){for(;e.inArray(t.slice(-1),s.lastCharacter.remove)>-1;)t=t.slice(0,-1);return e.inArray(t.slice(-1),s.lastCharacter.noEllipsis)<0&&(t+=s.ellipsis),t}function a(e){return{width:e.innerWidth(),height:e.innerHeight()}}function l(e,t){e.innerText?e.innerText=t:e.nodeValue?e.nodeValue=t:e.textContent&&(e.textContent=t)}function c(e){return e.innerText?e.innerText:e.nodeValue?e.nodeValue:e.textContent?e.textContent:""}function h(e){do e=e.previousSibling;while(e&&1!==e.nodeType&&3!==e.nodeType);return e}function d(t,s,i){var r,n=t&&t[0];if(n){if(!i){if(3===n.nodeType)return n;if(e.trim(t.text()))return d(t.contents().last(),s)}for(r=h(n);!r;){if(t=t.parent(),t.is(s)||!t.length)return!1;r=h(t[0])}if(r)return d(e(r),s)}return!1}function u(t,s){return t?"string"==typeof t?(t=e(t,s),t.length?t:!1):t.jquery?t:!1:!1}function p(e){for(var t=e.innerHeight(),s=["paddingTop","paddingBottom"],i=0,r=s.length;r>i;i++){var n=parseInt(e.css(s[i]),10);isNaN(n)&&(n=0),t-=n}return t}function g(e,t){return e?(t="string"==typeof t?"dotdotdot: "+t:["dotdotdot:",t],"undefined"!=typeof window.console&&"undefined"!=typeof window.console.log&&window.console.log(t),!1):!1}if(!e.fn.dotdotdot){e.fn.dotdotdot=function(t){if(0==this.length)return t&&t.debug===!1||g(!0,'No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){e(this).dotdotdot(t)});var r=this;r.data("dotdotdot")&&r.trigger("destroy.dot"),r.data("dotdotdot-style",r.attr("style")),r.css("word-wrap","break-word"),"nowrap"===r.css("white-space")&&r.css("white-space","normal"),r.bind_events=function(){return r.bind("update.dot",function(t,a){t.preventDefault(),t.stopPropagation(),l.maxHeight="number"==typeof l.height?l.height:p(r),l.maxHeight+=l.tolerance,"undefined"!=typeof a&&(("string"==typeof a||a instanceof HTMLElement)&&(a=e("<div />").append(a).contents()),a instanceof e&&(o=a)),m=r.wrapInner('<div class="dotdotdot" />').children(),m.empty().append(o.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var h=!1,d=!1;return c.afterElement&&(h=c.afterElement.clone(!0),c.afterElement.remove()),n(m,l)&&(d="children"==l.wrap?s(m,l,h):i(m,r,m,l,h)),m.replaceWith(m.contents()),m=null,e.isFunction(l.callback)&&l.callback.call(r[0],d,o),c.isTruncated=d,d}).bind("isTruncated.dot",function(e,t){return e.preventDefault(),e.stopPropagation(),"function"==typeof t&&t.call(r[0],c.isTruncated),c.isTruncated}).bind("originalContent.dot",function(e,t){return e.preventDefault(),e.stopPropagation(),"function"==typeof t&&t.call(r[0],o),o}).bind("destroy.dot",function(e){e.preventDefault(),e.stopPropagation(),r.unwatch().unbind_events().empty().append(o).attr("style",r.data("dotdotdot-style")).data("dotdotdot",!1)}),r},r.unbind_events=function(){return r.unbind(".dot"),r},r.watch=function(){if(r.unwatch(),"window"==l.watch){var t=e(window),s=t.width(),i=t.height();t.bind("resize.dot"+c.dotId,function(){s==t.width()&&i==t.height()&&l.windowResizeFix||(s=t.width(),i=t.height(),d&&clearInterval(d),d=setTimeout(function(){r.trigger("update.dot")},10))})}else h=a(r),d=setInterval(function(){var e=a(r);(h.width!=e.width||h.height!=e.height)&&(r.trigger("update.dot"),h=a(r))},100);return r},r.unwatch=function(){return e(window).unbind("resize.dot"+c.dotId),d&&clearInterval(d),r};var o=r.contents(),l=e.extend(!0,{},e.fn.dotdotdot.defaults,t),c={},h={},d=null,m=null;return l.lastCharacter.remove instanceof Array||(l.lastCharacter.remove=e.fn.dotdotdot.defaultArrays.lastCharacter.remove),l.lastCharacter.noEllipsis instanceof Array||(l.lastCharacter.noEllipsis=e.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),c.afterElement=u(l.after,r),c.isTruncated=!1,c.dotId=f++,r.data("dotdotdot",!0).bind_events().trigger("update.dot"),l.watch&&r.watch(),r},e.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0,debug:!1},e.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","　",",",";",".","!","?"],noEllipsis:[]}};var f=1,m=e.fn.html;e.fn.html=function(s){return s!=t&&!e.isFunction(s)&&this.data("dotdotdot")?this.trigger("update",[s]):m.apply(this,arguments)};var b=e.fn.text;e.fn.text=function(s){return s!=t&&!e.isFunction(s)&&this.data("dotdotdot")?(s=e("<div />").text(s).html(),this.trigger("update",[s])):b.apply(this,arguments)}}}(jQuery),C.resource.add("C.Eggshell.text.ellipses.more-link","Show more"),Eggshell.define("C.Search.text.ellipsis",{inputs:["set text","set lines","get text","change more link copy","display more link","display more link with quotes","always display more link"],outputs:["original text","redrawn","read more clicked"]},Backbone.View.extend({text:null,lines:1,textNodes:[],initialize:function(){this.moreText=C.resource.fetch("C.Eggshell.text.ellipses.more-link"),this.registerListeners()},destroy:function(){if(this.textNodes)for(;this.textNodes.length;){var e=this.textNodes.pop();e.unwatch&&e.unwatch()}},render:function(e){if(this.text){var t=this.lines;this.$el.empty();var s=$("<div>").appendTo(this.$el);if(e){if(e&&"a.more-link"==e.after){var i="#";e.link&&(i=e.link);var r=this.text+' <a href="'+i+'" class="more-link">'+this.moreText+"</a>";s.html(r),t++}else if(e&&"span.last-element"==e.after){var i="#";e.link&&(i=e.link);var r='<span class="start-quote"></span> '+this.text+' <span class="last-element"><span class="end-quote"></span> <a href="'+i+'" class="more-link">'+this.moreText+"</a></span>";s.html(r),t++}}else s.html(this.text);var n=this.$el.css("line-height");n&&"0px"!=n||(n=this.$el.css("font-size")),n=parseInt(n);var o=t*n,a={height:o,watch:!0};e&&(a=$.extend(a,e));var l=a.callback;a.callback=$.proxy(function(){$.isFunction(l)&&l.apply(this,arguments),this.Eggshell.trigger("redrawn",arguments)},this),s.addClass("truncated-container"),s.dotdotdot(a),s.css({"line-height":n+"px","max-height":o+"px",overflow:"hidden"}),this.textNodes.push(s)}},registerListeners:function(){this.Eggshell.listen("set text",function(e,t){if("undefined"!=typeof t&&null!=t||(t=""),!t||"string"!=typeof t)throw"Invalid text";this.text=t}),this.Eggshell.listen("set lines",function(e,t){if(!t||"number"!=typeof t)throw"Invalid lines";this.lines=t}),this.Eggshell.listen("get text",function(e,t){this.Eggshell.trigger("original text",this.text)}),this.Eggshell.listen("display more link",function(e,t){this.opts={after:"a.more-link",callback:function(e,t){0==e&&this.$(".more-link").hide()}},this.options.alwaysDisplayMoreLink&&(this.opts.callback=function(){}),t&&"string"==typeof t&&(this.opts.link=t),this.render(this.opts)}),this.Eggshell.listen("display more link with quotes",function(e,t){this.opts={after:"span.last-element",callback:function(e,t){0==e&&this.$(".more-link").hide()}},this.options.alwaysDisplayMoreLink&&(this.opts.callback=function(){}),t&&"string"==typeof t&&(this.opts.link=t),this.render(this.opts)}),this.Eggshell.listen("change more link copy",function(e,t){if(!t||"string"!=typeof t)throw"Invald payload. needs to be string";this.moreText=t}),this.Eggshell.listen("always display more link",function(e,t){this.options.alwaysDisplayMoreLink=!0}),this.Eggshell.listen("destroy",this.destroy)},events:{"click .more-link":"triggerShowMore"},triggerShowMore:function(e){return"#"!=$(e.currentTarget).attr("href")?void this.Eggshell.trigger("read more clicked"):(e.preventDefault(),e.stopPropagation(),this.$el.html(this.$("div").triggerHandler("originalContent")),this.$el.find(".more-link").hide(),void this.Eggshell.trigger("read more clicked"))}})),C.utility.bookCover=C.utility.bookCover||function(e,t,s){s=$.extend({cart:!1,readNowCornerVersion:!1,isOverdue:!1,overdueCornerVersion:!1},s),e=$.extend({},e);var i="",r="",n="",o="",a="";switch(t){case 1:case 2:i=e.imgThumb,o="small",a="tiny";break;case 3:i=e.imgSmall,o="small",a="small";break;case 4:i=e.imgMedium,o="small",a="medium";break;case 5:i=e.imgLarge,o="large",a="large"}if(i&&0!==i.indexOf("http")&&-1===i.indexOf(C.global.coversBaseUrl)&&(i=C.global.coversBaseUrl+i.replace(/^\//,"")),s.hasOwnProperty("type")&&s.type==C.utility.bookCover.tbsType){n='<div class="tbs-book-cover '+a+'"> ';var l;switch(!0){case null!=i:l='<img class="tbs-book-cover-img" src="'+i+'" onerror="this.src=\''+C.global.errorImage+"'\" />";break;default:l='<span class="tbs-title">Solutions</span>'}n+=l,n+='<div class="tbs-bottom-line">by </div></div>'}else{var c="";if(s.cart&&(c="id=book-in-review"),C.utility.isMobile()){var h="";if(_.isObject(s)){switch(s.isSample===!0&&(h="sample "),!0){case s.isOverdue===!0:h+="overdue";break;case s.isRwyw===!0:h+="rwyw";break;case s.isETextbook===!0:h+="etextbook"}"small"==o&&(h+=o)}n='<div class="book-cover '+h+'"><img src="'+i+'" onerror="this.src="'+C.global.errorImage+'"></div>'}else{var d="";"undefined"!=typeof s&&null!==s&&("undefined"!=typeof s.isReadNow&&s.isReadNow?(r='<div class="read-now-strip"></div>',"undefined"!=typeof s.readNowCornerVersion&&s.readNowCornerVersion&&(r='<div class="read-now-corner '+o+'"></div>')):"undefined"!=typeof s.isOverdue&&s.isOverdue?(r='<div class="overdue-strip"></div>',"undefined"!=typeof s.overdueCornerVersion&&s.overdueCornerVersion&&(r='<div class="overdue-corner '+o+'"></div>')):"undefined"!=typeof s.isRwyw&&s.isRwyw?r="undefined"!=typeof s.stripVersion&&s.stripVersion?'<div class="img-courtesy-etextbook-overlay"></div>':'<div class="instant-access">Includes free <span>Instant Access</span></div>':"undefined"!=typeof s.showRwywOverlay&&s.showRwywOverlay&&(d='<div id="rwyw-book-overlay-100" class="icn icon-chegg-etb-courtesy"/>')),n="<div "+c+' class="book-img-'+t,s&&s.noBoxShadow&&(n+=" noBoxShadow"),n+='"><img class="book-cover" src="'+i+'" onerror="this.src=\''+C.global.errorImage+"'\" />",n+=d+r+"</div>"}}return n},C.utility.bookCover.dropdown=1,C.utility.bookCover.thumb=2,C.utility.bookCover.small=3,C.utility.bookCover.medium=4,C.utility.bookCover.large=5,C.utility.bookCover.bookType="book",C.utility.bookCover.tbsType="tbs",Eggshell.define("C.common.tutors",{inputs:["set opportunity modal data","show tutors","set_quick_chat_data","set entity id"],outputs:["error","ready"],singleton:!0},function(){var e=Backbone.Model.extend({getTutors:function(e){var t="undefined"!=typeof e.count?e.count:3,s="undefined"!=typeof e.noSubjectCheck?e.noSubjectCheck:0;$.ajax({context:this,type:"GET",dataType:"JSON",url:"/_ajax/tutors",data:{token:C.global.csrfToken,subjectId:e.subjectId,subjectName:e.subjectName,campaign:e.campaign,limit:t,noSubjectCheck:s},success:function(e){$.isEmptyObject(e)?this.trigger("errored"):(this.set("response",e),this.trigger("loaded"))},error:function(){this.trigger("errored")}})},getSessionVariable:function(e){$.ajax({url:"/_ajax/common/session/get",type:"get",dataType:"json",data:{key:e,token:C.global.csrfToken},context:this,success:function(t){this.set(e,t)},error:function(){this.set(e,{value:"0"})}})},setSessionVariable:function(e,t){$.ajax({url:"/_ajax/common/session/set",type:"get",dataType:"json",data:{key:e,value:t,token:C.global.csrfToken},context:this})},getAccessCode:function(e,t){$.ajax({url:"/_ajax/hwh/grantaccess",type:"get",dataType:"json",data:{assetId:e.assetId,assetType:e.assetType,offer:e.offer,userAgent:e.userAgent,token:C.global.csrfToken},context:this,complete:function(e){var s=$.parseJSON(e.responseText);s&&s.accessCode&&"string"==typeof s.accessCode?this.set("accessCode",s.accessCode):this.set("accessCode",null),this.trigger(t)}})}}),t=Backbone.View.extend({tutorTemplate:_.template('<div class="tutor-container <%= variant %> clearfix"><div class="tutor-headline"></div><div class="tutor-content"></div><div class="tutors-footer"></div></div>'),initialize:function(){this.model=new e,this.setUpListeners()},setUpListeners:function(){this.model.on("loaded",this.render,this),this.model.on("errored",this.renderError,this),this.model.on("do_tbs_opportunity_flow",this.doTbsOpportunityFlow,this),Eggshell.find(this).on("set opportunity modal data",this.setOpportunityModalData).on("show tutors",this.showTutors).on("set entity id",this.setEntityId).on("set_quick_chat_data",this.setupQuickChat)},setEntityId:function(e,t){this.entityId=t},setupQuickChat:function(e,t){this.$quickChatContainerElem=t.elem,this.quickChatExperience=t.experience,this.quickChatOcUrl=t.quickChatOcPath,this.doQuickChat="quickchat"==t.experience,this.doQuickChat&&this.insertQuickChatComponent()},setOpportunityModalData:function(e,t){this.modalContext=t.modalContext,this.modalBody=t.modalBody},showTutors:function(e,t){this.model.getTutors(t),this.source=t.type,this.product=t.product,this.variant=t.variant?t.variant:"",this.subject=t.subjectName,this.subjectId=t.subjectId,this.userHasCsSubscription=t.userHasCsSubscription,this.entityId=t.entityId},render:function(){var e=this.model.get("response"),t=this.tutorTemplate;this.$el.empty(),this.$el.html(t({variant:this.variant})),this.renderTutors(e)},renderTutors:function(e){var t=e.tutors,s=e.url,i=e.exception||null===this.model.get("subjectId")?"Top":this.subject,r='<span class="subject">'+i+"</span> Chegg tutors who can help right now",n='<a href="'+s+'" data-noajax><button class="tutors-cta btn-flat-sm">See more Chegg tutors</button></a>',o=0,a=$(".tutor-content");switch(this.source){case"rightrail":for(this.$(".tutor-headline").html(r),this.$(".tutors-footer").html(n),this.$(".tutors-cta").addClass("rightrail-cta"),o=0;o<t.length;o++)this.displayQnaTutors(t[o],a,"qna");e.exception&&$(".online-indicator ").addClass("hidden"),this.modalContext?($(".tutors-cta").text("Find me a tutor"),this.listenToOpportunityClick()):this.setupDefaultListeners();break;case"tbs":for(this.$(".tutor-headline").html(r),this.$(".tutors-footer").html(n),this.$(".tutors-footer").addClass("tbs-footer"),$(".tutor-container").css({padding:"20px"}),t.length%2==0&&t.splice(t.length-1,1),o=0;o<t.length-1;o+=2)this.displayleftTutor(t[o],a),this.displayRightTutor(t[o+1],a);t.length%2!==0&&this.displayleftTutor(t[o],a),this.modalContext?($(".tutors-cta").text("Find me a tutor"),this.listenToOpportunityClick()):this.setupDefaultListeners();break;case"cshp":for(r="Find an online tutor who can help with your toughest classes. Connect instantly or schedule a convenient time to meet.",o=0;o<t.length-1;o+=2)this.displayleftTutor(t[o],a),this.displayRightTutor(t[o+1],a);$(".tutor-container").addClass("cshp-container"),$(".tutor-card").addClass("cshp-card"),$(".tutor-headline").html(r),$(".tutors-footer").html(n),$(".tutors-cta").html("Find a tutor"),this.setupDefaultListeners()}Eggshell.find(this).trigger("ready")},listenToOpportunityClick:function(){$(".tutor-row, .tutors-cta").on("click",$.proxy(function(e){if(e.preventDefault(),e.stopPropagation(),$(e.currentTarget).hasClass("tutor-row")){var t={tutor_clicked:1};this.tutorsRedirectUrl=$(e.currentTarget).find("a").attr("href")}else{var t={tutors_button_clicked:1};this.tutorsRedirectUrl=$(e.currentTarget).parent().attr("href")}var s="TBS"==this.product?this.doTbsOpportunityClickBehavior(e):this.doGenericOpportunityFlow(e);C.logger.doSessionLog(t,s,{logSubscription:1})},this))},doTbsOpportunityClickBehavior:function(e){if(e.preventDefault(),e.stopPropagation(),this.userHasCsSubscription){var t=this.getGrantAccessData();this.model.getAccessCode(t,"do_tbs_opportunity_flow")}else this.doTbsOpportunityFlow()},doTbsOpportunityFlow:function(){var e=this.model.get("accessCode");"undefined"!=typeof e&&(this.modalBody+="?access_code="+e),this.setOpportunityModalCookie(),C.utility.navigate(this.tutorsRedirectUrl)},doGenericOpportunityFlow:function(e){if(this.doQuickChat){var t=$(e.currentTarget).find("a").data("id");this.openQuickChat(t)}else this.setOpportunityModalCookie(),C.utility.navigate(this.tutorsRedirectUrl)},setOpportunityModalCookie:function(){var e=this.model.get("response"),t=e&&e.instaEduSubjectId?e.instaEduSubjectId:this.subjectId,s=new Date,i=s.getTime();s.setTime(i+6e5);var r=s.toGMTString(),n=".chegg",o=window.location.host.split(n),a=n+o[1],l="control"==this.quickChatExperience?this.modalContext+"_CONTROL":this.modalContext,c='{"formData":{"body":"'+this.modalBody+'","modalContext":"'+l+'","subject":"'+this.subject+'","subjectID":"'+t+'","priority":1,"isBlast":true,"timestamp": '+i+"}}";
document.cookie="messageData="+c+";domain="+a+";path=/; expires="+r},setupDefaultListeners:function(){$tutor=$(".tutor-content .C-common-tutors-tutor"),$tutorsCta=$(".tutors-cta"),$tutor.on("click",$.proxy(function(e){var t=$(e.currentTarget);e.preventDefault(),C.logger.doSessionLog({tutor_clicked:1},function(){location.href=t.find("a").attr("href")},{logSubscription:1})},this)),$tutorsCta.on("click",$.proxy(function(e){e.preventDefault(),C.logger.doSessionLog({tutors_button_clicked:1},function(){location.href=$tutorsCta.parent().attr("href")},{logSubscription:1})},this))},getGrantAccessData:function(){return{assetId:this.entityId,assetType:"TBS",offer:"TBS_SOLUTION_2H_ACCESS",userAgent:"WEB"}},insertQuickChatComponent:function(){this.$quickChatContainerElem.append('<oc-component href="'+this.quickChatOcUrl+'"></oc-component>'),oc.renderUnloadedComponents()},openQuickChat:function(e){var t=this.model.get("response"),s=t&&t.instaEduSubjectId?t.instaEduSubjectId:this.subjectId,i="QNA"==this.product?"QnA":this.product,r={subjectId:s,tutorId:e?e:null,asset:{type:i,id:this.entityId}};window.startQuickChat(r)},displayQnaTutors:function(e,t,s){var i=$('<div class="tutor-row"></div>');Eggshell.create("C.common.tutors.tutor",{el:i}).trigger("get "+s+" tutor",e),t.append(i)},displayleftTutor:function(e,t){var s=$('<div class="tutor-card left-card tutor-row"></div>');Eggshell.create("C.common.tutors.tutor",{el:s}).trigger("get tbs tutor",e),t.append(s)},displayRightTutor:function(e,t){var s=$('<div class="tutor-card right-card tutor-row"></div>');Eggshell.create("C.common.tutors.tutor",{el:s}).trigger("get tbs tutor",e),t.append(s)},renderError:function(){Eggshell.find(this).trigger("error")}});return t}()),Eggshell.define("C.common.tutors.tutor",{inputs:["get qna tutor","get tbs tutor","get mystuff tutor"],outputs:[]},Backbone.View.extend({tutorTemplate:_.template('<a href="<%= uri %>" data-noajax data-id=<%= id %>><div class="online-indicator <%= hidden %>"><div class="circle-icn"></div><div class="check-icn"></div></div><img class="tutor-img" src="<%= picture %>" onError="this.onerror=null;this.src=\'<%= default_picture %>\'"><div class="tutor-info"><div class="name"><%= name %></div><div class="school"><%= school %></div></div><div class="tutor-likes"><div class="thumbs-icn"><div class="reviews"><%= reviews %></div></div></div></a>'),initialize:function(){this.setUpListeners()},setUpListeners:function(){Eggshell.find(this).on("get qna tutor",this.renderQnaTutor,this).on("get tbs tutor",this.renderTbsTutor,this).on("get mystuff tutor",this.renderMyStuffTutor,this)},renderQnaTutor:function(e,t){var s=t.last_name.charAt(0)+".",i=t.first_name+" "+s;this.$el.html(this.tutorTemplate({uri:t.uri,hidden:"",picture:t.image_thumb_small,default_picture:t.default_images.image_thumb_small,name:i,school:t.school,reviews:t.positive_reviews,id:t.id})),t.available_now?this.$(".circle-icn").hide():this.$(".check-icn").hide()},renderTbsTutor:function(e,t){var s=t.last_name.charAt(0)+".",i=t.first_name+" "+s;this.$el.html(this.tutorTemplate({uri:t.uri,hidden:"hidden",picture:t.image_thumb_medium,default_picture:t.default_images.image_thumb_medium,name:i,school:t.school,reviews:t.positive_reviews,id:t.id}))},renderMyStuffTutor:function(e,t){var s=t.last_name.charAt(0)+".",i=t.first_name+" "+s;this.$el.html(this.tutorTemplate({uri:t.uri,hidden:"",picture:t.image_thumb_small,default_picture:t.default_images.image_thumb_small,name:i,school:t.school,reviews:t.positive_reviews,id:t.id})),this.$(".tutor-info").append(this.$(".tutor-likes")),this.$(".check-icn").hide(),t.available_now||3===t.chat_availability||this.$(".circle-icn").hide()}})),Eggshell.define("C.common.search",{inputs:{render:{payload:{ajaxEndpoint:"string",target:"jquery",filters:"object",token:"object"}},"render with profile id":{payload:"string"},renderTabs:{payload:{ajaxEndpoint:"object",target:"jquery",filters:"object",token:"object"}},"hide results":{payload:null},"show a single segway":{payload:"string"},"show no segways":{payload:null},"show no categories":{payload:null},"show no bottom content":{payload:null},"set width to size of input field":{payload:null},"position above target":{payload:null},"set query":{payload:"string"},"set bookstore isbns":{payload:{bookstoreIsbns:"object"}}},outputs:{"search result item clicked":{payload:"object"}},strict:!1},function(){var e=Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render).on("render with profile id",this.renderWithProfileId,this).on("hide results",this.hideResults,this).on("show a single segway",this.showSingleSegway,this).on("show no segways",this.showNoSegways).on("show no bottom content",this.showNoBottomContent).on("show no categories",this.showNoCategories).on("set width to size of input field",this.setWidthToSizeOfInputField).on("position above target",this.positionAboveTarget).on("set bookstore isbns",this.setBookstoreIsbns,this).on("set query",this.setQuery,this).on("override action url",this.overrideActionUrl,this).on("disable all overrides",this.disableAllOverrides,this).on("open results in new tab",this.setOpenResultsInNewTab,this).on("show merged results",this.setMergedResults),this.setHighlightText()},setHighlightText:function(){C.utility.highlightText=function(e,t){var s='<span class="chg-suggest-term">$1</span>',i=(t+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),r=new RegExp("("+i+")","gi");return e.replace(r,s)}},setMergedResults:function(e,t){this.mergedResults=!0,this.overriddenDisplayOrder=["tbs-book","questions","tbs-problem"]},overrideActionUrl:function(e,t){this.overridenActionUrl=t},disableAllOverrides:function(){this.overridenActionUrl=null},setOpenResultsInNewTab:function(e,t){this.openResultsInNewTab=t},renderWithProfileId:function(e,t){!this.mergedResults||"questions-auto"!==t.profile&&"tbs-book-auto"!==t.profile||(t.profile="federated-chegg-study-auto"),$.extend({target:null},t),this.layout&&(Eggshell.find(this.layout).destroy(),t.target&&($(t.target).unbind(),"undefined"!=typeof $(t.target.prev())&&$(t.target.prev()).unbind()));Eggshell.create("C.search.configuration").on("config values for profile id",function(e,s){var i=s.profile;"federated-chegg-study-auto"===i.odinProfileId&&this.mergedResults&&(s.profile.displayOrder=this.overriddenDisplayOrder),this.overridenActionUrl&&!this.mergedResults&&(s.profile.actionUrl=this.overridenActionUrl),this.query&&(s.query=this.query),this.bookstoreIsbns&&(s.bookstoreIsbns=this.bookstoreIsbns),this.layout=Eggshell.create(i.layout,{el:this.$el,config:s,displayOptions:t.displayOptions}),this.openResultsInNewTab&&this.layout.trigger("open results in new tab",!0),this.layout.trigger("render",{target:t.target}),i.immuneToDestroy&&Eggshell.immuneToDestroyAll(this.layout)},this).trigger("get config by profile id",t.profile)},render:function(e,t){if(this.layout&&($(t.target).unbind(),"undefined"!=typeof $(t.target.prev())&&$(t.target.prev()).unbind(),Eggshell.find(this.layout).destroy()),"undefined"!=typeof t.filters.type&&"group"==t.filters.type){var s="";switch(t.ajaxEndpoint){case"/_ajax/search/globallist":s=0===t.tbscount?"textbooks-auto":"federated-auto";break;case"/_ajax/search/tbsserp":s="tbs-book-auto";break;case"/_ajax/search/qnaserp":s="questions-auto";break;case"/_ajax/search/tutors/subjects":s="tutors-auto";break;default:s="federated-auto"}return this.renderWithProfileId(null,{target:t.target,profile:s,displayOptions:t.filters}),!1}this.layout=Eggshell.create("C.common.search.list",{el:this.$el}),this.openResultsInNewTab&&this.layout.trigger("open results in new tab",!0),this.layout.trigger("render",t),Eggshell.immuneToDestroyAll(this.layout)},hideResults:function(){this.layout&&this.layout.trigger("hide")},showSingleSegway:function(e,t){this.layout&&this.layout.trigger("show a single segway",t)},showNoSegways:function(e,t){this.layout&&this.layout.trigger("show no segways",t)},showNoBottomContent:function(e,t){this.layout&&this.layout.trigger("show no bottom content",t)},showNoCategories:function(e,t){this.layout&&this.layout.trigger("show no categories",t)},setWidthToSizeOfInputField:function(e,t){this.layout&&this.layout.trigger("set width to size of input field",t)},positionAboveTarget:function(e,t){this.layout&&this.layout.trigger("position above target",t)},setQuery:function(e,t){this.query=t.query},setBookstoreIsbns:function(e,t){this.bookstoreIsbns=t}});return e}()),C("search"),C.search.config={filters:{},mobile_filters:{all:{title:"All matches",profileId:"mobile-federated-book-srp",queryIntentProfileId:"mobile-federated-question-srp"},books:{title:"Find Books",profileId:"mobile-textbooks-srp"},tbs:{title:"Textbook solutions",profileId:"mobile-tbs-book-srp",queryIntentProfileId:"mobile-tbs-problem-srp",filters:{"tbs-problem":{title:"Problems",profileId:"mobile-tbs-problem-srp"},"tbs-book":{title:"Books",profileId:"mobile-tbs-book-srp"}}},qna:{title:"Expert Q&A",profileId:"mobile-questions-srp"},tutors:{title:"Online Tutors",profileId:"mobile-tutors-srp"}},mobile_filters_intent:{all:{title:"All matches",profileId:"mobile-federated-srp"},books:{title:"Find Books",profileId:"mobile-textbooks-srp"},tbs:{title:"Textbook solutions",profileId:"mobile-tbs-srp",filters:{"tbs-problem":{title:"Problems",profileId:"mobile-tbs-problem-srp"},"tbs-book":{title:"Books",profileId:"mobile-tbs-book-srp"}}},qna:{title:"Expert Q&A",profileId:"mobile-questions-srp"},tutors:{title:"Online Tutors",profileId:"mobile-tutors-srp"}},profiles:{"flashtools-auto":{disableDropdown:!0,odinProfileId:"flashtools-auto",layout:"C.search.autosuggest",type:"auto-suggest",searchData:{chgsec:"nav",chgsubcomp:"as"},textbookSuggestions:!1,displayOrder:[],actionUrl:"flashcards"},"textbooks-auto":{odinProfileId:"textbooks-auto",layout:"C.search.autosuggest",type:"auto-suggest",immuneToDestroy:!0,searchData:{chgsec:"nav",chgsubcomp:"as"},textbookSuggestions:!0,displayOrder:["textbooks"],actionUrl:"/books"},"textbooks-srp":{odinProfileId:"textbooks-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",gridlayout:!0,advertising:"chegg_SS/chegg_ss_searchresults",title:"Books",containerTitle:"Textbooks",iconClass:"books-icon",filters:"true",hideSeeMore:!0,showPagination:"true",searchData:{chgsec:"searchsection",chgsubcomp:"serp",state:!0},displayOrder:["infobox","textbooks"],actionUrl:"/books"},"tbs-book-auto":{odinProfileId:"tbs-book-auto",layout:"C.search.autosuggest",type:"auto-suggest",immuneToDestroy:!0,searchData:{chgsec:"nav",chgsubcomp:"as"},studySuggestions:!0,displayOrder:["tbs-book"],actionUrl:"/study"},"federated-tbs-srp":{odinProfileId:"federated-tbs-problem-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_TextbookSolutions_1",title:"Textbook solutions",iconClass:"tbs-icon",filters:"true",showPagination:"true",hideSeeMore:!0,searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","tbs-book","tbs-problem"],actionUrl:"/study"},"federated-intent-srp":{odinProfileId:"federated-intent-srp",layout:"C.search.serp_v2",gridlayout:!0,type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_Tutors",title:"All matches",searchData:{chgsec:"searchsection",chgsubcomp:"serp",state:!0},displayOrder:["infobox","textbooks","tbs-book","study"],actionUrl:"/federated"},"study-srp":{profile:"study-srp",odinProfileId:"study-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_TextbookSolutions_1",title:"Study",iconClass:"tbs-icon",filters:"true",showPagination:"true",hideSeeMore:!0,searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","tbs-problem","questions","tbs-book"],actionUrl:"/study"},"study-fused-basic-srp":{profile:"study-fused-basic-srp",odinProfileId:"study-fused-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_TextbookSolutions_1",title:"Study",iconClass:"tbs-icon",filters:"true",showPagination:"true",hideSeeMore:!0,searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","study","tbs-book"],actionUrl:"/study"},"study-fused-intent-srp":{profile:"study-fused-intent-srp",odinProfileId:"study-intent-srp",layout:"C.search.serp_v2",gridlayout:!0,type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_TextbookSolutions_1",title:"Study",iconClass:"tbs-icon",filters:"true",showPagination:"true",hideSeeMore:!0,searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["study","tbs-book"],actionUrl:"/study"},"study-fused-filters-srp":{profile:"study-fused-filters-srp",odinProfileId:"study-fused-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_TextbookSolutions_1",title:"Study",iconClass:"tbs-icon",filters:"true",showPagination:"true",hideSeeMore:!0,searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","study","tbs-book"],actionUrl:"/study"},"study-fused-filters-qna-srp":{profile:"study-fused-filters-srp",odinProfileId:"questions-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_TextbookSolutions_1",title:"Study",iconClass:"tbs-icon",filters:"true",showPagination:"true",hideSeeMore:!0,searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","questions"],actionUrl:"/study"},"study-fused-filters-tbs-srp":{profile:"study-fused-filters-srp",odinProfileId:"federated-tbs-problem-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_TextbookSolutions_1",title:"Study",iconClass:"tbs-icon",filters:"true",showPagination:"true",hideSeeMore:!0,searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","tbs-problem","tbs-book"],actionUrl:"/study"},"study-group-srp":{profile:"study-group-srp",odinProfileId:"study-group-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",gridlayout:!0,advertising:"SERP_TextbookSolutions_1",title:"Study",iconClass:"tbs-icon",filters:"true",showPagination:"true",hideSeeMore:!0,searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["study"],actionUrl:"/study"},"tbs-srp":{odinProfileId:"tbs-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.singlefed",advertising:"SERP_TextbookSolutions_1",title:"Textbook solutions",iconClass:"tbs-icon",filters:"true",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","tbs-book"],actionUrl:"/study"},"tbs-book-srp":{odinProfileId:"tbs-book-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.singlefed",advertising:"SERP_TextbookSolutions_1",title:"Textbook solutions",iconClass:"tbs-icon",filters:"true",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","tbs-book"],actionUrl:"/study"},"tbs-problem-srp":{odinProfileId:"tbs-problem-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.singlefed",advertising:"SERP_TextbookSolutions_1",title:"Textbook solutions",iconClass:"tbs-icon",filters:"true",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","tbs-problem"],actionUrl:"/study"},"questions-auto":{odinProfileId:"questions-auto",layout:"C.search.autosuggest",type:"auto-suggest",immuneToDestroy:!0,searchData:{chgsec:"nav",chgsubcomp:"as"},studySuggestions:!0,displayOrder:["questions"],actionUrl:"/study"},"questions-srp":{odinProfileId:"questions-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.singlefed",advertising:"SERP_TextbookSolutions_2",title:"Expert Q&A",iconClass:"qna-icon",filters:"true",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","questions"],actionUrl:"/study"},"federated-auto":{odinProfileId:"federated-auto",layout:"C.search.autosuggest",type:"auto-suggest",immuneToDestroy:!0,searchData:{chgsec:"nav",chgsubcomp:"as"},textbookSuggestions:!0,studySuggestions:!0,displayOrder:["textbooks","tbs-book"],actionUrl:"/federated"},"federated-intent-auto":{odinProfileId:"federated-intent-auto",layout:"C.search.autosuggest",type:"auto-suggest",immuneToDestroy:!0,searchData:{chgsec:"nav",chgsubcomp:"as"},textbookSuggestions:!0,studySuggestions:!0,displayOrder:["textbooks","tbs-book","study"],actionUrl:{textbooks:"/federated",questions:"/study","default":"/federated"}},"federated-reroute-auto":{odinProfileId:"federated-reroute-auto",layout:"C.search.autosuggest",type:"auto-suggest",immuneToDestroy:!0,searchData:{chgsec:"nav",chgsubcomp:"as"},textbookSuggestions:!0,studySuggestions:!0,displayOrder:["textbooks","tbs-book"],actionUrl:{textbooks:"/books",questions:"/study",allmatches:"/federated","default":"/federated"}},"federated-srp":{odinProfileId:"federated-srp",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.federated",advertising:"SERP_Tutors",title:"All matches",searchData:{chgsec:"searchsection",chgsubcomp:"serp",state:!0},displayOrder:["infobox","textbooks","tbs-book"],actionUrl:"/federated"},"federated-chegg-study-auto":{odinProfileId:"federated-chegg-study-auto",layout:"C.search.autosuggest",type:"auto-suggest",immuneToDestroy:!0,searchData:{chgsec:"nav",chgsubcomp:"as"},studySuggestions:!0,actionUrl:{textbooks:"/study",questions:"/study","default":"/study"},displayOrder:["tbs-book","questions"]},"tutors-srp":{odinProfileId:"",identifier:"tutors-fake-profile",layout:"C.search.serp_v2",type:"serp",sublayout:"C.search.serp.singlefed",advertising:"SERP_Tutors",title:"Tutors",iconClass:"tutors-icon",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["infobox","tutors"],actionUrl:"/tutors"},"tutors-auto":{odinProfileId:"",identifier:"tutors-fake-profile",layout:"C.search.autosuggest",type:"auto-suggest",immuneToDestroy:!0,searchData:{chgsec:"nav",chgsubcomp:"as"},actionUrl:"/tutors"},"textbooks-seo-author":{odinProfileId:"textbooks-seo-author",layout:"C.search.serp.singlefed",type:"serp",iconClass:"books-icon",filters:"false",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["textbooks"],actionUrl:"/textbooks"},"mobile-textbooks-srp":{odinProfileId:"textbooks-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"books",searchData:{chgsec:"searchsection",chgsubcomp:"serp",state:!0},displayOrder:["textbooks"],actionUrl:"/books"},"mobile-federated-book-srp":{odinProfileId:"federated-book-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"all",searchData:{chgsec:"searchsection",chgsubcomp:"serp",state:!0},displayOrder:["textbooks","tbs-book","questions","tutors"],actionUrl:"/federated"},"mobile-federated-question-srp":{odinProfileId:"federated-question-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"all",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["tbs-problem","questions"],actionUrl:"/federated"},"mobile-questions-srp":{odinProfileId:"questions-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"qna",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["questions"],actionUrl:"/questions-and-answers"},"mobile-tbs-problem-srp":{odinProfileId:"tbs-problem-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"tbs",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["tbs-problem"],actionUrl:"/textbook-solutions"},"mobile-tbs-srp":{odinProfileId:"tbs-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"tbs",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["tbs-book","tbs-problem"],actionUrl:"/textbook-solutions"},"mobile-tbs-book-srp":{odinProfileId:"tbs-book-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"tbs",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["tbs-book"],actionUrl:"/textbook-solutions"},"mobile-tutors-srp":{odinProfileId:"",layout:"C.search.serp_mobile",type:"serp",tabId:"tutors",searchData:{chgsec:"searchsection",chgsubcomp:"serp"},displayOrder:["tutors"],actionUrl:"/tutors"},"mobile-federated-srp":{odinProfileId:"federated-srp",layout:"C.search.serp_mobile",type:"serp",tabId:"all",searchData:{chgsec:"searchsection",chgsubcomp:"serp",state:!0},displayOrder:["textbooks","tbs-book"],actionUrl:"/federated"}},entityMap:{textbooks:{title:"Textbooks",name:"Books",sectionClass:"books-results",iconClass:"books-icon",seeMore:"Books",seeMoreFull:"More Books",seeMoreUrlSuffix:"/books"},"textbooks-isbn-suggester":{title:"Textbooks",name:"Books",sectionClass:"books-results",iconClass:"books-icon",seeMore:"Books",seeMoreFull:"More Books",seeMoreUrlSuffix:"/books",template:"C.fed.serp.book.gridlayout"},"tbs-book":{title:"Textbook Solutions",name:"Textbook Solutions",sectionClass:"tbs-results",iconClass:"tbs-icon",seeMore:"Textbook Solution Manuals",seeMoreFull:"More Textbook solutions",seeMoreUrlSuffix:"/study"},"tbs-problem":{title:"Textbook Solutions",name:"Textbook Solutions",sectionClass:"tbs-problem-results",iconClass:"tbs-icon",seeMore:"Textbook Solutions",seeMoreFull:"More Textbook solutions",seeMoreUrlSuffix:"/study"},questions:{title:"Expert Q&A",name:"Expert Q&A",sectionClass:"qna-results",iconClass:"qna-icon",seeMore:"Expert Q&A",seeMoreFull:"More Expert Q&A",seeMoreUrlSuffix:"/study"},tutors:{title:"Tutors",name:"Tutors",sectionClass:"tutor-results",iconClass:"tutors-icon",seeMore:"Tutors",seeMoreFull:"More Tutors"},study:{title:"Study results",name:"Study",sectionClass:"study-results",iconClass:"study-icon",seeMore:"Study results",seeMoreFull:"More Expert Q&A",seeMoreUrlSuffix:"/study"}}},Eggshell.define("C.search.ajax",{inputs:["get search result","set config values"],output:["search result","failed search attempt"]},function(e){this.config=null,this.trackId=null,this.strackId=null,this.tryUpdateToken=!1,this.is_mobile=e&&e.mobile,this.getAjaxData=function(e){var t,s=this.config.profile,i=s.searchData;i.profile=s.odinProfileId;var r=e.extraData?e.extraData:{},n=r.page?r.page:1;if("undefined"!=typeof this.config.profile.type&&"auto-suggest"!==this.config.profile.type&&(i["page-number"]=n),"undefined"!=typeof i.state&&i.state){var o=C.utility.getCookie("stid");i.state=o?o:"NoState"}if("study-group-srp"===i.profile&&C.global.grouptype&&(i.grouptype=C.global.grouptype||""),"federated-reroute-auto"===i.profile||"federated-intent-auto"===i.profile){var a=new Date;month=""+(a.getMonth()+1),day=""+a.getDate(),year=a.getFullYear(),month.length<2&&(month="0"+month),day.length<2&&(day="0"+day);var l=[year,month,day].join("-"),c=l+" "+("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2)+":"+("0"+a.getSeconds()).slice(-2);i.users_time=encodeURI(c),i.uuid=C.global.userUuid||"-1",i.subscriber=C.global.hasHwhSubscription||"false",i.season=C.global.season||"NULL"}return this.trackId=r.trackId,this.strackId=r.strackId,t={query:e.query,trackid:this.trackId,strackid:this.strackId,search_data:JSON.stringify(i),token:C.global.csrfToken,event:r.event,target:r.target,auto_type:r.autoType},this.is_mobile&&(t.m_dot=1),t},this.getTrackedUrl=function(e){return e&&(e+="?trackid="+this.trackId+"&strackid="+this.strackId),e},this.setConfigValues=function(e,t){if("object"!=typeof t)throw"Expected Config type is object, got "+typeof t;this.config=t},this.getAjaxUrl=function(){var e="undefined"!=typeof C&&C.global&&C.global.cheggSiteSecureUrl?C.global.cheggSiteSecureUrl:"/";return e+"_ajax/federated/search"},this.getSearchResult=function(e,t){if("object"!=typeof t)throw"Expected payload type is object, got"+typeof query;var s=this.getAjaxData(t),i=t.extraData?t.extraData:{};i.page?parseInt(i.page):1;return this.query=t.query,""==this.config.profile.odinProfileId?void this.getTutorsResults(t):void $.ajax({url:this.getAjaxUrl(),type:"get",dataType:"json",data:s,xhrFields:{withCredentials:!0},context:this,success:function(e){if(null==e)Eggshell.find(this).trigger("failed search attempt",{noResults:!0,dataNull:!0});else{var t=!0,i=!1,r=0,n=0,o=["textbooks","tbs-problem","tbs-book","questions","study","study-suggester","textbooks-suggester"];for(var a in e)if(e.hasOwnProperty(a)&&null!==e[a]&&$.inArray(a,o)>-1){t=!1,n++;var l=e[a].responseContent.docs;if(0==l.length)r++;else if(this.trackId&&this.strackId){for(var c in l){var h=this.getTrackedUrl(l[c].url);if(l[c].url=h,"undefined"!=typeof l[c].tbsUrl){var d=this.getTrackedUrl(l[c].tbsUrl);l[c].tbsUrl=d}}e[a].responseContent.docs=l}}if(r==n&&(i=!0),i||t){var u="";if(e.intents&&0!=e.intents.length&&(u=e.intents),e["textbooks-isbn-suggester"]&&0!=e["textbooks-isbn-suggester"].responseContent.docs.length){var p=e["textbooks-isbn-suggester"].responseContent.docs;if(this.trackId&&this.strackId){for(var c in p){var h=this.getTrackedUrl(p[c].url);p[c].url=h}e["textbooks-isbn-suggester"].responseContent.docs=p}Eggshell.find(this).trigger("failed search attempt",$.extend(e,{noResults:!0,apiError:!1,intent:u})),0!==u.length&&"isbn"===u[0].sourceReference&&(s.filterLoc="fuzzy-match-isbn"),0!==u.length&&"isbn-similar"===u[0].sourceReference&&(s.filterLoc="similar-isbn")}else e.infobox&&0!=e.infobox.responseContent.docs.length?Eggshell.find(this).trigger("failed search attempt",e):Eggshell.find(this).trigger("failed search attempt",{noResults:!0,apiError:!1,intent:u})}else Eggshell.find(this).trigger("search result",e)}this.firehoseSearchEvent(s,e)},error:function(e){Eggshell.find(this).trigger("failed search attempt",{noResults:!0,apiError:!0}),this.firehoseSearchEvent(s,t),e&&"Forbidden"===e.statusText&&!this.tryUpdateToken&&(C.utility.updateCsrfToken(),this.tryUpdateToken=!0)}})},this.firehoseSearchEvent=function(e,t){this.fireHoseComponent.trigger("firehose search event",{ajaxData:e,results:t})},this.getUrlSearchTutorsSubjects=function(){var e="undefined"!=typeof C&&C.global&&C.global.cheggSiteSecureUrl?C.global.cheggSiteSecureUrl:"/";return e+"_ajax/search/tutors/subjects"},this.getTutorsResults=function(e){var t=e.extraData?e.extraData:{},s=t.trackId,i=t.strackId,r=t.page?t.page:1,n=t.source?t.source:"",o=t.count?t.count:void 0,a=this.config.profile.searchData;"autosuggest"===t.event?this.config.profile.searchData.profile="tutors-auto":this.config.profile.searchData.profile="tutors-srp";var l={query:e.query,trackid:s,strackid:i,page:r,count:o,size:10,source:n,token:C.global.csrfToken,event:t.event,target:t.target,search_data:JSON.stringify(a)};$.ajax({url:this.getUrlSearchTutorsSubjects(),type:"get",dataType:"json",data:l,context:this,success:function(e){if(null==e||0==e.count)Eggshell.find(this).trigger("failed search attempt",{noResults:!0,dataNull:!0});else{if(e.trackId&&e.strackId)for(var t in e.searchResult.tutors){var s=this.getTrackedUrl(e.searchResult.tutors[t].url);e.searchResult.tutors[t].url=s}Eggshell.find(this).trigger("search result",e)}this.firehoseSearchEvent(l,e)},error:function(t){Eggshell.find(this).trigger("failed search attempt",{noResults:!0,apiError:!0}),this.firehoseSearchEvent(l,e)}})},this.setListeners=function(){Eggshell.find(this).on("get search result",this.getSearchResult,this).on("set config values",this.setConfigValues,this)},this.initialize=function(){this.setListeners(),this.fireHoseComponent=Eggshell.create("C.search.firehose",{mobile:this.is_mobile})},this.initialize()}),Eggshell.define("C.search.firehose",{inputs:["fire search tracking"],output:["firehose tracking complete"]},function(e){this.is_mobile=e&&e.mobile,this.search_data=null,this.firehoseSearchEvent=function(e,t){var s=t.ajaxData,i=t.results,r=this.getSeason(i),n=this.getSearchIntent(i),o=this.getTotals(s,i),a=this.getPageInfo(),l=JSON.parse(s.search_data),c=this.getSearchResults(s.event),h=this.getSearchGrouping(i),d={track_id:s.trackid,strack_id:s.strackid,search_type:s.event,auto_type:s.auto_type?s.auto_type:" ",query_text:s.query,filter_location:s.filterLoc?s.filterLoc:" ",search_grouping:h?h:" ",search_profile:l.profile,search_page_number:l["page-number"]?l["page-number"]:0,search_page_size:o.pageSize,search_match_count:o.matchCount,search_results:JSON.stringify(c),uuid:C.global.userUuid,hwhSubscriber:C.global.hasHwhSubscription,search_intent:n,season:r};d=JSON.stringify(d);var u={token:C.global.csrfToken,event:s.event,search_data:JSON.stringify(l),target:s.target,digitalData:a,search_event:d};this.firehoseSendData(u)},this.firehoseClickEvent=function(e,t){var s=(this.getPageInfo(),{track_id:t.trackId,strack_id:t.strackId,chgrank:t.clickedRank,target_url:t.clickedUrl,product_id:t.clickedProductId,product_type:t.clickedType,module_name:t.moduleName,module_position:t.modulePosition,uuid:C.global.userUuid});s=JSON.stringify(s);var t={token:C.global.csrfToken,event:t.event,click_event:s};this.firehoseSendData(t)},this.getSearchIntent=function(e){return e&&"undefined"!=typeof e.intents&&null!==e.intents&&e.intents.length>0?e.intents[0].name:" "},this.getSeason=function(e){if(e&&"undefined"!=typeof e.season&&null!==e.season){var t="",i=0;for(s in e.season)e.season[s]&&(t+=0===i?s:","+s,i++);return t}return" "},this.getSearchResults=function(e){var t=[];if("autosuggest"===e)var s=$("ul.searchList li");else if("concept"===e)var s=$(".concept-page ul.search-results li");else if("definition"===e)var s=$(".topic-page ul.search-results li");else var s=$(".serp-list ul li.item-result");return s.each(function(s){var i,r,n,o,a=$(this).attr("class").split(" ");for(var l in a)-1!==a[l].indexOf("rank-")&&(i=a[l].replace("rank-","")),-1!==a[l].indexOf("type-")&&(n=a[l].replace("type-","")),-1!==a[l].indexOf("ent-id-")&&(r=a[l].replace("ent-id-",""),"suggestion"==n&&(r=r.replace(/_/g," "))),-1!=a[l].indexOf("module-pos-")&&(o=a[l].replace("module-pos-",""));if(i&&r&&n){var c={chgentid:r,chgrank:i,chgent:n};o&&(c.module_position=o),e&&n&&(c.module_name=e+"-"+n),t.push(c)}}),t},this.getPageInfo=function(){var e={page:{pageInfo:{pageName:" ",experience:" "},category:{subCategory2:" "}}};if("undefined"!=typeof digitalData&&"undefined"!=typeof digitalData.page){if("undefined"!=typeof digitalData.page.pageInfo||null!==digitalData.page.pageInfo){var t=digitalData.page.pageInfo;e.page.pageInfo.pageName=t.hasOwnProperty("pageName")?t.pageName:""}if("undefined"!=typeof digitalData.page.category||null!==digitalData.page.category){var s=digitalData.page.category;e.page.category.subCategory2=s.hasOwnProperty("subCategory2")?s.subCategory2:""}this.is_mobile?e.page.pageInfo.experience="mobile":e.page.pageInfo.experience="desktop"}return e},this.getTotals=function(e,t){var s=0,i=0;if("tutors-auto"!=e.search_data.profile||"tutors-srp"!=e.search_data.profile){if(t&&"undefined"!=typeof t.order&&null!=t.order){var r=t.order,s=0,i=0;for(var n in r)"undefined"!=typeof t[r[n]]&&(i+=t[r[n]].responseContent.limit,s+=t[r[n]].responseContent.numFound);i>s&&(i=s)}}else i="tutors-auto"==e.search_data.profile?10:3,s=t.count;return{matchCount:s,pageSize:i}},this.firehoseSendData=function(e){$.ajax({url:"/_ajax/search/firehose",type:"post",dataType:"json",data:e,xhrFields:{withCredentials:!0},context:this,success:function(e){Eggshell.find(this).trigger("firehose tracking complete"),"undefined"!=typeof digitalData&&null!==e&&"undefined"!=typeof digitalData.page&&"undefined"!=typeof digitalData.page.pageInfo&&("undefined"==typeof digitalData.page.pageInfo.attributes&&(digitalData.page.pageInfo.attributes={}),digitalData.page.pageInfo.attributes.onsiteSearch=e.searchEvent)},error:function(e){Eggshell.find(this).trigger("firehose tracking complete")}})},this.setListeners=function(){Eggshell.find(this).on("fire search tracking",this.firehoseSendData,this).on("firehose click event",this.firehoseClickEvent,this).on("firehose search event",this.firehoseSearchEvent,this)},this.initialize=function(){this.setListeners()},this.getSearchGrouping=function(e){if(e&&e.study&&"undefined"!=typeof e.study.responseContent)for(var t=1,s=e.study.responseContent.docs,i=0;i<s.length;i++){if(null!=s[i].group_id&&s[i].group_id!=t)return!0;++t}return!1},this.initialize()}),Eggshell.define("C.search.configuration",{inputs:["get config by profile id","get filters","get mobile filters config"],output:["config values for profile id","filters list"]},function(){this.checkAndApplyOverrides=function(e,t){var s=null;if(s&&"undefined"!==s[t]){
var i=s[t];for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e},this.getConfigByProfileId=function(e,t){if("string"!=typeof t)throw"profile Id passed must be a string";var s=this.configData.profiles;if("undefined"==typeof s[t])throw"no config found for provided profile id";var i={},r=s[t],n={};r.filters&&(i=r.filters),this.configData.entityMap&&(n=this.configData.entityMap),r=this.checkAndApplyOverrides(r,t);var o={profile:r,filters:i,entityMap:n};Eggshell.find(this).trigger("config values for profile id",o)},this.getFilters=function(){return this.configData.filters},this.getMobileFilters=function(e,t){var s=this.configData.mobile_filters_intent;t(s)},this.loadAndValidateConfig=function(){if("undefined"==typeof C.search||"undefined"==typeof C.search.config||"object"!=typeof C.search.config)throw"Error loading config, please check config.js";if(this.configData=C.search.config,"undefined"==typeof this.configData.profiles)throw"Failed to load profiles from config file";if("undefined"==typeof this.configData.filters)throw"Failed to load filters from config file"},this.setListeners=function(){Eggshell.find(this).on("get config by profile id",this.getConfigByProfileId,this).on("get filters",this.getFilters).on("get mobile filters config",this.getMobileFilters)},this.initialize=function(){this.setListeners(),this.loadAndValidateConfig()},this.initialize()}),Eggshell.define("C.search.trackid",{inputs:["get track ids","page refreshed","interacting with autosuggest"],output:["track ids"]},function(){this.trackId=null,this.strackId=null,this.pageRefreshed=!1,this.generateTrackId=function(){var e=Math.abs(16777215*Math.random()<<0).toString(16)+Math.abs(16777215*Math.random()<<0).toString(16);return("0000000000000"+e).slice(-12)},this.pageRefreshed=function(){this.trackId=this.generateTrackId(),this.pageRefreshed=!0},this.interactingWithAutosuggest=function(){this.pageRefreshed&&(this.trackId=this.generateTrackId(),this.strackId=this.generateTrackId(),this.pageRefreshed=!1)},this.getStrackId=function(){var e=C.utility.getParams();if(e.strackId||e.strackid)var t={strackid:e.strackId||e.strackid};else var t={strackid:this.strackId};Eggshell.find(this).trigger("strackid set",t)},this.getTrackIds=function(){var e={trackid:this.trackId,strackid:this.strackId};Eggshell.find(this).trigger("track ids",e)},this.loadInitialTrackIdValues=function(){this.strackId=this.generateTrackId(),this.trackId=this.generateTrackId()},this.setListeners=function(){Eggshell.find(this).on("get track ids",this.getTrackIds,this).on("get strackid",this.getStrackId,this).on("page refreshed",this.pageRefreshed,this).on("interacting with autosuggest",this.interactingWithAutosuggest,this)},this.initialize=function(){this.setListeners(),this.loadInitialTrackIdValues()},this.initialize()}),Eggshell.define("C.search.autosuggest",{inputs:["render","open results in new tab","show no segways","show a single segway","show no categories","show no bottom content","set width to size of input field","position above target"],output:[]},function(){var e=Backbone.Model.extend({setData:function(e){if(this.set("searchResults",e),"tutors-fake-profile"===this.config.profile.identifier){this.set("resultSet",e.searchResult);var t=C.utility.getParams(),s=t.no_redirect;e.hasExactMatch&&!s?this.set("urlOverride",this.getTutorsUrl(e.hasExactMatch)):this.set("urlOverride",null)}else this.combineSearchResults()},getTutorsUrl:function(e){var t=e.url,s="undefined"!=typeof C&&C.global&&C.global.cheggSiteSecureUrl?C.global.cheggSiteSecureUrl:"/",i=s+"tutors/"+t+"-online-tutoring/";return i},combineSearchResults:function(){var e=Array(),t=this.get("searchResults");this.displayOrder=this.config.profile.displayOrder,"federated-intent-auto"!==this.config.profile.odinProfileId&&this.detectDisplayOrder(t);for(var s=0;s<this.displayOrder.length;s++){var i=this.displayOrder[s];if(t.hasOwnProperty(i)&&null!==t[i]){var r=t[i].responseContent.docs;if(r.length>0){e[i]=Array();for(var n=0;n<r.length;n++)e[i].push(r[n])}}}this.set("resultSet",e)},setConfig:function(e){this.config=e},setDisplayOptions:function(e){this.set("displayOptions",e||{})},detectDisplayOrder:function(e){$.isArray(e.order)&&(this.displayOrder=e.order)}}),t=Backbone.View.extend({initialize:function(t){if("undefined"==typeof t.config)throw"Config needs to be passed to the layouts, for it to function";this.config=t.config,this.model=new e,this.model.setConfig(this.config),this.model.setDisplayOptions(t.displayOptions),this.firehoseComponent=Eggshell.create("C.search.firehose"),this.ajaxComponent=Eggshell.create("C.search.ajax").on("search result",$.proxy(function(e,t){this.render(t)},this)).on("failed search attempt",$.proxy(function(e,t){this.renderError(t)},this)).trigger("set config values",this.config),this.setListeners(),this.fullWidth=!1,this.singleSegway=null,this.searchResultFormatType="",this.eventType=null,this.eventTarget=null,this.clickedUrl=null,this.clickedRank=null,this.clickedProductId=null,this.clickedType=null,this.filterLocation=null,this.modulePosition=null,this.mouseInDropdown=!1,this.keyboardFocusInDropdown=!1,this.pasteEvent=!1},setTrackIds:function(){Eggshell.find("C.search.trackid").on("track ids",$.proxy(function(e,t){this.trackId=t.trackid,this.strackId=t.strackid},this)).trigger("get track ids")},getEntityInfoByType:function(e){var t=this.config.entityMap;if("undefined"!=typeof t[e])return t[e];throw"Result type missing. Define "+e+"in config.js entityMap"},setListeners:function(){Eggshell.find(this).on("render",this.setup,this).on("update",this.load,this).on("show no segways",this.showNoSegways,this).on("show a single segway",this.showASingleSegway,this).on("show no categories",this.showNoCategories,this).on("show no bottom content",this.showNoBottomContent,this).on("set width to size of input field",this.setWidthToSizeOfInputField,this).on("position above target",this.positionAboveTarget,this).on("open results in new tab",this.setOpenResultsInNewTab,this)},setOpenResultsInNewTab:function(e,t){this.openResultsInNewTab=t},showNoSegways:function(e,t){this.hideSegways=!0},showASingleSegway:function(e,t){this.hideSegways=!1;var s="single-";0===t.indexOf(s)?this.singleSegway=t.substring(s.length):this.singleSegway=t},showNoCategories:function(e,t){this.hideCategories=!0},showNoBottomContent:function(e,t){this.hideButtomContent=!0},setWidthToSizeOfInputField:function(e,t){this.fullWidth=!0},positionAboveTarget:function(e,t){this.positionAboveTarget=!0},goToSearchPage:function(e,t){if(0==e.length)return!1;if(Eggshell.find("C.global.header.rightsection.usermenu").trigger("hide menu"),Eggshell.find("C.global.header.searchbox").trigger("collapse search box"),this.model.get("urlOverride"))return void(location.href=this.model.get("urlOverride"));var s=this.getSERPUrl(),i=encodeURIComponent(e),r=0;this.model.get("resultSet")&&(r=this.model.get("resultSet").length);var n="";if(1==r);this.trackId||this.setTrackIds();var o="undefined"!=typeof C&&C.global&&C.global.cheggSiteSecureUrl?C.global.cheggSiteSecureUrl:"/";if("flashtools-auto"==this.config.profile.odinProfileId)var a=o+s+"/search/"+i+"/1";else var a=C.global.cheggSiteUrl+"search/"+i+s;var l="?trackid="+this.trackId+"&strackid="+this.strackId+"&event="+t+n;this.openResultsInNewTab?window.open(a+l,"_blank"):C.utility.navigate(a+l)},getSERPUrl:function(){var e=this.config.profile.actionUrl;if("string"!=typeof e){var t=this.model.get("searchResults")?this.model.get("searchResults").intents:null,s="";t&&(s=t[0].name),e="undefined"!=typeof e[s]?e[s]:"undefined"!=typeof e["default"]?e["default"]:"/federated"}return e},setup:function(e,t){this.target=$(t.target),this.target.parent().find("a.autosuggest-search-btn").click($.proxy(function(){this.eventType="button_submit",this.fireTrackingSearchEvent(this.target.val());var e=this.target.val();return Eggshell.find("C.search.firehose").on("firehose tracking complete",$.proxy(function(){this.goToSearchPage(e,"button_submit")},this)),!1},this)),this.target.parent().find("a.autosuggest-search-cancel").click($.proxy(function(e){this.resetSearch(e,this.target)},this));var s=_.debounce($.proxy(function(e){this.onKeyUp(e)},this),250,!1);this.target.keyup($.proxy(function(e){s(e)},this)),this.target.click($.proxy(function(e){var t=$(e.target).val();t.length>0&&$(e.target).next().show(),t.length>=2&&this.load({query:t,auto_type:"click_input"})},this)),this.target.blur($.proxy(function(e){this.onTextboxBlur(e,this.target)},this)),this.target.on("paste",$.proxy(function(e){this.pasteEvent=!0,setTimeout($.proxy(function(){var t=$(e.target).val();t.length>0&&$(e.target).next().show(),t.length>=2&&this.load({query:t,auto_type:"paste"})},this),0)},this))},resetSearch:function(e,t){e.preventDefault(),t.val(""),t.next().hide(),this.$currentSelectedItem=null,this.target.parent().find("#autosuggest-input").focus()},onKeyUp:function(e){Eggshell.find("C.search.trackid").trigger("interacting with autosuggest");var t=$(e.target).val();return this.pasteEvent?void(this.pasteEvent=!1):void(40==e.keyCode?(this.doNextSelection(e),e.preventDefault()):38==e.keyCode?(this.doPrevSelection(e),e.preventDefault()):27==e.keyCode?this.hide():13==e.keyCode?(this.onSelectionClick(e),this.$currentSelectedItem=null):46==e.keyCode||8==e.keyCode?t.length<3?this.hide():0===t.length?$(e.target).next().hide():this.load({query:t,auto_type:"delete"}):(t.length>0&&$(e.target).next().show(),t.length>=2&&this.load({query:t,auto_type:"keyup"})))},onTextboxBlur:function(e,t){this.mouseInDropdown||this.keyboardFocusInDropdown||t.is(":focus")||(this.hide(),this.$currentSelectedItem=null)},load:function(e){this.model.set("query",e.query),this.setTrackIds(),this.config.profile.disableDropdown||this.ajaxComponent.trigger("get search result",{query:e.query,extraData:{source:"group",trackId:this.trackId,strackId:this.strackId,event:"autosuggest",autoType:e.auto_type,target:this.target.selector}})},fireTrackingClickEvent:function(e){this.setTrackIds(),this.firehoseComponent.trigger("firehose click event",{strackId:this.strackId,trackId:this.trackId,event:this.eventType,clickedUrl:this.clickedUrl,clickedRank:this.clickedRank,clickedProductId:this.clickedProductId,clickedType:this.clickedType,target:this.target.selector,module_name:"autosuggest-"+this.clickedType,module_position:this.modulePosition})},fireTrackingSearchEvent:function(e){this.setTrackIds(),this.firehoseComponent.trigger("firehose search event",{ajaxData:{query:e,trackid:this.trackId,strackid:this.strackId,search_data:JSON.stringify(this.config.profile.searchData),event:this.eventType,target:this.target.selector,filterLoc:this.filterLocation},results:this.model.get("searchResults")})},createHandleResize:function(){this.resizeTrackerNS||(this.resizeTrackerNS=Eggshell.create("C.Eggshell.window.resize.tracker"),this.resizeTrackerNS.on("resize",this.handleResize,this))},kitkatIntent:function(e){if("federated-intent-auto"!==this.config.profile.odinProfileId)return e;var t=[];if(e&&e["tbs-book"]&&e["tbs-book"].length>0&&e.textbooks&&e.textbooks.length>3){for(var s=0;3>s;s++)t.push(e.textbooks[s]);e.textbooks=t}return e},renderSearchResults:function(e){e=this.kitkatIntent(e);var t=0,s=0;for(var i in e){s++;var r=this.getEntityInfoByType(i),n=e[i],o=this.model.get("displayOptions"),a="up"===o.variant,l=o.count;l&&l>0&&(n=n.slice(0,Math.min(n.length,l))),n=a?n.reverse():n,_.each(n,function(e,n){if("undefined"!=typeof e.url&&(e.url+=this.getTrackUrl(++t),e.url+="&event=click_submit",e.searchBy=this.model.get("query")),"tutors-fake-profile"===this.config.profile.identifier){e.template=e.component;var o=e.id}else if("questions"==i)var o=e.id;else var o=e.ean;var a="";switch(s){case 1:a="center-top";break;case 2:a="center-middle";break;case 3:a="center-bottom";break;default:a="center-bottom"}var l=$('<li class="item-result rank-'+ ++this.chgRank+" type-"+i+" automation-auto-suggest-results-"+i+" ent-id-"+o+" module-pos-"+a+'"></li>');0===n&&this.hideCategories!==!0?(this.$searchList.append($('<li class="category"><div class="category-name"><span>'+r.name+"</span></div></li>")),l.addClass("first"),Eggshell.create(e.template,{el:l.appendTo(this.$searchList),query:this.model.get("query")}).trigger("render",e)):Eggshell.create(e.template,{el:l.appendTo(this.$searchList),query:this.model.get("query")}).trigger("render",e)},this)}},render:function(e){C.global.kitKatSearch&&this.$el.addClass("kitkat"),this.setTrackIds(),this.model.setData(e);var t=this.model.get("resultSet");this.$el.find(".searchList").remove(),this.$el.append($('<ul class="searchList" tabindex="1"></ul>')),this.$el.addClass(this.searchResultFormatType),this.$searchList=this.$el.find(".searchList"),this.chgRank=0,this.positionAboveTarget===!0?(this.renderSearchResults(t),this.addSuggestionEngine()):(this.addSuggestionEngine(),this.renderSearchResults(t)),(C.global.kitKatSearch||C.global.CSHPsimplifiedSearch)&&(this.chgRank++,$("<li class='tutors-link item-result rank-"+this.chgRank+" type-tutors ent-id-link module-pos-center-middle'><a class='tutors-home-link' href='/tutors?event=click_submit' >Find an online tutor</a></li>").appendTo(this.$searchList)),this.searchListBottomContent&&$(this.searchListBottomContent).appendTo(this.$searchList),this.createHandleResize(),this.addBottomContent(),$("input[name='autosuggest-input']").keydown(function(e){9===e.keyCode&&e.shiftKey===!1&&"none"!=$(this.$el).css("display")&&$(".item-result a").length>0&&(e.preventDefault(),this.keyboardFocusInDropdown=!0,$(".item-result a").first().focus())}.bind(this)),this.show(),this.searchListHeight=this.$searchList.height(),this.handleResize()},addSuggestionEngine:function(){var e=this.model.get("searchResults");e&&"undefined"!=typeof e.season&&(this.config.profile.textbookSuggestions&&e.season.RM?this.renderSuggestions("textbooks-suggester"):C.global.searchStudySuggester&&this.config.profile.studySuggestions&&this.renderSuggestions("study-suggester"))},addBottomContent:function(){if(this.hideButtomContent!==!0){var e="?trackid="+this.trackId+"&strackid="+this.strackId,t=encodeURIComponent(this.model.get("query")),s="/search/"+t+this.getSERPUrl()+"/"+e,i=this.openResultsInNewTab?'target="_blank"':"";if(this.model.get("urlOverride")&&(s=this.model.get("urlOverride")+e),"/questions-and-answers"==this.getSERPUrl())var r='<a href="'+s+'&event=filter_submit" class="view-all-link qna-view-all"'+i+'>See all results</a><a class="post-new-question" data-noajax="1" href="/study/qa/post"'+i+'><span class="post-question-icon"></span><span class="post-question-label">Post a new question</span></a>';else if(C.global.kitKatSearch)var r='<a href="'+s+'&event=filter_submit" class="view-all-link"'+i+">See all results</a>";else var r='<a href="'+s+'&event=filter_submit" class="view-all-link"'+i+">View all results</a>";this.setSearchListBottomContent({html:r})}},getTrackUrl:function(e){return"&autosuggest=1&ii="+e+"&uqry="+this.model.get("query")},renderSuggestions:function(e){var t=this.model.get("searchResults"),s=this.model.get("query");if(t&&null!==t[e]&&"undefined"!=typeof t[e]&&"undefined"!=typeof t[e].responseContent.docs&&0!=t[e].responseContent.docs.length){if("textbooks-suggester"===e)var i="/books/";else var i="/study/";for(var r=t[e].responseContent.docs,n="?trackid="+this.trackId+"&strackid="+this.strackId,o=r.length<3?r.length:3,a=0;o>a;a++){var l=r[a].term,c=encodeURIComponent(l),h=C.global.liveSiteUrl+"search/"+c+i+n+"&event=filter_submit&filterloc=suggestion",d=new RegExp(s,"i"),u=l.match(d);null!=u&&0!=u.length&&(l=l.replace(d,'<span class="chg-suggest-term">'+u[0]+"</span>")),$('<li class="item-result category-result rank-'+ ++this.chgRank+" type-suggestion ent-id-"+r[a].term.replace(/ /g,"_")+'"><div class="C-common-search-result-category"><a href="'+h+'"><div class="search-link"><div class="icon-chegg-search"></div><span class="search-query">'+l+"</span></div></a></li>").appendTo(this.$searchList)}}},getNoResultsMsg:function(){if("federated-chegg-study-auto"===this.config.profile.odinProfileId){var e=this.model.get("query");this.$searchList.append(this.noResultMsgTemplate({type:"textbook solutions",query:e}))}},renderCategories:function(e,t){for(var s=0;s<e.length;s++){var i=e[s].url;Eggshell.create("C.common.search.result.category",{el:$('<li class="item-result category-result rank-'+ ++this.chgRank+" type-segway ent-id-"+e[s].type+'"></li>').appendTo(this.$searchList)}).trigger("render",{url:i,searchBy:t,type:e[s].type})}},createCategory:function(e,t){e.length>0&&(this.positionAboveTarget===!0?(this.$searchList.append($('<li class="searchDivider"></li>')),this.renderCategories(e,t)):(this.renderCategories(e,t),this.$searchList.append($('<li class="searchDivider"></li>'))))},getLocation:function(){var e=window.location.pathname,t="";if(-1!==e.indexOf("/")){var s=e.split("/");t=s[3],"homework-help"==s[1]&&void 0!=s[2]&&(t="questions-and-answers"==s[2]?s[2]:"textbook-solutions"),"tutors"==s[1]&&(t="tutors")}return t},handleResize:function(){var e=this.target;this.$searchList=this.$el.find(".searchList");var t=100,s=this.$searchList.offset().top-$(window).scrollTop()+8,i="federated-intent-auto"===this.config.profile.odinProfileId?50:0,r=s+i,n=Math.max(t,r)||t;this.searchListHeight>$(window).height()-n?this.$searchList.height($(window).height()-n):"federated-intent-auto"!==this.config.profile.odinProfileId&&this.$searchList.css({maxHeight:"566px"}),this.fullWidth?this.$searchList.width(e.outerWidth()):"left-aligned"===this.searchResultFormatType?this.$searchList.width(e.outerWidth()+130):this.$searchList.width(e.outerWidth()+115),this.$(".result-header, .result-sub-header, .result-detail").css("maxWidth",(.8*e.width()|0)+"px")},doNextSelection:function(e){var t=this.$el.find(".searchList").find(".item-result"),s=t.index(this.$el.find(".searchList").find(".selected"));if(t.removeClass("selected"),-1==s||s>=t.length-1)var i=t.eq(0).addClass("selected");else var i=t.eq(s+1).addClass("selected");this.changeSelection(i);var r=this.$currentSelectedItem.offset().top-82;0>r&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+r);var n=this.$currentSelectedItem.offset().top+this.$currentSelectedItem.outerHeight()-(this.$el.find(".searchList").outerHeight()+$(".chg-system-message").height()+$(".chg-header").height());n>0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+n)},doPrevSelection:function(e){var t=this.$el.find(".searchList").find(".item-result"),s=t.index(this.$el.find(".searchList").find(".selected"));if(t.removeClass("selected"),-1==s||0===s)var i=t.eq(t.length-1).addClass("selected");else var i=t.eq(s-1).addClass("selected");this.changeSelection(i);var r=this.$currentSelectedItem.offset().top-82;0>r&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+r);var n=this.$currentSelectedItem.offset().top+this.$currentSelectedItem.outerHeight()-(this.$el.find(".searchList").outerHeight()+$(".chg-system-message").height()+$(".chg-header").height());n>0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+n)},changeSelection:function(e){this.$currentSelectedItem=e},onMouseEnterBottomContent:function(e){this.$el.find(".searchList").find(".item-result").removeClass("selected")},renderError:function(e){"object"==typeof newrelic&&newrelic.addPageAction("search",{profile:this.config.profile.odinProfileId,results:"noResults"}),e.noResults&&(this.$el.find(".searchList, .bottom-content").remove(),this.$el.append($('<ul class="searchList"></ul>')),this.$searchList=this.$el.find(".searchList"),this.chgRank=0,this.addSuggestionEngine(),this.getNoResultsMsg(),this.$searchList.height("100%"),this.$searchList.width(this.target.outerWidth()+115),this.show())},show:function(){this.$el.css({display:"block"})},hide:function(){this.$el.css({display:"none"})},setSearchListBottomContent:function(e){this.$(".bottom-content").remove(),e&&e.html&&(this.$el.append(this.bottomListItemTemplate({opts:{content:e.html}})),this.$el.find(".bottom-content").click($.proxy(function(e){this.eventType="filter_submit",this.filterLocation="see_all",this.fireTrackingSearchEvent(this.model.get("query"))},this))),this.fullWidth||this.$(".bottom-content").width(this.target.outerWidth()+115)},bottomListItemTemplate:_.template('<div class="bottom-content"><%= opts.content %></div>'),noResultMsgTemplate:_.template('<li class="no-results-msg">We can\'t find any <%- type %> for <span class="chg-suggest-term search-query"><%- query %>.</span> Please double check the ISBN or the spelling.</li>'),events:{"MSPointerDown .item-result a":"onSelectionClick","mouseover .item-result":"onMouseOverSelection","click .item-result a":"onSelectionClick","keydown .searchList":"onKeyUp","mouseenter .searchList, .bottom-content":"onMouseEnter","mouseleave .searchList":"onMouseLeave","mouseenter .bottom-content":"onMouseEnterBottomContent"},onMouseEnter:function(){this.mouseInDropdown||(this.mouseInDropdown=!0)},onMouseLeave:function(){this.mouseInDropdown&&(this.mouseInDropdown=!1),this.$currentSelectedItem=null,this.$el.find(".searchList").find(".item-result").removeClass("selected")},onMouseOverSelection:function(e){var t=$(e.target).closest(".item-result");t.length&&(this.$el.find(".searchList").find(".item-result").removeClass("selected"),t.addClass("selected"))},onSelectionClick:function(e){var t=this.target.attr("class").toString().split(" ");C.logger.doSessionLog({searchLocation:t[0]});var s=(this.model.get("trackId"),$(e.target).closest(".item-result"));if(s.length&&this.changeSelection(s),null==this.$currentSelectedItem)this.eventType="enter_submit",this.fireTrackingSearchEvent($(e.target).val()),Eggshell.find("C.search.firehose").on("firehose tracking complete",$.proxy(function(){this.goToSearchPage($(e.target).val(),"enter_submit")},this));else{Eggshell.find("C.global.header.searchbox").trigger("collapse search box");var i=this.$currentSelectedItem.find("a").attr("href");this.setSearchTracking(i,$(e.target),this.$currentSelectedItem),Eggshell.find("C.search.firehose").on("firehose tracking complete",$.proxy(function(){var e=C.global.cheggSiteUrl;0!==i.indexOf("http://")&&0!==i.indexOf("https://")||(e=""),this.openResultsInNewTab?window.open(e+i,"_blank"):C.utility.navigate(e+i)},this))}return this.hide(),!1},setSearchTracking:function(e,t,s){if(urlParams=C.utility.getParamsByUrl(e),this.eventType=urlParams.event,"filter_submit"===this.eventType)return query=this.model.get("query"),urlParams.filterloc?this.filterLocation=urlParams.filterloc:this.filterLocation="see_all",void this.fireTrackingSearchEvent(query);if("click_submit"===this.eventType){var i,r,n,o,a=$(s).attr("class").split(" ");for(var l in a)-1!=a[l].indexOf("rank-")&&(i=a[l].replace("rank-","")),-1!=a[l].indexOf("type-")&&(n=a[l].replace("type-","")),-1!=a[l].indexOf("ent-id-")&&(r=a[l].replace("ent-id-","")),-1!=a[l].indexOf("module-pos-")&&(o=a[l].replace("module-pos-",""));return this.clickedUrl=e,this.clickedRank=i,this.clickedProductId=r,this.clickedType=n,this.modulePosition=o,void this.fireTrackingClickEvent()}}});return t}()),Eggshell.define("C.search.serp.federated",{inputs:["render"],output:[]},function(){var e=Backbone.View.extend({initialize:function(e){this.groupedItems=!1,Eggshell.find(this).on("render",this.render,this),Eggshell.find("C.search.trackid").on("track ids",$.proxy(function(e,t){this.trackId=t.trackid},this)).on("strackid set",$.proxy(function(e,t){this.strackId=t.strackid},this)).trigger("get track ids").trigger("get strackid")},render:function(e,t){this.hideSpinner(),this.displayOrder=t.displayOrder,this.renderResults(t.results,t.config),t.config.profile.showPagination&&this.createSerpPagination(t.results,t.config),this.groupedItems&&this.renderGroups(),C.global.hidePriceExp&&this.$el.addClass("hide-price")},renderResults:function(e,t){var s="?trackid="+this.trackId+"&strackId="+this.strackId+"&event=filter_submit";this.renderOrderedResults(e,t,s)},renderOrderedResults:function(e,t,s){var i=this.displayOrder;if(i instanceof Array&&0!=i.length||(i=["textbooks","tbs-book"]),this.ii=0,this.modulePosition=0,"federated-intent-srp"===t.profile.odinProfileId&&"textbooks-isbn-suggester"!==i[0]&&($(".C-search-serp_v2 .chg-load").remove(),i="textbooks"===e.intents[0].name?["textbooks","tbs-book","study"]:["study","tbs-book","textbooks"]),"study-intent-srp"===t.profile.odinProfileId||"study-group-srp"===t.profile.odinProfileId){var r=C.utility.getParams(),n=r.intent?r.intent:null;$(".C-search-serp_v2 .chg-load").remove(),("textbooks"===e.intents[0].name&&null===n||"tbs-book"===n)&&(i=i.reverse())}"textbooks-srp"===t.profile.odinProfileId&&$(".C-search-serp_v2 .chg-load").remove();for(key in i){var o=i[key];null!=e[o]&&this.renderItems(o,e,t,s)}if("study-intent-srp"!==t.profile.odinProfileId&&"study-group-srp"!==t.profile.odinProfileId||($(".tbs-results .sectionTitle").html('<span class="container-title">Solution manuals for textbooks</span>'),$(".study-results .sectionTitle").html('<span class="container-title">Questions and solutions</span>').show()),"federated-intent-srp"===t.profile.odinProfileId&&"textbooks-isbn-suggester"!==i[0]){var s="?trackid="+this.trackId+"&strackId="+this.strackId,a=location.pathname.split("/")[2],l="/search/"+a+"/books"+s+"&intent=books",c="/search/"+a+"/study"+s+"&intent=tbs-book",h="/search/"+a+"/study"+s+"&intent=study",d='<button class="btn-outline-mini">More<span class="more-arrow"></span></button>';$(".books-results .sectionTitle").html('<span class="container-title">Textbooks</span><a class="more-button" href="'+l+'">'+d+"</a>"),$(".tbs-results .sectionTitle").html('<span class="container-title">Solution manuals for textbooks</span><a class="more-button" href="'+c+'">'+d+"</a>"),$(".study-results .sectionTitle").html('<span class="container-title">Questions and solutions</span><a class="more-button" href="'+h+'">'+d+"</a>").show(),$(".sectionTitle .more-button").click(function(e){e.preventDefault(),e.stopPropagation();var t=$(this).attr("href"),s=C.utility.getParamsByUrl(t),i=s.intent,r={event:"more_button",filterLocation:i};Eggshell.find("C.search.serp_v2").trigger("item clicked",r),Eggshell.find("C.search.firehose").on("firehose tracking complete",function(){location.href=t})})}"federated-srp"===t.profile.odinProfileId&&this.moreBtnClick()},renderItems:function(e,t,s,i){var r=t[e].responseContent,n=s.entityMap[e];if(r.numFound>0&&null!=n&&r.docs.length>0){this.modulePosition++;var o=s.profile.profile,a=$(this.generalResultsTmpl({entity:n,query:location.pathname.split("/")[2],tracking:i,hideSeeMore:!!s.profile.hideSeeMore,containerTitle:s.profile.containerTitle?s.profile.containerTitle:!1}));"textbooks-isbn-suggester"===e&&(a="isbn-similar"===t.intents[0].sourceReference?this.renderSimilarIsbnMatch(r,n,i):this.renderIsbnFuzzyMatch(r,n,i)),this.$el.append(a),"study-fused-intent-srp"!==o&&"study-group-srp"!==o||a.find(".item-list").addClass("study-srp");for(var l=0;l<r.docs.length;l++){var h=null;"undefined"!=typeof r.docs[l].group_id&&null!=r.docs[l].group_id&&(this.groupedItems=r.docs[l].group_id>this.groupedItems?r.docs[l].group_id:this.groupedItems,h="group-id-"+r.docs[l].group_id,1==a.find("."+h).length&&a.find("."+h).addClass("group-container"),this.ii=r.docs[l].group_id,this.ii--),r.docs[l].url+="&ii="+ ++this.ii,"textbooks-isbn-suggester"===e&&(r.docs[l].template=n.template),"C.fed.serp.book.gridlayout"===r.docs[l].template&&(t&&"undefined"!=typeof t.season?t.season.RM&&(r.docs[l].hasTbs=!1,r.docs[l].showTbsCallout=!1):r.docs[l].showTbsCallout=!0);s.profile.odinProfileId;if("questions"==e||"study"==e||"tbs-problem"==e){var d=r.docs[l].id;"study"===e&&(e="tbs"===r.docs[l].source?"tbs-problem":"questions")}else var d=r.docs[l].ean;var u="";switch(this.modulePosition){case 1:u="center-top";break;case 2:u="center-middle";break;case 3:u="center-bottom";break;default:u="center-bottom"}if("C.fed.serp.tbs.book.inline"===r.docs[l].template||"C.fed.serp.book.inline"===r.docs[l].template)var p=$('<li class="item-result inline-tbs-book rank-'+this.ii+" type-"+e+" automation-srp-results-"+e+" ent-id-"+d+" module-pos-"+u+'"></li>');else var p=$('<li class="item-result rank-'+this.ii+" type-"+e+" automation-srp-results-"+e+" ent-id-"+d+" module-pos-"+u+" "+h+'"></li>');var g=$('<a class="item-anchor rank-'+this.ii+" type-"+e+" ent-id-"+d+" module-pos-"+u+'" href="'+r.docs[l].url+'"></a>');g.click(function(e){e.preventDefault(),e.stopPropagation();var t,s,i,r,n=$(this).attr("class").split(" ");for(c in n)-1!==n[c].indexOf("rank-")&&(t=n[c].replace("rank-","")),-1!==n[c].indexOf("type-")&&(i=n[c].replace("type-","")),-1!==n[c].indexOf("ent-id-")&&(s=n[c].replace("ent-id-","")),-1!=n[c].indexOf("module-pos-")&&(r=n[c].replace("module-pos-",""));if($(e.target).hasClass("tbs-link")){var o=$(e.target).attr("href");i="tbs-attach"}else if($(e.target).is(".tbs-link .tbs-book-cover-img")||$(e.target).is(".tbs-link .tbs-book-cover")){var o=$(e.target).closest("a").attr("href");i="tbs-attach"}else var o=$(this).attr("href");var a={url:o,event:"click_submit",rank:t,product_id:s,type:i,filterLocation:null,module_name:"serp-"+i,module_position:r};Eggshell.find("C.search.serp_v2").trigger("item clicked",a),Eggshell.find("C.search.firehose").on("firehose tracking complete",function(){C.utility.navigate(o)})}),p.append(g),h&&1===a.find("."+h).length?(a.find("."+h).append(this.groupTmpl()),a.find("."+h).find("ul.grouped-results").append(p),r.docs[l].groupitem=!0):h&&0!==a.find("."+h).length?(a.find("."+h).find("ul.grouped-results").append(p),r.docs[l].groupitem=!0):p.appendTo(a.find(".item-list")),Eggshell.create(r.docs[l].template,{el:g}).trigger("render",{results:r.docs[l],config:s})}}if("federated-tbs-problem-srp"===s.profile.odinProfileId||"study-fused-srp"===s.profile.odinProfileId){var f=this.$el.find(".sectionTitle");f[1]&&$(f[1]).hide()}},renderIsbnFuzzyMatch:function(e,t,s){for(var i="Did you mean ",r=e.docs.length<=2?e.docs.length:2,n=0;r>n;n++)i+=0===n?"<span class='fuzzy-isbn'>"+e.docs[n].ean+"</span>":", <span class='fuzzy-isbn'>"+e.docs[n].ean+"</span>";return i+="?",$template=$(this.didYouMeanTmpl({title:i,entity:t,query:location.pathname.split("/")[2],tracking:s}))},renderSimilarIsbnMatch:function(e,t,s){return $template=$(this.similarIsbnTmpl({entity:t,query:location.pathname.split("/")[2],tracking:s}))},renderGroups:function(){for(var e=0;e<this.groupedItems;e++){var t=".group-id-"+(e+1),s=$(".item-list").find(t+" ul.grouped-results"),i=$(".item-list").find(t+" .grouped-items");countItems=$(s).find("li").length,countItems>0&&(i.find(".group-total").text("("+countItems+")"),countItems-=1,countItems=0==countItems?"":countItems,i.append('<span class="expand-group" data-id="'+t+'">Show '+countItems+' more<span class="icon-chegg-chevron"></span></span>'),i.append('<span class="hide-group" data-id="'+t+'">Show less<span class="icon-chegg-chevron"></span>'),i.find(".expand-group").click(function(e){$(".item-list "+$(this).data("id")+" .grouped-items").toggleClass("expanded"),$(".item-list "+$(this).data("id")+" .grouped-items").toggleClass("reduced");var t=$("html,body"),s=$(".item-list "+$(this).data("id"));t.animate({scrollTop:s.offset().top-70,scrollLeft:0},500),Eggshell.find("C.search.serp_v2").trigger("item clicked",{event:"grouping-see-more"})}),i.find(".hide-group").click(function(e){$(".item-list "+$(this).data("id")+" .grouped-items").toggleClass("expanded"),$(".item-list "+$(this).data("id")+" .grouped-items").toggleClass("reduced");var t=$("html,body"),s=$(".item-list "+$(this).data("id"));t.animate({scrollTop:s.offset().top-70,scrollLeft:0},500),Eggshell.find("C.search.serp_v2").trigger("item clicked",{event:"grouping-see-less"})}))}},moreBtnClick:function(){$(".sectionTitle .more-button").click(function(e){e.preventDefault(),e.stopPropagation();var t=$(this).attr("href"),s=C.utility.getParamsByUrl(t),i=s.intent,r={event:"more_button",filterLocation:i};Eggshell.find("C.search.serp_v2").trigger("item clicked",r),
Eggshell.find("C.search.firehose").on("firehose tracking complete",function(){location.href=t})})},createSerpPagination:function(e,t){this.$el.append('<div class="pagination"></div>'),"study-intent-srp"!==t.profile.odinProfileId&&"study-group-srp"!==t.profile.odinProfileId||$(".tbs-results").prepend('<div class="pagination"></div>');var s=0,i=0;for(var r in e)null!=e[r]&&"infobox"!==r&&C.utility.access("responseContent.numFound",e[r])&&(s+=e[r].responseContent.numFound,i+=e[r].responseContent.limit);this.$(".pagination").empty(),s>i&&(this.$pagination=Eggshell.create("C.Eggshell.pagination",{el:this.$(".pagination")}).trigger("totalItemsNum",s).trigger("itemsPerPage",i).trigger("currentPage",this.getPageNumber()).trigger("showPageDesc",!0).trigger("limitMaxPages",50).trigger("hrefTextPrefix","#p=").trigger("render"),$(".C-Eggshell-pagination a").click($.proxy(function(e){var t=$(e.target).parents(".tbs-results").length;return e.stopPropagation(),pageNumber=Math.max(1,parseInt($(e.target).attr("href").substr(3),10)),this.$pagination.trigger("currentPage",pageNumber),this.$pagination.trigger("render"),$(".item-list").empty(),0!==t?Eggshell.find("C.search.serp_v2").trigger("tbs book next page",pageNumber):Eggshell.find("C.search.serp_v2").trigger("next page",pageNumber),this.showSpinner(),this.scrollToTop(),this.$(".pagination").addClass("disabled"),!1},this)))},getPageNumber:function(){return location.hash&&(page=Number(location.hash.substr(3)),!isNaN(page)&&page>0)?page:1},showSpinner:function(){$(".chg-load").show()},hideSpinner:function(){$(".chg-load").hide()},scrollToTop:function(){$("html, body").stop().animate({scrollTop:0},300)},groupTmpl:_.template('<div class="grouped-items reduced"><span class="group-title">SIMILAR QUESTIONS <span class="group-total"></span></span><ul class="grouped-results"></ul></div>'),generalResultsTmpl:_.template('<div class="<%- entity.sectionClass %>"><div class="sectionTitle"><% if(containerTitle) {%><span class="container-title"><%- containerTitle %></span><% }else{ %><span class="icon <%- entity.iconClass %>"></span><% if(hideSeeMore) {%><span class="container-title"><%- entity.seeMore %></span><% }else{ %><a class="more-button" href="/search/<%-query%><%- entity.seeMoreUrlSuffix %><%- tracking %>&intent=<%- entity.sectionClass %>"><span class="container-title"><%- entity.seeMore %> »</span></a><% } %><% } %></div><ul class="item-list row"></ul><a href="/search/<%-query%><%- entity.seeMoreUrlSuffix %><%- tracking %>"><span class="more"><%- entity.seeMoreFull %> »</span> </a><div class="chg-load"></div></div>'),didYouMeanTmpl:_.template('<div class="<%- entity.sectionClass %>"><div class="sectionTitle"><span class="container-title-fuzzy-match"><%= title%></span><p class="container-subtitle-fuzzy-match"><span class="isbn-query"><%-query%></span> had no results.</p></div><ul class="item-list row"></ul><a href="/search/<%-query%><%- entity.seeMoreUrlSuffix %><%- tracking %>"><span class="more"><%- entity.seeMoreFull %> »</span> </a><div class="chg-load"></div></div>'),similarIsbnTmpl:_.template('<div class="<%- entity.sectionClass %>"><div class="sectionTitle"><span class="container-title-similar-match">Sorry! We don\'t  have this book. "<%-query%>" had no matches :(</span></div><span class="container-subtitle-similar-match">Other related matches you may be interested in</span><ul class="item-list row"></ul><div class="chg-load"></div></div>')});return e}()),Eggshell.define("C.search.serp.singlefed",{inputs:["render"],output:["single serp location"]},function(){var e=(Backbone.Model.extend({initialize:function(e){}}),Backbone.View.extend({initialize:function(e){Eggshell.find(this).on("render",this.render,this),Eggshell.find("C.search.trackid").on("track ids",$.proxy(function(e,t){this.trackId=t.trackid},this)).on("strackid set",$.proxy(function(e,t){this.strackId=t.strackid},this)).trigger("get track ids").trigger("get strackid")},render:function(e,t){this.hideSpinner(),this.renderResults(t.results,t.config),this.createSerpPagination(t.results,t.config)},getQuery:function(){return decodeURIComponent(location.pathname.split("/")[2])},renderResults:function(e,t){this.$el.append(this.resultsTmpl({icon:t.profile.iconClass,title:t.profile.title}));var s=10*(this.getPageNumber()-1);if("Tutors"==t.profile.title){for(var i=e.searchResult.tutors,r=0;r<i.length;r++)if(i[r].component){i[r].url+="&ii="+ ++s;var n=$('<li class="item-result rank-'+s+" type-tutor ent-id-"+i[r].id+'"></li>');Eggshell.create(i[r].component,{el:n.appendTo(".result-list")}).trigger("render",i[r]),n.click(function(e){e.preventDefault(),e.stopPropagation();var t,s,i,r,n=$(this).attr("class").split(" ");for(c in n)-1!=n[c].indexOf("rank-")&&(t=n[c].replace("rank-","")),-1!=n[c].indexOf("type-")&&(i=n[c].replace("type-","")),-1!=n[c].indexOf("ent-id-")&&(s=n[c].replace("ent-id-","")),-1!=n[c].indexOf("module-pos-")&&(r=n[c].replace("module-pos-",""));var o=$(this).find("a").attr("href"),a={url:o,event:"click_submit",rank:t,product_id:s,type:i,filterLocation:null,module_name:"serp-"+i,module_position:"center-top"};Eggshell.find("C.search.serp_v2").trigger("item clicked",a),Eggshell.find("C.search.firehose").on("firehose tracking complete",function(){o&&C.utility.navigate(o)})})}}else for(var o in e)if(null!=e[o]&&"infobox"!==o&&C.utility.access("responseContent.docs",e[o]))for(var r=0;r<e[o].responseContent.docs.length;r++){if(e[o].responseContent.docs[r].url+="&ii="+ ++s,"questions"==o||"study"==o||"tbs-problem"==o)var a=e[o].responseContent.docs[r].id;else var a=e[o].responseContent.docs[r].ean;if("C.fed.serp.book.old"!=e[o].responseContent.docs[r].template){var n=$('<li class="item-result rank-'+s+" type-"+o+" ent-id-"+a+'"></li>'),l=$('<a class="item-anchor rank-'+s+" type-"+o+" ent-id-"+a+' module-pos-center-top" href="'+e[o].responseContent.docs[r].url+'"></a>');l.click(function(e){e.preventDefault(),e.stopPropagation();var t=$(this).attr("href"),s={url:t,event:"click_submit",rank:rank,product_id:id,type:type,filterLocation:null,module_name:"serp-"+type,module_position:"center-top"};Eggshell.find("C.search.serp_v2").trigger("item clicked",s),Eggshell.find("C.search.firehose").on("firehose tracking complete",function(){C.utility.navigate(t)})}),n.append(l),n.appendTo(this.$(".result-list"));var h=l}else{var n=$('<li class="item-result rank-'+s+" type-"+o+" ent-id-"+a+'"></li>');n.appendTo(this.$(".result-list"));var h=n;n.click(function(e){e.preventDefault(),e.stopPropagation();var t,s,i,r,n=$(this).attr("class").split(" ");for(c in n)-1!=n[c].indexOf("rank-")&&(t=n[c].replace("rank-","")),-1!=n[c].indexOf("type-")&&(i=n[c].replace("type-","")),-1!=n[c].indexOf("ent-id-")&&(s=n[c].replace("ent-id-","")),-1!=n[c].indexOf("module-pos-")&&(r=n[c].replace("module-pos-",""));var o=$(this).find("a").attr("href"),a={url:o,event:"click_submit",rank:t,product_id:s,type:i,filterLocation:null,module_name:"serp-"+i,module_position:r};Eggshell.find("C.search.serp_v2").trigger("item clicked",a),Eggshell.find("C.search.firehose").on("firehose tracking complete",function(){C.utility.navigate(o)})})}Eggshell.create(e[o].responseContent.docs[r].template,{el:h}).trigger("single serp location").trigger("render",{results:e[o].responseContent.docs[r],config:t})}},createSerpPagination:function(e,t){if("Tutors"==t.profile.title)var s=(this.getPageNumber(),e.count),i=3;else for(var r in e)if(null!=e[r]&&"infobox"!==r&&C.utility.access("responseContent.numFound",e[r]))var s=e[r].responseContent.numFound,i=e[r].responseContent.limit;this.$(".pagination").empty(),s>i&&(this.$pagination=Eggshell.create("C.Eggshell.pagination",{el:this.$(".pagination")}).trigger("totalItemsNum",s).trigger("itemsPerPage",i).trigger("currentPage",this.getPageNumber()).trigger("showPageDesc",!0).trigger("limitMaxPages",50).trigger("render"),$(".C-Eggshell-pagination a").click($.proxy(function(e){return e.stopPropagation(),pageNumber=Math.max(1,parseInt($(e.target).attr("href"),10)),this.$pagination.trigger("currentPage",pageNumber),this.$pagination.trigger("render"),$(".result-list").empty(),Eggshell.find("C.search.serp_v2").trigger("next page",pageNumber),this.showSpinner(),this.scrollToTop(),!1},this)))},getPageNumber:function(){return location.hash&&(page=Number(location.hash.substr(3)),!isNaN(page)&&page>0)?page:1},scrollToTop:function(){$("html, body").stop().animate({scrollTop:0},300)},showSpinner:function(){$(".chg-load").show()},hideSpinner:function(){$(".chg-load").hide()},resultsTmpl:_.template('<div class="results-container"><div class="subheader-title"><span class="icon <%- icon %>"></span><span class="container-title"><%- title %></span></div><ul class="result-list"></ul></div><div class="pagination"></div>')}));return e}()),Eggshell.define("C.search.serp_mobile",{inputs:["render","next page","hide"],output:[]},function(){var e=Backbone.Model.extend({initialize:function(e){var t=e.results,s=e.tabId,i=e.displayOrder;if(t.hasOwnProperty("apiError")&&this.set("apiError",t.apiError),t.noResults===!0)this.set("count",0);else{$.isArray(t.order)&&(i=t.order,this.set("displayOrder",i));var r=[],n=[],o=0,a=0;if("tutors"===s){var l=t.searchResult.tutors;_.each(l,function(e){e.component&&(e.type="tutors",e.template=e.component+".mobile",r.push(e))}),o=t.count,n.push("tutors")}else _.each(i,function(e){if(response=t[e],null!=response&&"infobox"!==e&&"intents"!==e){n.push(e);var s=response.responseContent,i=s.docs;_.each(i,function(t){t.type=e,r.push(t)}),o+=Number(s.numFound),a=s.limit}}),1===n.length&&this.set("limit",a);this.set({items:r,types:n,count:o})}}}),t=Backbone.Model.extend({initialize:function(t){var s=t.config.profile,i=s.tabId,r={},n={},o={},a=Eggshell.create("C.search.configuration");a.on("config values for profile id",function(e,t){var t=t.profile,s=t.displayOrder;_.each(s,function(e){o[e]=t.tabId})}).trigger("get mobile filters config",function(e){n=e[i],_.each(e,function(e,t){r[t]=e.title,e.filters?_.each(e.filters,function(e){a.trigger("get config by profile id",e.profileId)}):a.trigger("get config by profile id",e.profileId)})}),$(".without-all-matches").length>0&&delete r.all;var l=["Computer Science","Physics","Economics","Writing","Statistics","Accounting","Chemistry","Calculus","Biology","Finance"];this.set(t),this.set({page:1,profile:s,tabId:i,urlQuery:encodeURIComponent(t.query),filters:r,currentFilter:n,types:o,tutorLinks:l}),this.updateTrackId();var c=function(t,i){var r=new e({results:t,tabId:this.get("tabId"),displayOrder:s.displayOrder,intentDisplayOrder:s.intentDisplayOrder||null});this.set("results",r),this.set("ajaxIsLoading",!1),this.trigger(i,r)};this.ajaxComponent=Eggshell.create("C.search.ajax",{mobile:!0}).trigger("set config values",this.get("config")).on("search result",function(e,t){c.call(this,t,"loaded")},this).on("failed search attempt",function(e,t){c.call(this,t,"failToLoad")},this)},updateTrackId:function(){Eggshell.find("C.search.trackid").on("track ids",$.proxy(function(e,t){this.set("track",{trackId:t.trackid,strackId:t.strackid})},this)).trigger("get track ids")},loadPage:function(e){if(!this.get("ajaxIsLoading")){this.set("ajaxIsLoading",!0);var t=this.get("page");e&&(t+=1,this.set("page",t));var s=this.get("track");this.ajaxComponent.trigger("get search result",{query:this.get("query"),extraData:{trackId:s.trackId,strackId:s.strackId,page:t,event:"serp"}})}},getTabIdByItemType:function(e){return this.get("types")[e]},getTabTitleByItemType:function(e){var t=this.getTabIdByItemType(e);return this.get("filters")[t]}}),s=Backbone.View.extend({initialize:function(e){var s=e.config;if("undefined"==typeof s)throw"Config needs to be passed to the layouts, for it to function";this.model=new t({config:s,query:s.query}),this.firehoseComponent=Eggshell.create("C.search.firehose"),this.model.on("loaded",function(e){this.loader.trigger("hide"),0===e.get("count")?this.renderNoResults(e):(this.render(e),1==this.model.get("page")&&(this.$list.height()<this.$overflow.height()&&this.tryLoadMore(),this.createPagination()))},this).on("failToLoad",function(e){this.loader.trigger("hide"),e.get("apiError")?this.renderError():this.renderNoResults(e)},this),Eggshell.find(this).on("render",this.load,this).on("hide",this.hideResults,this).on("destroy",this.destroy,this),this.setClickItemWrappers(),this.eventType=null,this.eventTarget=null,this.clickedUrl=null,this.clickedRank=null,this.clickedProductId=null,this.clickedType=null,this.filterLocation=null,this.modulePosition=null},load:function(){this.$el.html(this.serpTmpl()),this.createFilters(),this.$list=this.$(".serp-list"),this.$header=this.$(".serp-headline"),this.$overflow=$(".mobile-overflow"),this.loader=Eggshell.create("C.search.mobile.loader",this.$list),this.loader.trigger("show",this.$list),this.model.loadPage()},render:function(e){this.renderHeader(e),this.renderTabButtons(),this.renderResults(e)},renderNoResults:function(e){this.$list.empty(),this.renderHeader(e),"tutors"===this.model.get("tabId")?this.$list.append($(this.tmplTutorNoResults({searchTerm:this.model.get("query"),links:this.model.get("tutorLinks")}))):(this.renderTabButtons(),this.$list.append(this.noResultsTmpl({searchTerm:this.model.get("query"),tabId:this.model.get("tabId")})))},renderError:function(){this.$list.empty(),this.$list.append(this._ajaxErrorTpl())},renderHeader:function(e){this.$header.empty(),this.$header.append(this.headerTmpl({results:{total:e.get("count"),vertical:this.model.get("title"),query:this.model.get("query"),urlQuery:this.model.get("urlQuery"),tracking:this.renderTracking()}})),this.$header.show()},renderTabButtons:function(){var e=this.model.get("currentFilter"),t=e.filters,s=this.model.get("profile");if(_.isObject(t)&&_.keys(t).length>0){var i=_.keys(t),r=_.intersection(i,s.displayOrder);r=r.length>0?r[0]:i[0];var n=this.model.get("results").get("displayOrder");$.isArray(n)&&n.length>0&&(r=n[0]),this.$header.append(this.tabButtons({filters:t,selected:r}))}},renderTracking:function(e){var t=this.model.get("track");return e=e?"&event="+e:"","?trackid="+t.trackId+"&strackId="+t.strackId+e},createFilters:function(){var e=this.model.get("filters"),t={};_.each(e,function(e,s){t[s]={name:e,url:"javascript:void(0);"}}),Eggshell.create("C.common.search.serp.filter",{el:this.$(".serp-filters")}).trigger("set tab options",t).trigger("set selected filter",this.model.get("tabId")).trigger("render")},tryLoadMore:function(){var e=this.model.get("results");if(e){var t=e.get("count"),s=e.get("limit"),i=this.model.get("page");if(t>i*s)return this.model.loadPage(!0),this.loader.trigger("show",this.$list),!0}},createPagination:function(){"all"!==this.model.get("tabId")&&this.$overflow.on("scroll.serp_mobile",function(e){var t=$(e.target),s=t.scrollTop()+t.height(),i=t.get(0).scrollHeight;if(50>i-s){if(this.tryLoadMore())return!0;t.off("scroll.serp_mobile")}}.bind(this))},renderResults:function(e){this.model.updateTrackId();var t=this.$list.find(".item-result").length,s=this.model.get("config"),i=e.get("items"),r=e.get("types"),n=(this.model.get("types"),null),o=this.$list;_.each(i,function(e){var i=e.type;if(r.length>1&&i!==n){n=i;var a=this.model.getTabTitleByItemType(i),l=this.model.getTabIdByItemType(i);o=this.createItemsGroup(l,a)}"C.fed.serp.book.gridlayout"===e.template&&(e.template="C.fed.serp.book.old"),e.url+="&ii="+ ++t+"&event=click_submit";var c=$('<li class="item-result rank-'+t+" type-"+e.type+" ent-id-"+e.id+'"></li>'),h=Eggshell.create(e.template,{el:c.appendTo(o)});"tutors"===i?h.trigger("render",e):h.trigger("mobile search").trigger("single serp location").trigger("render",{results:e,config:s})},this)},createItemsGroup:function(e,t){var s=t.toLowerCase();"qna"===e?s="expert Q&A":"books"===e&&(s="books");var i=$(this.groupOfItems({title:t,seeAllLink:e,seeAllText:s}));return this.$list.append(i),i.children(".group-list")},hideResults:function(){this.$header.empty(),this.$list.empty()},setClickItemWrappers:function(){var e=this;this.$el.on("click.serp_mobile",".item-result",function(t){t.preventDefault(),t.stopPropagation();var s=$(this).find("a").attr("href")||$(this).find("div[href]").attr("href");return Eggshell.find("C.search.firehose").on("firehose tracking complete",function(){location.href=s}),e.trackClickEvent(s,$(this)),!1})},destroy:function(){this.$overflow&&this.$overflow.off("scroll.serp_mobile"),this.$el.off("click.serp_mobile")},fireTrackingClickEvent:function(e){var t=this.model.get("track");this.firehoseComponent.trigger("firehose click event",{strackId:t.strackId,trackId:t.trackId,event:this.eventType,clickedUrl:this.clickedUrl,clickedRank:this.clickedRank,clickedProductId:this.clickedProductId,clickedType:this.clickedType,module_name:"mobile-autosuggest-"+this.clickedType,module_position:"mobile-autosuggest"})},trackClickEvent:function(e,t){if(urlParams=C.utility.getParamsByUrl(e),this.eventType=urlParams.event,"click_submit"===this.eventType){var s,i,r,n=$(t).attr("class").split(" ");for(var o in n)-1!=n[o].indexOf("rank-")&&(s=n[o].replace("rank-","")),-1!=n[o].indexOf("type-")&&(r=n[o].replace("type-","")),-1!=n[o].indexOf("ent-id-")&&(i=n[o].replace("ent-id-",""));return this.clickedUrl=e,this.clickedRank=s,this.clickedProductId=i,this.clickedType=r,void this.fireTrackingClickEvent()}},_ajaxErrorTpl:_.template('<div class="ajax-error-outer-box"><h5 class="error-title">Oops, something went wrong!</h5><div class="error-descr">Give us a minute and then try again</div><div class="error-state-hero"></div></div>'),groupOfItems:_.template('<div class="group-items"><div class="group-title"><%- title %></div><div class="group-list"></div><a data-id="<%- seeAllLink %>" class="group-see_all" href="javascript:void(0);">See all <%- seeAllText %> &rsaquo;</a></div>'),tabButtons:_.template('<div class="tab-buttons"><span>View as: <% _.each(filters, function itr(filter, filterId){ %><a href="javascript:void(0)" data-id="<%- filterId %>" ><% var cls = (filterId === selected)? "selected": ""; %><span class="tab-button-text <%- cls %>"><%- filter.title %></span> </a><% }) %></span></div>'),serpTmpl:_.template('<div class="row"><div class="col-10 col-first"><div class="serp-container"><div class="serp-filters"></div><div class="serp-content"><div class="serp-headline"></div><ol class="serp-list"></ol></div></div></div><div class="col-2 col-last"><div class="serp-post-new-question-form"></div><div class="serp-advertisment"></div></div></div>'),headerTmpl:_.template('<div class="headerInfo"><span class="total"><%- results.total %> </span><span class="results-label">Results</span></div>'),noResultsTmpl:_.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><% if(tabId === "all") {%><p class="title-2">We can\'t find <span class="search-term"><%- searchTerm %></span></p><p class="title-3">Please double check the ISBN or spelling.</p><% }else if(tabId === "books") {%><p class="title-2">We can\'t find <span class="search-term"><%- searchTerm %></span> in Books</p><p class="title-3">Please double check the ISBN or spelling.</p><% }else if(tabId === "tbs") { %><p class="title-2">We can\'t find <span class="search-term"><%- searchTerm %></span> in textbook solutions</p><p class="title-3">Please double check the ISBN or spelling.</p><% }else if(tabId === "qna") { %><p class="title-2">We can\'t find any questions for <span class="search-term"><%- searchTerm %></span></p><% } %></div></div>'),tmplTutorNoResults:_.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2">We can\'t find any tutoring for <span class="search-term"><%- searchTerm %></span></p><p class="title-tutor">Try one of these popular tutoring subjects:</p></div><ul class="popular-subjects"><% _.each(links, function(link){ %><li><a data-id="findByQuery" data-query="<%- link %>" href="javascript:void(0);"><%- link %></a></li><% }) %></ul></div>')});return s}()),Eggshell.define("C.search.serp_v2",{inputs:["render","next page"],output:[]},function(){var e=Backbone.Model.extend({initialize:function(e){}}),t=Backbone.View.extend({initialize:function(t){if("undefined"==typeof t.config)throw"Config needs to be passed to the layouts, for it to function";this.config=t.config,this.totalFound=0,this.displayOrder=t.config.profile.displayOrder,this.firehoseComponent=Eggshell.create("C.search.firehose"),this.ajaxComponent=Eggshell.create("C.search.ajax").trigger("set config values",this.config).on("search result",this.render,this).on("failed search attempt",this.renderError,this),this.model=new e,Eggshell.find("C.search.trackid").on("track ids",$.proxy(function(e,t){this.trackId=t.trackid},this)).on("strackid set",$.proxy(function(e,t){this.strackId=t.strackid},this)).trigger("get track ids").trigger("get strackid"),this.setListeners(),this.eventType="serp",this.clickedUrl=null,this.clickedRank=null,this.filterLocation=null},setListeners:function(){Eggshell.find(this).on("render",this.load,this),Eggshell.find(this).on("next page",$.proxy(function(e,t){this.eventType="pagination",this.getAjaxResults(e,t)},this)),Eggshell.find(this).on("tbs book next page",$.proxy(function(e,t){this.eventType="tbs_book_pagination",this.getAjaxResults(e,t)},this)),Eggshell.find(this).on("item clicked",this.fireTrackingEvent,this)},load:function(){this.config.profile.gridlayout?this.$el.html(this.serpGridTmpl()):this.$el.html(this.serpTmpl()),this.createFilters(),this.renderAdvertisment(),this.createLoadingIndicator(),this.getAjaxResults()},getAjaxResults:function(e,t){var s="Tutors"==this.config.profile.title?3:void 0;"undefined"==typeof t&&(t=this.getPageNumber());var i=window.location.href.split("#")[0];window.location.replace(i+"#p="+t),this.ajaxComponent.trigger("get search result",{query:this.getQuery(),extraData:{trackId:this.trackId,strackId:this.strackId,page:t,count:s,event:this.eventType}})},fireTrackingEvent:function(e,t){urlParams=C.utility.getParamsByUrl(location.href);window.location.hash;"click_submit"==t.event?(clickedUrlParams=C.utility.getParamsByUrl(t.url),clickedTrackid=clickedUrlParams.trackid,clickedStrackid=clickedUrlParams.strackid,this.firehoseComponent.trigger("firehose click event",{strackId:clickedStrackid,trackId:clickedTrackid,event:t.event,clickedUrl:t.url,clickedRank:t.rank,clickedProductId:t.product_id,clickedType:t.type})):(this.filterLocation=t.filterLocation,this.config.profile.searchData["page-number"]=this.getPageNumber(),this.firehoseComponent.trigger("firehose search event",{ajaxData:{query:this.getQuery(),trackid:this.trackId,strackid:this.strackId,search_data:JSON.stringify(this.config.profile.searchData),event:t.event,filterLoc:this.filterLocation},results:this.results}))},checkAndRedirect:function(e){if("undefined"!=typeof e&&e.textbooks){var t=e.textbooks.responseContent.docs,s=t.length;if(1===s&&1===e.textbooks.responseContent.numFound){var i=t[0],r=i.url;if(r){var n={url:r,event:"click_submit",rank:"1",product_id:i.ean,type:"textbooks",filterLocation:"textbook-auto-redirect",module_name:"serp-textbooks",module_pos:"module-pos-center-top"};Eggshell.find("C.search.serp_v2").trigger("item clicked",n),Eggshell.find("C.search.firehose").on("firehose tracking complete",function(){C.utility.navigate(r,!0)})}}}return!0},render:function(e,t){this.results=t,this.checkAndRedirect(t)&&(this.removePlaceholders(),t.infobox&&t.infobox.responseContent.docs.length>0&&t.infobox.responseContent.docs[0].html&&($(".serp-infobox").remove(),this.createInfoBox(t.infobox.responseContent.docs[0].html)),this.detectDisplayOrder(t),this.totalFound=this.calculateTotal(t),this.totalFound>0?(this.createHeaderInfo(),this.$(".serp-list").empty(),Eggshell.create(this.config.profile.sublayout,{el:this.$(".serp-list")}).trigger("render",{results:t,config:this.config,displayOrder:this.displayOrder})):this.renderError(null,t))},renderError:function(e,t){"object"==typeof newrelic&&newrelic.addPageAction("search",{profile:this.config.profile.odinProfileId,results:"noResults"}),this.$(".serp-list").empty(),$(".chg-load").hide(),this.removePlaceholders(),this.createHeaderInfo(),t.infobox&&t.infobox.responseContent.docs.length>0&&t.infobox.responseContent.docs[0].html&&($(".serp-infobox").remove(),this.createInfoBox(t.infobox.responseContent.docs[0].html)),t.noResults===!0&&t.apiError===!1?0===t.intent.length||"isbn"!==t.intent[0].sourceReference&&"isbn-similar"!==t.intent[0].sourceReference?this.$(".serp-list").append(this.noResultsTmpl({searchTerm:this.getQuery(),page:this.config.profile.title})):t["textbooks-isbn-suggester"]&&t["textbooks-isbn-suggester"].responseContent.docs.length>0?(this.$(".serp-filters ul li").hide(),this.$(".serp-list").empty(),this.$(".search-totals").hide(),Eggshell.create(this.config.profile.sublayout,{el:this.$(".serp-list")}).trigger("render",{results:t,config:this.config,displayOrder:["textbooks-isbn-suggester"]})):this.$(".serp-list").append(this.isbnNoResultsTmpl({searchTerm:this.getQuery(),page:this.config.profile.title})):this.$(".serp-list").append(this.apiErrorTmpl({searchTerm:this.getQuery(),page:this.config.profile.title}))},getPageNumber:function(){return location.hash&&(page=Number(location.hash.substr(3)),!isNaN(page)&&page>0)?page:1},renderTracking:function(e){return e=e?"&event="+e:"","?trackid="+this.trackId+"&strackId="+this.strackId+e},createFilters:function(){var e=location.pathname.split("/")[2],t=this.renderTracking("filter_submit"),s="/search/"+e+"/federated"+t+"&filterloc=serp_tab",i="/search/"+e+"/books"+t+"&filterloc=serp_tab",r="/search/"+e+"/study"+t+"&filterloc=serp_tab";"study-fused-filters-srp"==this.config.profile.profile&&(r+="&filter=all");var n={"All matches":{name:"All matches",url:s,"class":"filter-all-matches"},Books:{name:"Books",url:i,"class":"filter-books"},Study:{name:"Study",url:r,"class":"filter-study"}};Eggshell.create("C.common.search.serp.filter",{el:this.$(".serp-filters")}).trigger("set tab options",n).trigger("set selected filter",this.config.profile.title).trigger("render").on("filter selected",$.proxy(function(e,t){var s={url:n[t].url,event:"filter_submit",filterLocation:"serp_tab"};this.fireTrackingEvent(e,s)},this))},createInfoBox:function(e){this.$(".serp-headline").after('<div class="serp-infobox">'+e+"</div>")},detectDisplayOrder:function(e){$.isArray(e.order)&&(this.displayOrder=e.order)},calculateTotal:function(e){var t=0;if(e.noResults===!0)return 0;var s=0;for(var i in e)null!=e[i]&&"infobox"!=i&&C.utility.access("responseContent.numFound",e[i])&&(s+=Number(e[i].responseContent.numFound),t+=e[i].responseContent.limit);return s>50*t&&(s=50*t),s},createHeaderInfo:function(){var e=location.pathname.split("/")[2];this.$(".serp-headline").empty(),this.$(".serp-headline").append(this.sunkistHeaderTmpl({results:{total:this.totalFound,vertical:this.config.profile.title,query:this.getQuery(),urlQuery:e,tracking:this.renderTracking()}}))},renderAdvertisment:function(){this.$(".serp-advertisment").append(this.advertismentTmpl({advertisment:this.config.profile.advertising})),Eggshell.find("C.common.advertisements").trigger("render")},getQuery:function(){return this.query||(this.query=decodeURIComponent(location.pathname.split("/")[2])),this.query},createLoadingIndicator:function(){$(".serp-content").append('<div class="chg-load"></div>'),$(".chg-load").hide()},removePlaceholders:function(){$(".federated-placeholder-content").remove()},serpGridTmpl:_.template('<div class="row grid-layout"><div class="col-9 col-first"><div class="serp-container"><div class="serp-content"><div class="serp-headline"></div><div class="serp-filters"></div><div class="serp-list"></div></div></div></div><div class="col-3 col-last"><div class="serp-advertisment"></div></div></div>'),serpTmpl:_.template('<div class="row"><div class="col-10 col-first"><div class="serp-container"><div class="serp-filters"></div><div class="serp-content"><div class="serp-headline"></div><div class="serp-list"></div></div></div></div><div class="col-2 col-last"><div class="serp-advertisment"></div></div></div>'),sunkistHeaderTmpl:_.template('<div class="headerInfo"><span class="quotes">"<span class="query"><%- results.query %></span>"</span> <div class="search-totals"><span class="total"><%= results.total %> results</span><span class="vertical"> in <%- results.vertical %></span></div></div>'),advertismentTmpl:_.template('<div class="chg-ad"><div class="chg-display" data-unit="<%= advertisment %>" data-size="160x600"></div></div>'),noResultsTmpl:_.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><% if(page == "Books" || page == "All matches") {%><p class="title-2 <% if(page == "All matches"){%> title-all-matches <% }else{ %> title-book<% } %>">We can\'t find <span class="search-term"><%- searchTerm %></span></p><p class="title-3">Please double check the ISBN or spelling.</p><% }else if(page == "Textbook solutions") { %><p class="title-2 title-study">We can\'t find any textbook solutions for <span class="search-term"><%- searchTerm %></span></p><p class="title-3">Please double check the ISBN or spelling.</p><% }else if(page == "Expert Q&A" || page == "Study") { %><p class="title-2 title-study">We can\'t find any questions for <span class="search-term"><%- searchTerm %></span></p><% } %></div></div>'),isbnNoResultsTmpl:_.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2 title-all-matches">We can\'t find that book or we don\'t have it in stock.</p><p class="title-3">Please check the ISBN and try again.</p></div></div>'),apiErrorTmpl:_.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Oops....</p><p class="title-2 title-study">Something isn\'t right.</p><p class="title-3">We appreciate your patience while we work to fix the issue. Please try again later.</p></div></div>')});return t}()),Eggshell.define("C.fed.auto.book",{inputs:{render:{payload:{id:"string",template:"C.common.search.result.book",url:"string",thumbnail:"string",title:"string",author:"string",isbn:"string",ean:"string",groupName:"string",isFirst:"boolean",type:"string"}}},outputs:{}},function(){var e=Backbone.View.extend({initialize:function(e){Eggshell.find(this).on("render",this.render),this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;",this.query=e.query},render:function(e,t){var s=C.utility.highlightText(t.title,this.query),i=t.subtitle?C.utility.highlightText(t.subtitle,this.query):!1,r="";if(Array.isArray(t.authors))r=t.authors[0]?t.authors[0]:"";else if(t.author){var n=t.author.split(";");r=n[0]}var o=r+this.bulletSeperatorHTML+"ISBN: "+t.isbn+this.bulletSeperatorHTML+"ISBN13: "+t.ean;t.cover||(t.cover="http://c.chegg.com/covers2/imagena.gif"),o=C.utility.highlightText(o,this.query),this.$el.html(this.template({book:{id:t.id,template:"C.fed.auto.book",url:t.url.replace(/^http(s)?:/i,location.protocol),thumbnail:t.cover,title:s+(t["edition-no"]?' <span class="result-header-small">('+C.utility.ordinal(t["edition-no"])+" Edition)</span>":""),subtitle:i,detail:o}})),Eggshell.create("C.common.bookcover",{el:this.$el.find(".book-cover-container")}).trigger("set book image",t.cover.replace(/^http(s)?:/i,location.protocol)).trigger("turn off shadow")},template:_.template('<div class="book-result"><div class="result-data"><a href="<%- book.url %>"><span class="book-cover-container small bookcover-seo-mini"></span><div class="result-info"><span class="result-header"><%= book.title %></span><% if(book.subtitle!=false){%><span class="result-sub-header"><%= book.subtitle %></span><% } %><span class="result-detail"><%= book.detail %></span></div></a></div></div>')});return e}()),Eggshell.define("C.fed.auto.study",{inputs:{render:{payload:{}}},outputs:{},strict:!1},function(){var e=Backbone.View.extend({initialize:function(e){Eggshell.find(this).on("render",this.render),this.query=e.query},render:function(e,t){var s=t,i="question",r="";if(s.chapterName){var r=this.createTbsBookTitle(s.bookTitle,s.bookEditionNumber,s.chapterName,s.problemName);
i="solution"}this.$el.html(this.studyTemplate({study:{url:C.global.liveSiteUrl+s.url.substring(1),question:C.utility.highlightText(s.question,this.query),type:i,bookTitle:r}}))},createTbsBookTitle:function(e,t,s,i){return t=t?" ("+C.utility.ordinal(t)+" Edition), ":"",s=s?" Chapter "+s+", ":"",i=i?" Question "+i+" ":"",e+t+s+i},studyTemplate:_.template('<a href="<%- study.url %>"><div class="study-question"><% if(study.type == "question"){ %><div class="question"><strong class="f-size-03">Q.</strong><span class="content"><%= study.question %></span></div><span><strong class="f-size-03">A.</strong> <a class="answer" href="<%- study.url %>">See solution</a></span><% }else{ %><div class="question"><strong class="f-size-03">Q.</strong><span class="content"><%= study.question %></span></div><div class="book"><%- study.bookTitle %></div><span><strong class="f-size-03">A.</strong> <a class="answer" href="<%- study.url %>">See solution</a></span><% } %></div></a>')});return e}()),Eggshell.define("C.fed.auto.qna",{inputs:{render:{payload:{}}},outputs:{},strict:!1},function(){var e=Backbone.View.extend({initialize:function(e){Eggshell.find(this).on("render",this.render),this.query=e.query},render:function(e,t){var s=t,i="question";s.chapterName&&(i="solution"),this.$el.html(this.QNATemplate({qna:{url:C.global.liveSiteUrl+s.url.substring(1),question:C.utility.highlightText(s.question,this.query),type:i}}))},QNATemplate:_.template('<a href="<%- qna.url %>"><div class="qna-question"><div class="question"><strong class="f-size-03">Q:</strong><%= qna.question %></div><% if(qna.type === "solution") { %><span><strong class="f-size-03">S:</strong> <a class="answer" href="<%- qna.url %>">View Solution</a></span><% } else { %><span><strong class="f-size-03">A:</strong> <a class="answer" href="<%- qna.url %>">See Answer</a></span><% } %></div></a>')});return e}()),Eggshell.define("C.fed.auto.tbs",{inputs:{render:{payload:{id:"string",component:"string",url:"string",title:"string",ean:"string",isbn:"string",author:"string",subtitle:"string",edition_no:"string",solutioncount:"string",group:"string",isFirst:"string",type:"string"}}},outputs:{},strict:!1},function(){var e=Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(e,t){this.highlightText(t),this.$el.html(this.tbsTemplate({tbs:{id:t.id,component:t.component,searchBy:t.searchBy,url:C.global.liveSiteUrl+t.url.substring(1),cover:C.utility.bookCover(t,C.utility.bookCover.thumb,{type:C.utility.bookCover.tbsType}),isbn:t.isbn,isbn13:t.ean,author:this.truncateAuthors(this.author),subtitle:this.subtitle?this.subtitle:!1,title:this.title,edition:t["edition-no"]?"("+this.toOrdinal(t["edition-no"])+" Edition)":""}}))},events:{mouseenter:"onMouseEnterTBSResult",mouseleave:"onMouseLeaveTBSResult"},truncateAuthors:function(e){var t=e;if("undefined"!=typeof e){var s=e.split(" ; ");t=s[0]}return t},highlightText:function(e){var t='<span class="chg-suggest-term">$1</span>',s=e.searchBy,i=new RegExp("("+this.regExpQuote(s)+")","i");if(e.title){var r=e.title.replace(i," "+t);this.title=r}if(e.subtitle){var n=e.subtitle.replace(i," "+t);this.subtitle=n}if(e.author){var o=e.author.replace(i,t);this.author=o}},regExpQuote:function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},toOrdinal:function(e){var t=e%10;return 1===t&&11!==e?e+"st":2===t&&12!==e?e+"nd":3===t&&13!==e?e+"rd":e+"th"},onMouseEnterTBSResult:function(e){this.$el.addClass("tbs-highlight")},onMouseLeaveTBSResult:function(e){this.$el.removeClass("tbs-highlight")},tbsTemplate:_.template('<div class="result-data"><a href="<%- tbs.url %>"><div class="left-info"><%= tbs.cover %></div><div class="right-info"><span class="result-header"><%= tbs.title %>&nbsp;&nbsp;<span class="result-edition"><%= tbs.edition %></span></span><% if(tbs.subtitle!=false){%><span class="result-sub-header"><%= tbs.subtitle %></span><% } %><span class="result-detail"><%= tbs.author %>&nbsp;&bull;&nbsp;ISBN: <%= tbs.isbn %>&nbsp;&bull;&nbsp;ISBN13: <%= tbs.isbn13 %></span></div></a></div>')});return e}()),Eggshell.define("C.fed.serp.book.old",{inputs:{render:{payload:{id:"string",url:"string",title:"string",author:"string",ean:"string",edition:"string","edition-no":"string",hasEbook:"boolean",hasTbs:"boolean",imageUrl:"string",isBundle:"boolean",isDac:"boolean",isEbook:"boolean",isTextbook:"boolean",isbn:"string",lowPrice:"string",highPrice:"string",priceType:"string",listPrice:"string",otherOptions:"object",price:"object",template:"string",hasCourtesyEbook:"boolean"}},"single serp location":{payload:null}},outputs:{},strict:!1},function(){var e=Backbone.View.extend({initialize:function(){this.singleSerp=!1,this.isMobileSearch=!1,Eggshell.find(this).on("render",this.render).on("mobile search",$.proxy(function(){this.isMobileSearch=!0},this))},render:function(e,t){var s=this.transformData(t.results),i=t.config.query;i&&"undefined"!=i||(i=decodeURIComponent(location.pathname.split("/")[2]));var r="0"===s["edition-no"]?"1":s["edition-no"],n=this.getPrice(s),o=this.showPriceGuarantee(s),a=this.isMobileSearch?C.utility.bookCover({imgMedium:s.imageUrl},C.utility.bookCover.medium):C.utility.bookCover({imgLarge:s.imageUrl},C.utility.bookCover.large);this.$el.html(this.booksTemplate({book:{id:s.id,cover:a,overlay:C.global.staticBaseUrl+"s/_global/images/book-overlay-100.png",url:s.url.replace(/^http(s)?:\/\//i,"//"),title:C.utility.highlightText(s.title,i)+(r?" ("+C.utility.ordinal(r)+") ":""),author:C.utility.highlightText(this.getAuthors(s.authors),i),subtitle:s.subtitle?C.utility.highlightText(s.subtitle,i):!1,isbn13:s.ean,isbn:s.isbn,priceType:s.priceType,price:n,hasTbs:s.hasTbs,hasEbook:s.hasEbook,isEbook:s.isEbook,isTextbook:s.isTextbook,otherOptions:null!==s.otherOptions&&0!==s.otherOptions.length,canBuy:null!==s.otherOptions&&-1!=s.otherOptions.indexOf("Buy"),canBuyEbook:null!==s.otherOptions&&-1!=s.otherOptions.indexOf("eTextbook"),listPrice:this.getListPrice(s),hasCourtesyEbook:s.hasCourtesyEbook,priceGuarantee:o}})),o&&this.renderGuaranteeBadge(),this.isMobileSearch||this.createTooltips(t.results)},renderGuaranteeBadge:function(){Eggshell.create("C.common.guarantee.badge",{el:this.$el.find(".guarantee-badge")})},showPriceGuarantee:function(e){return!(!e.priceGuarantee||!C.global.priceMatchGuarantee)},getAuthors:function(e){var t="";if(e)for(i=0;i<e.length;i++){var s=e[i].replace(/(\,)/g,"");t+=0==i?s:", "+s}return t},getListPrice:function(e){var t=null,s=null;"undefined"!=typeof e.price?t=e.price:"undefined"!=typeof e.highPrice&&(t=e.highPrice);var i=e.listPrice;return t&&i&&parseInt(t)<parseInt(i)&&(s=i),s},getPrice:function(e){return"undefined"!=typeof e.price&&null!=e.price?"$"+parseFloat(e.price).toFixed(2):"undefined"!=typeof e.lowPrice&&"undefined"!=typeof e.highPrice?"$"+parseFloat(e.lowPrice).toFixed(2)+" - $"+parseFloat(e.highPrice).toFixed(2):""},createTooltips:function(e){e.hasCourtesyEbook&&this.createCourtseyTooltip(),e.hasEbook&&this.createEbookTooltip(),e.hasTbs&&this.createTbsTooltip()},createCourtseyTooltip:function(){Eggshell.create("C.common.overlay.tooltip").on("return tooltip content node",function(e,t){var s=t;s.html('<span class="tooltip-text">Courtesy eTextbook (7 days FREE)</span>')}).trigger("set target",this.$(".courtsey-icon")).trigger("get tooltip content node")},createEbookTooltip:function(){Eggshell.create("C.common.overlay.tooltip").on("return tooltip content node",function(e,t){var s=t;s.html('<span class="tooltip-text">eTextbook available</span>')}).trigger("set target",this.$(".ebook-icon")).trigger("get tooltip content node")},createTbsTooltip:function(){Eggshell.create("C.common.overlay.tooltip").on("return tooltip content node",function(e,t){var s=t;s.html('<span class="tooltip-text">Textbook Solutions available</span>')}).trigger("set target",this.$(".tbs-tick-icon")).trigger("get tooltip content node")},transformData:function(e){var t=e["edition-no"]||e.priceType||"number"==typeof e.price;return t||(e["edition-no"]=e.edition,e.priceType=e.price?e.price.type:!1,e.lowPrice=e.price?e.price.minPrice:void 0,e.highPrice=e.price?e.price.maxPrice:void 0,e.price=e.price?e.price.price:void 0,e.otherOptions=_.compact(_.map(e.otherOptions,function(e,t){return e?t:void 0}))),e},events:{"click .other-options a":"clickPreSelectionLink"},clickPreSelectionLink:function(e){e.stopPropagation()},booksTemplate:_.template('<div class="result-data"><a href="<%- book.url %>" class="book-cover-link" tabindex="-1"><div class="book-cover"><%= book.cover %></div></a><div class="book-info"><a href="<%- book.url %>"><div class="line-item f-size-03 title"><%= book.title %></div></a><% if(book.subtitle){%><span class="subtitle"><%= book.subtitle %></span><% } %><span class="line-item authors"><span class="detail"><strong>Authors: </strong><%= book.author %></span></span><div class="line-item"><span class="isbn"><strong><% if(book.isEbook){ %> <span class="isbn-title">eISBN:</span><% }else{ %> <span class="isbn-title">ISBN:</span><% } %> <%= book.isbn %></strong></span><span class="isbn13"><strong><% if(book.isEbook){ %> <span class="isbn-title">eISBN13:</span><% }else{ %> <span class="isbn-title">ISBN13:</span><% } %> <%= book.isbn13 %></strong></span></div><div class="line-item"><% if(book.hasCourtesyEbook){ %><span class="textbook-icons courtsey-icon"></span><% } %><% if(book.hasEbook){ %><span class="textbook-icons ebook-icon"></span><% } %><% if(book.hasTbs){ %><span class="textbook-icons tbs-tick-icon"></span><% } %></div></div><div class="price-info"><% if(book.priceType){ %><div class="line-item price-type"><span class="price-title"><%= book.priceType %></span><span class="book-price"><a href="<%- book.url %>&preSelection=<%= book.priceType %>"><%= book.price %></a><% if(book.priceGuarantee){%><span class="guarantee-badge"></span><% } %></span></div><div class="line-item price"><% if(book.listPrice){ %><span class="list-price-title">List price:</span><span class="list-price"><span class="amount">$<%= book.listPrice %></span></span><% } %></div><div class="line-item other"><% if(book.otherOptions){ %><span class="other-price">Other:</span><span class="other-options"><% if(book.canBuy){ %><a class="other-buy" href="<%- book.url %>&preSelection=buy">Buy</a><% } %><% if(book.canBuyEbook){ %>| <a href="<%- book.url %>&preSelection=etextbook">eTextbook</a><% } %></span><% } %></div><% }else { %><span class="price-title out-of-stock">Out of stock</span><% } %></div></div>')});return e}()),Eggshell.define("C.fed.serp.book",{inputs:{render:{payload:{id:"string",url:"string",title:"string",author:"string",ean:"string",edition:"string","edition-no":"string",hasEbook:"boolean",hasTbs:"boolean",imageUrl:"string",isBundle:"boolean",isDac:"boolean",isEbook:"boolean",isTextbook:"boolean",isbn:"string",lowPrice:"string",highPrice:"string",priceType:"string",listPrice:"string",otherOptions:"object",price:"object",template:"string",hasCourtesyEbook:"boolean"}},"single serp location":{payload:null}},outputs:{},strict:!1},function(){var e=Backbone.View.extend({initialize:function(){this.singleSerp=!1,this.isMobileSearch=!1,Eggshell.find(this).on("single serp location",$.proxy(function(){this.singleSerp=!0},this)).on("render",this.render).on("mobile search",$.proxy(function(){this.isMobileSearch=!0},this))},render:function(e,t){var s=this.transformData(t.results),i=t.config.query;i&&"undefined"!=i||(i=decodeURIComponent(location.pathname.split("/")[2]));var r="0"===s["edition-no"]?"1":s["edition-no"],n=this.getPrice(s),o=this.showPriceGuarantee(s),a=this.isMobileSearch?C.utility.bookCover({imgMedium:s.imageUrl},C.utility.bookCover.medium):C.utility.bookCover({imgLarge:s.imageUrl},C.utility.bookCover.large);this.$el.html(this.booksTemplate({book:{id:s.id,cover:a,overlay:C.global.staticBaseUrl+"s/_global/images/book-overlay-100.png",url:s.url,title:C.utility.highlightText(s.title,i)+(r?" ("+C.utility.ordinal(r)+") ":""),subtitle:s.subtitle?C.utility.highlightText(s.subtitle,i):!1,author:C.utility.highlightText(this.getAuthors(s.authors),i),isbn13:s.ean,isbn:s.isbn,priceType:s.priceType,price:n,isEbook:s.isEbook,hasTbs:!1,tbsUrl:s.tbsUrl?s.tbsUrl:"",priceGuarantee:o}})),o&&this.renderGuaranteeBadge()},renderGuaranteeBadge:function(){Eggshell.create("C.common.guarantee.badge",{el:this.$el.find(".guarantee-badge")})},showPriceGuarantee:function(e){return!(!e.priceGuarantee||!C.global.priceMatchGuarantee)},getAuthors:function(e){var t="";if(e)for(i=0;i<e.length;i++){var s=e[i].replace(/(\,)/g,"");t+=0==i?s:", "+s}return t},getPrice:function(e){return"undefined"!=typeof e.price&&null!=e.price?"$"+parseFloat(e.price).toFixed(2):"undefined"!=typeof e.lowPrice&&"undefined"!=typeof e.highPrice?"$"+parseFloat(e.lowPrice).toFixed(2)+" - $"+parseFloat(e.highPrice).toFixed(2):""},transformData:function(e){var t=e["edition-no"]||e.priceType||"number"==typeof e.price;return t||(e["edition-no"]=e.edition,e.priceType=e.price?e.price.type:!1,e.lowPrice=e.price?e.price.minPrice:void 0,e.highPrice=e.price?e.price.maxPrice:void 0,e.price=e.price?e.price.price:void 0,e.otherOptions=_.compact(_.map(e.otherOptions,function(e,t){return e?t:void 0}))),e},booksTemplate:_.template('<div class="result-data <% if(this.singleSerp == true){ %>singleSerp<% } %>"><a href="<%- book.url %>"><div class="left-info"><%= book.cover %></div><div class="right-info"><div class="line-item f-size-03 title"><%= book.title %></div><% if(book.subtitle){%><span class="line-item"><span class="subtitle"><%= book.subtitle %></span></span><% } %><span class="line-item"><span class="detail"><%= book.author %></span></span><div class="line-item"><span class="isbn"><strong><span><% if(book.isEbook){ %> eISBN:<% }else{ %> ISBN:<% } %></span> <%= book.isbn %></strong></span></div><div class="line-item"><span class="isbn13"><strong><span><% if(book.isEbook){ %> eISBN13:<% }else{ %> ISBN13:<% } %></span> <%= book.isbn13 %></strong></span></div></div><div class="line-item rent"><% if(book.priceType){ %><span class="rent-title"><%= book.priceType %></span><span class="arrow-right"></span><span class="price"><strong><%= book.price %></strong><% if(book.priceGuarantee){%><span class="guarantee-badge"></span><% } %></span><% }else{ %><span class="rent-title">Out of stock</span><% } %></div></a><div class="tbs-callout"><% if(book.hasTbs){ %><a href="<%- book.tbsUrl %>" class="tbs tbs-link">View step-by-step solutions</a><% } %></div></div>')});return e}()),Eggshell.define("C.fed.serp.book.inline",{inputs:{render:{payload:{}},"single serp location":{payload:null}},outputs:{},strict:!1},function(){var e=Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(e,t){var s=this.transformData(t.results),i=t.config.query;i&&"undefined"!=i||(i=decodeURIComponent(location.pathname.split("/")[2]));var r="0"===s["edition-no"]?"1":s["edition-no"],n=this.getPrice(s),o=C.utility.bookCover({imgLarge:s.imageUrl},C.utility.bookCover.large),a=this.getTitle(s.title,i,r);this.$el.html(this.booksTemplate({book:{id:s.id,cover:o,overlay:C.global.staticBaseUrl+"s/_global/images/book-overlay-100.png",url:s.url,title:a,subtitle:s.subtitle?C.utility.highlightText(s.subtitle,i):!1,author:C.utility.highlightText(this.getAuthors(s.authors),i),isbn13:s.ean,isbn:s.isbn,priceType:s.priceType,price:n,isEbook:s.isEbook,hasTbs:s.hasTbs,tbsUrl:s.tbsUrl?s.tbsUrl:""}}))},getTitle:function(e,t,s){return e=e.length>30&&"undefined"!=typeof s?C.utility.highlightText(e.substr(0,30),t)+"..."+(s?"("+C.utility.ordinal(s)+")":""):C.utility.highlightText(e,t)+(s?" ("+C.utility.ordinal(s)+") ":"")},getAuthors:function(e){var t="";if(e)for(i=0;i<e.length;i++){var s=e[i].replace(/(\,)/g,"");t+=0==i?s:", "+s}return t},getPrice:function(e){return"undefined"!=typeof e.price&&null!=e.price?"$"+parseFloat(e.price).toFixed(2):"undefined"!=typeof e.lowPrice&&"undefined"!=typeof e.highPrice?"$"+parseFloat(e.lowPrice).toFixed(2)+" - $"+parseFloat(e.highPrice).toFixed(2):""},transformData:function(e){var t=e["edition-no"]||e.priceType||"number"==typeof e.price;return t||(e["edition-no"]=e.edition,e.priceType=e.price?e.price.type:!1,e.lowPrice=e.price?e.price.minPrice:void 0,e.highPrice=e.price?e.price.maxPrice:void 0,e.price=e.price?e.price.price:void 0,e.otherOptions=_.compact(_.map(e.otherOptions,function(e,t){return e?t:void 0}))),e},booksTemplate:_.template('<div class="result-data"><a href="<%- book.url %>"><div class="left-info"><%= book.cover %></div><div class="right-info"><div class="line-item f-size-03 title"><%= book.title %></div><div class="line-item"><span class="isbn"><strong><span class="isbn-title"><% if(book.isEbook){ %> eISBN<% }else{ %> ISBN<% } %></span><%- book.isbn13 %></strong></span></div><div class="line-item rent"><% if(book.priceType){ %><span class="rent-title"><%- book.priceType %></span><span class="price"><strong><%- book.price %></strong></span><% }else{ %><span class="rent-title">Out of stock</span><% } %></div></div></a></div>')});return e}()),Eggshell.define("C.fed.serp.book2",{inputs:{render:{payload:{id:"string",url:"string",title:"string",author:"string",ean:"string",edition_no:"string",hasEbook:"boolean",hasTbs:"boolean",imageUrl:"string",isBundle:"boolean",isDac:"boolean",isEbook:"boolean",isTextbook:"boolean",isbn:"string",listPrice:"string",otherOptions:"object",price:"object",template:"string"}},"single serp location":{payload:null}},outputs:{},strict:!1},function(){var e=Backbone.View.extend({initialize:function(){this.singleSerp=!1,Eggshell.find(this).on("single serp location",$.proxy(function(){this.singleSerp=!0},this)).on("render",this.render)},render:function(e,t){var s=t.results,i=decodeURIComponent(location.pathname.split("/")[2]);i&&"undefined"!=i||(i=t.config.query);var r="0"===s.edition?"1":s.edition,n=this.getPrice(s);this.$el.html(this.booksTemplate({book:{id:s.id,cover:C.global.coversBaseUrl+s.imageUrl,overlay:C.global.staticBaseUrl+"s/_global/images/book-overlay-100.png",url:s.url,title:C.utility.highlightText(s.title,i)+(r?" ("+C.utility.ordinal(r)+") ":""),subtitle:s.subtitle?C.utility.highlightText(s.subtitle,i):!1,author:this.getAuthors(s.authors),isbn13:s.ean,isbn:s.isbn,priceType:s.price?s.price.type:!1,price:n,listPrice:this.getListPrice(s),isEbook:s.isEbook,otherOptions:0!==s.otherOptions.length,canBuy:s.otherOptions.Buy,canBuyEbook:s.otherOptions.eTextbook,hasTbs:s.hasTbs,tbsUrl:s.tbsUrl?s.tbsUrl:""}}))},getAuthors:function(e){var t="";if(e)for(i=0;i<e.length;i++){var s=e[i].replace(/(\,)/g,"");t+=0==i?s:", "+s}return t},getListPrice:function(e){var t=null,s=null;e.price&&(t="undefined"!=typeof e.price.price?e.price.price:e.price.maxPrice);var i=e.listPrice;return t&&i&&parseInt(t)<parseInt(i)&&(s=i),s},getPrice:function(e){return e.price?"undefined"!=typeof e.price.price?"$"+parseFloat(e.price.price).toFixed(2):"$"+parseFloat(e.price.minPrice).toFixed(2)+" - $"+parseFloat(e.price.maxPrice).toFixed(2):""},events:{"click .other-options a":"clickPreSelectionLink"},clickPreSelectionLink:function(e){e.stopPropagation()},booksTemplate:_.template('<div class="result-data <% if(this.singleSerp == true){ %>singleSerp<% } %>"><a href="<%= book.url %>"><div class="left-info"><div  class="book-img-3"><img class="book-cover" src="<%= book.cover %>" onerror="this.src=\'http://c.chegg.com/covers2/imagenalarge.gif\'" /><img  class="book-overlay" src="<%= book.overlay %>" /></div></div><div class="right-info"><div class="line-item f-size-03 title"><%= book.title %></div><% if(book.subtitle){%><span class="line-item"><span class="subtitle"><%= book.subtitle %></span></span><% } %><span class="line-item"><span class="detail"><%= book.author %></span></span><div class="line-item"><span class="isbn"><strong><% if(book.isEbook){ %> eISBN:<% }else{ %> ISBN:<% } %> <%= book.isbn %></strong></span></div><div class="line-item"><span class="isbn13"><strong><% if(book.isEbook){ %> eISBN13:<% }else{ %> ISBN13:<% } %> <%= book.isbn13 %></strong></span></div></div><div class="line-item rent"><% if(book.priceType){ %><span class="rent-title"><%= book.priceType %></span><span class="arrow-right"></span><span class="price"><strong><%= book.price %></strong></span><% if(book.listPrice){ %><span class="list-price"><span class="amount">$<%= book.listPrice %></span></span><% } %><% }else{ %><span class="rent-title">Out of stock</span><% } %></div></a><% if(book.otherOptions){ %><div class="line-item other"><span class="other-title">Options:</span><span class="other-options"><% if(book.canBuy){ %><a class="other-buy" href="<%= book.url %>&preSelection=buy" aria-label="Buy <%= book.title %>">Buy</a><% } %><% if(book.canBuyEbook){ %>| <a href="<%= book.url %>&preSelection=etextbook" aria-label="Buy eTextbook <%= book.title %>">eTextbook</a><% } %></span></div><% } %><div class="tbs-callout"><% if(book.hasTbs){ %><a href="<%= book.tbsUrl %>" class="tbs"><span class="tbs-link">Get Chegg Textbook Solutions</span></a><% } %></div></div>')});return e}()),Eggshell.define("C.fed.serp.book.gridlayout",{inputs:{render:{payload:{}},"single serp location":{payload:null}},outputs:{},strict:!1},function(){var e=Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(e,t){var s=this.transformData(t.results),i=t.config.query;i&&"undefined"!=i||(i=decodeURIComponent(location.pathname.split("/")[2]));var r="0"===s["edition-no"]?"1":s["edition-no"],n=this.getPrice(s),o=C.utility.bookCover({imgLarge:s.imageUrl},C.utility.bookCover.large);if(s.title.length>50)var a=s.title.substr(0,50)+"...";else var a=s.title;this.$el.html(this.booksTemplate({book:{id:s.id,cover:o,overlay:C.global.staticBaseUrl+"s/_global/images/book-overlay-100.png",url:s.url,title:C.utility.highlightText(a,i),edition:r?C.utility.ordinal(r):"",subtitle:s.subtitle?C.utility.highlightText(s.subtitle,i):!1,author:C.utility.highlightText(this.getAuthors(s.authors),i),isbn13:s.ean,isbn:s.isbn,priceType:s.priceType,price:n,isEbook:s.isEbook,hasTbs:s.hasTbs,tbsUrl:s.tbsUrl?s.tbsUrl:"",tbsCover:C.utility.bookCover(s,C.utility.bookCover.thumb,{type:C.utility.bookCover.tbsType})}})),this.$el.parent().parent().addClass("col-6"),this.$el.parent().parent().css("padding-left","0px"),s.showTbsCallout&&this.$el.addClass("has-tbs-callout")},getAuthors:function(e){var t="";if(e)for(i=0;i<e.length;i++){var s=e[i].replace(/(\,)/g,"");t+=0==i?s:", "+s}return t},getPrice:function(e){return"undefined"!=typeof e.price&&null!=e.price?"$"+parseFloat(e.price).toFixed(2):"undefined"!=typeof e.lowPrice&&"undefined"!=typeof e.highPrice?"$"+parseFloat(e.lowPrice).toFixed(2)+" - $"+parseFloat(e.highPrice).toFixed(2):""},transformData:function(e){var t=e["edition-no"]||e.priceType||"number"==typeof e.price;return t||(e["edition-no"]=e.edition,e.priceType=e.price?e.price.type:!1,e.lowPrice=e.price?e.price.minPrice:void 0,e.highPrice=e.price?e.price.maxPrice:void 0,e.price=e.price?e.price.price:void 0,e.otherOptions=_.compact(_.map(e.otherOptions,function(e,t){return e?t:void 0}))),e},booksTemplate:_.template('<div class="result-data books-v2"><a href="<%- book.url %>"><div class="left-info"><%= book.cover %></div><div class="right-info"><div class="book-item f-size-03 title"><%= book.title %></div><div class="book-item"><span class="info-title">Edition</span><span class="info-details"><%= book.edition %></span></span></div><div class="book-item"><span class="info-title">Author</span><span class="info-details"><%= book.author %></span></span></div><div class="book-item"><span class="info-title"><% if(book.isEbook){ %> eISBN13<% }else{ %> ISBN13<% } %></span><span class="info-details"><%= book.isbn13 %></span></div><div class="book-item rent"><% if(book.priceType){ %><span class="info-title"><%= book.priceType %></span><span class="arrow-right"></span><span class="price"><strong><%= book.price %></strong></span><% }else{ %><span class="rent-title">Out of stock</span><% } %></div></div></a><div class="right-info"><% if(book.hasTbs){ %><div class="book-item tbs-callout"><a class="tbs-link tbs" href="<%= book.tbsUrl %>"><%= book.tbsCover %>View step-by-step</br>solutions</a></div><% } %></div></div>')});return e}()),Eggshell.define("C.fed.serp.qa",{inputs:{render:{payload:{url:"string",type:"string",title:"string",question:"string"}}},outputs:{},strict:!1},function(){var e=Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(e,t){searchResult=t.results;var s=t.config.query;s&&"undefined"!=s||(s=decodeURIComponent(location.pathname.split("/")[2])),this.$el.html(this.QNATemplate({qna:{id:searchResult.id,url:searchResult.url,question:searchResult["question-highlight"]?searchResult["question-highlight"]:C.utility.highlightText(searchResult.question||"",s)}}))},QNATemplate:_.template('<div class="qna-question"><div class="question"><strong class="f-size-03">Q:</strong><%= qna.question %></div><span class="answer"><strong class="f-size-03">A:</strong> <a href="<%- qna.url %>">See Answer</a></span></div>')});return e}()),Eggshell.define("C.fed.serp.study",{inputs:{render:{payload:{url:"string",type:"string",title:"string",question:"string"}}},outputs:{},strict:!1},function(){var e=Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(e,t){var s=t.results,i=t.config.query;i&&"undefined"!==i||(i=decodeURIComponent(location.pathname.split("/")[2]));var r=this.createTbsBookTitle(s.bookTitle,s.bookEditionNumber,s.chapterName,s.problemName);if(answer=s.answerDisplay,(answer.toLowerCase().indexOf(".swf")>=0||answer.toLowerCase().indexOf(".png")>=0)&&(answer=""),"federated-intent-srp"===t.config.profile.odinProfileId||"study-group-srp"===t.config.profile.odinProfileId){var n=s["question-highlight"]?s["question-highlight"]:C.utility.highlightText(s.question||"",i);this.$el.html(this.studyV2Template({tbs:{id:s.id,ean:s.ean,answer:answer.length<10?"":answer,title:s.title,bookTitle:"null"!==r||"undefined"!=typeof r?r:"",url:s.url,question:n,source:s.source}})),s.groupitem&&Eggshell.create("C.Search.text.ellipsis",{el:this.$el.find(".question-container").empty()}).trigger("set text",n).trigger("set lines",2).trigger("change more link copy","See solution").trigger("always display more link").trigger("display more link",s.url)}else this.$el.html(this.studyTemplate({tbs:{id:s.id,ean:s.ean,answer:answer.length<10?"":answer,title:s.title,bookTitle:"null"!==r||"undefined"!=typeof r?r:"",url:s.url,question:s["question-highlight"]?s["question-highlight"]:C.utility.highlightText(s.question||"",i),source:s.source}}))},createTbsBookTitle:function(e,t,s,i){return t=t?" ("+C.utility.ordinal(t)+" Edition), ":"",s=s?" Chapter "+s+", ":"",i=i?" Question "+i+" ":"",e+t+s+i},studyV2Template:_.template('<div class="tbs-question"><div class="tbs-wrapper"><% if(tbs.question){ %><span class="question"><strong>Q:</strong><span class="question-container"><%= tbs.question %></span></span><% } %><% if(tbs.bookTitle && tbs.source !== "board"){ %><span class="book"><%- tbs.bookTitle %></span><% } %><span class="answer-wrapper"><% if(tbs.answer){ %><a href="<%- tbs.url %>" tabindex="-1"><span class="answer shorten"><span class="pre-answer">A:</span><span class="answer-container"> <%= tbs.answer %></span></span> <a href="<%- tbs.url %>" class="see-answer" tabindex="-1">See solution</a></a><% } else { %><a href="<%- tbs.url %>" tabindex="-1"><span class="pre-answer">A:</span> <a href="<%- tbs.url %>" class="see-answer answer-container" tabindex="-1">See solution</a></a><% } %></span></div></div>'),studyTemplate:_.template('<div class="tbs-question"><div class="tbs-wrapper"><% if(tbs.question){ %><span class="question"><strong>Q:</strong><span class="question-container"><%= tbs.question %></span></span><% } %><% if(tbs.bookTitle && tbs.source !== "board"){ %><span class="book"><%- tbs.bookTitle %></span><% } %><span class="answer-wrapper"><% if(tbs.source == "board"){ %><% if(tbs.answer){ %><a href="<%- tbs.url %>" tabindex="-1"><span class="answer shorten"><span class="pre-answer">A:</span><span class="answer-container"> <%= tbs.answer %></span></span> <a href="<%- tbs.url %>" class="see-answer" tabindex="-1">See answer</a></a><% } else { %><a href="<%- tbs.url %>" tabindex="-1"><span class="pre-answer">A:</span> <a href="<%- tbs.url %>" class="see-answer answer-container" tabindex="-1">See answer</a></a><% } %><% }else{ %><% if(tbs.answer){ %><a href="<%- tbs.url %>" tabindex="-1"><span class="answer shorten"><span class="pre-answer">A:</span><span class="answer-container"> <%- tbs.answer %></span></span> <a href="<%- tbs.url %>" class="see-answer" tabindex="-1">See solution</a></a><% }else{ %><a href="<%- tbs.url %>" tabindex="-1"><span class="pre-answer">A:</span> <a href="<%- tbs.url %>" class="see-answer answer-container" tabindex="-1">Solution available</a></a><% } %><% } %></span></div></div>')});return e}()),Eggshell.define("C.fed.serp.tbs.problem",{inputs:{render:{payload:{url:"string",type:"string",title:"string",question:"string"}}},outputs:{},strict:!1},function(){var e=Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(e,t){searchResult=t.results;var s=t.config.query;s&&"undefined"!=s||(s=decodeURIComponent(location.pathname.split("/")[2])),this.$el.html(this.tbsQuestionTemplate({tbs:{id:searchResult.id,ean:searchResult.ean,bookTitle:this.createTbsBookTitle(searchResult.bookTitle,searchResult.bookEditionNumber,searchResult.chapterName,searchResult.problemName),url:searchResult.url,question:searchResult["question-highlight"]?searchResult["question-highlight"]:C.utility.highlightText(searchResult.question||"",s)}}))},createTbsBookTitle:function(e,t,s,i){return t=t?" ("+C.utility.ordinal(t)+" Edition), ":"",s=s?" Chapter "+s+", ":"",i=i?" Question "+i+" ":"",e+t+s+i},tbsQuestionTemplate:_.template('<div class="tbs-question"><% if(tbs.question){ %><span class="question"><strong class="f-size-03">Q:</strong><%= tbs.question %></span><% } %><span class="book"><%- tbs.bookTitle %></span><span class="solution"><strong class="f-size-03">S:</strong> <a href="<%- tbs.url %>">View Solution</a></span></div>')});return e}()),Eggshell.define("C.fed.serp.tbs.book",{inputs:{render:{payload:{id:"string",component:"string",url:"string",tbsUrl:"string",title:"string",long_title:"string",author:"string",isbn:"string",ean:"string",edition_no:"string",solutionCount:"string",subtitle:"string"}},"single serp location":{payload:{location:"string"}}},outputs:{},strict:!1},function(){var e=Backbone.View.extend({initialize:function(){this.isMobileSearch=!1,Eggshell.find(this).on("render",this.render).on("mobile search",$.proxy(function(){this.isMobileSearch=!0},this))},render:function(e,t){searchResult=t.results;var s=t.config.query;s&&"undefined"!=s||(s=decodeURIComponent(location.pathname.split("/")[2]));var i="0"===searchResult["edition-no"]?"1":searchResult["edition-no"];this.$el.html(this.tbsTemplate({tbs:{id:searchResult.id,url:searchResult.tbsUrl||searchResult.url,title:C.utility.highlightText(searchResult.title,s)+(i?" | "+C.utility.ordinal(i)+" ":""),cover:C.utility.bookCover(searchResult,this.isMobileSearch?C.utility.bookCover.thumb:C.utility.bookCover.small,{type:C.utility.bookCover.tbsType}),author:C.utility.highlightText(this.getAuthors(searchResult.authors),s),isbn13:searchResult.ean?searchResult.ean:"",isbn:searchResult.isbn?searchResult.isbn:"",subTitle:searchResult.subtitle?C.utility.highlightText(searchResult.subtitle,s):"",location:"Textbook solutions"==t.config.profile.title&&"federated-tbs-problem-srp"!=t.config.profile.odinProfileId}}))},getAuthors:function(e){var t="";if(e)for(i=0;i<e.length;i++){var s=e[i].replace(/(\,)/g,"");t+=0==i?s:", "+s}return t},tbsTemplate:_.template('<a href="<%- tbs.url %>"><div class="result-data <% if(tbs.location){%>single-serp<%}%>"><div class="left-info"><%= tbs.cover %></div><div class="right-info"><div class="line-item f-size-03 title"><%= tbs.title %></div><% if(tbs.subTitle){ %><div class="line-item f-size-02 sub-title"><%= tbs.subTitle %></div><% } %><span class="line-item authors"><span class="detail"><strong>Authors: </strong><%= tbs.author %></span></span><div class="line-item"><span class="isbn13"><strong> ISBN13: </strong><%= tbs.isbn13 %></span><span class="isbn"><strong> ISBN: </strong><%= tbs.isbn %></span></div></div></div></a>')
});return e}()),Eggshell.define("C.fed.serp.tbs.book.inline",{inputs:{render:{payload:{id:"string",component:"string",url:"string",tbsUrl:"string",title:"string",long_title:"string",author:"string",isbn:"string",ean:"string",edition_no:"string",solutionCount:"string",subtitle:"string"}},"single serp location":{payload:{location:"string"}}},outputs:{},strict:!1},function(){var e=Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(e,t){searchResult=t.results;var s=t.config.query;s&&"undefined"!=s||(s=decodeURIComponent(location.pathname.split("/")[2]));var i="0"===searchResult["edition-no"]?"1":searchResult["edition-no"],r=this.getTitle(searchResult.title,s,i);this.$el.html(this.tbsTemplate({tbs:{id:searchResult.id,url:searchResult.tbsUrl||searchResult.url,title:r,cover:C.utility.bookCover(searchResult,C.utility.bookCover.small,{type:C.utility.bookCover.tbsType}),author:C.utility.highlightText(this.getAuthors(searchResult.authors),s),isbn13:searchResult.ean?searchResult.ean:"",isbn:searchResult.isbn?searchResult.isbn:"",subTitle:searchResult.subtitle?C.utility.highlightText(searchResult.subtitle,s):"",location:"Textbook solutions"==t.config.profile.title&&"federated-tbs-problem-srp"!=t.config.profile.odinProfileId}}))},getTitle:function(e,t,s){return e=e.length>28&&"undefined"!=typeof s?C.utility.highlightText(e.substr(0,28),t)+"..."+(s?"("+C.utility.ordinal(s)+")":""):C.utility.highlightText(e,t)+(s?" ("+C.utility.ordinal(s)+") ":"")},getAuthors:function(e){var t="";if(e)for(i=0;i<e.length;i++){var s=e[i].replace(/(\,)/g,"");t+=0==i?s:", "+s}return t},tbsTemplate:_.template('<a href="<%- tbs.url %>" tabindex="-1"><div class="result-data <% if(tbs.location){%>single-serp<%}%>"><div class="left-info"><%= tbs.cover %></div><div class="right-info"><span class="line-item f-size-03 title"><%= tbs.title %></span></div></div></a>')});return e}()),Eggshell.define("C.common.search.serp",{inputs:{render:{payload:{ajaxEndpoint:"string",filters:"object",page:"number",size:"number"}}},outputs:{"search result item clicked":{payload:"object"},rendered:{payload:null}},strict:!1},function(){var e=Backbone.Model.extend({load:function(){var e=this.get("payload"),t=e.ajaxEndpoint,s=10,i=e.page?e.page:1;$.ajax({url:t,type:"get",dataType:"json",data:{query:e.query,filters:{},page:i,size:s,trackid:e.trackid,strackid:e.strackid,token:C.global.csrfToken},context:this,success:function(e){return null==e||0==e.count?(this.trigger("failToLoad"),void this.set("searchResult",e)):(this.set("searchResult",e),void this.trigger("loaded"))},error:function(e){this.trigger("failToLoad")}})}}),t=Backbone.View.extend({rank:1,initialize:function(){this.model=new e,this.model.on("loaded",this.render,this),this.model.on("failToLoad",this.renderError,this),Eggshell.find(this).on("render",this.load)},load:function(e,t,s){location.hash&&"undefined"==typeof s&&(s=location.hash.substr(3)),"undefined"!=typeof s&&(t.page=Number(s),location.hash="#p="+s,this.scrollToTop(),$(".serp-content").remove(),this.showSpinner()),this.rank=s>0?10*(s-1)+1:1,Eggshell.find("C.search.trackid").on("track ids",$.proxy(function(e,t){this.trackid=t.trackid,this.strackid=t.strackid,this.model.set("trackid",this.trackid),this.model.set("strackid",this.strackid)},this)).trigger("get track ids"),this.trackid&&(t.trackid=this.trackid),this.strackid&&(t.strackid=this.strackid),t.query=this.getQuery(),this.model.set("payload",t),this.model.load()},render:function(){var e=this.model.get("payload");this.$el.html(this.template({advertisment:e.advertisment}));var t=Eggshell.find("C.common.advertisements");Eggshell.trigger(t,"render"),this.createSerpHeader(),this.createSerpPagination(),this.createLoadingIndicator(),$(".serp-content").remove(),this.$(".serp-list").append($('<ul class="serp-content"></ul>')),$serpContent=$(".serp-content");var s=this.model.get("searchResult").searchResult;"undefined"==typeof e.page&&(e.page=1);var i=10*(e.page-1);for(var r in s)for(var n=0;n<s[r].length;n++)this.rank+=n,"undefined"!=typeof s[r][n].url&&(s[r][n].url+=this.getTrackUrl(s[r][n],++i)),s[r][n].component&&Eggshell.create(s[r][n].component,{el:$('<li class="item-result" id='+s[r][n].id+"></li>").appendTo($serpContent)}).trigger("render",s[r][n]);this.Eggshell.trigger("rendered")},generateTrackId:function(){var e=Math.abs(4294967295*Math.random()<<0).toString(16);return("000000000"+e).slice(-8)},getTrackUrl:function(e,t){return this.trackid&&this.strackid?"?trackid="+this.trackid+"&strackid="+this.strackid+"&ii="+t:(this.trackid=e.trackid,"?trackid="+e.trackid+"&strackid="+this.strackid+"&ii="+t)},getTrackParams:function(){var e=C.utility.json2UriParams(_.pick(this.model.get("payload"),"trackid","strackid"));return e?"?"+e:""},getPopularSubjects:function(){return["Computer Science","Physics","Economics","Writing","Statistics","Accounting","Chemistry","Calculus","Biology","Finance"]},scrollToTop:function(){$("html, body").stop().animate({scrollTop:0},300)},showSpinner:function(){this.loadingIndicator&&this.loadingIndicator.show()},hideSpinner:function(){this.loadingIndicator&&this.loadingIndicator.hide()},getQuery:function(){var e=window.location.pathname,t=e.split("/"),s=t[2];return s},getQuery2:function(){var e=new RegExp("[\\?&]q=([^&#]*)"),t="";return query_array=e.exec(location.search),Array.isArray(query_array)&&(t=query_array.pop()),t},renderError:function(){var e=this.model.get("payload");this.$el.html(this.template({advertisment:e.advertisment}));var t=Eggshell.find("C.common.advertisements");Eggshell.trigger(t,"render"),this.createSerpHeader(),this.showNoResults()},template:_.template('<div class="row"><div class="col-10 col-first"><div class="serp-container"><div class="serp-headline"></div><div class="serp-subheadline"></div><div class="serp-list"></div><div class="serp-pagination"></div></div></div><div class="col-2 col-last"><div class="chg-ad"><div class="chg-display" data-unit="<%= advertisment %>" data-size="160x600"></div></div></div></div>'),createLoadingIndicator:function(){this.loadingIndicator=$('<div class="chg-search-loading"><canvas height="30" width="30"></canvas><br/>Loading</div>'),this.$el.append(this.loadingIndicator),this.spinner=new C.widget.spinner({canvas:$(".chg-search-loading canvas"),color:"#ffffff"}),this.hideSpinner()},createSerpPagination:function(){var e=this.model.get("payload"),t=this.model.get("searchResult");"undefined"==typeof e.page&&(e.page=1),this.$pagination=Eggshell.create("C.Eggshell.pagination",{el:this.$(".serp-pagination")}).trigger("totalItemsNum",t.count).trigger("itemsPerPage",10).trigger("currentPage",e.page).trigger("showPageDesc",!0).trigger("render"),$(".C-Eggshell-pagination a").click($.proxy(function(t){var s=$(t.target);return pageNumber=Math.max(1,parseInt(s.attr("href"),10)),this.load(t,e,pageNumber),!1},this))},createSerpHeader:function(){if(e=this.model.get("searchResult"),"undefined"==typeof e)var e={count:0};this.$header=Eggshell.create("C.common.search.serp.header",{el:this.$(".serp-headline")}).trigger("render",{count:e.count,trackid:this.trackid,strackid:this.strackid})},onMouseOverSelection:function(e){var t=$(e.target).closest(".item-result");t.length&&($(".serp-content").find(".item-result").removeClass("selected"),t.addClass("selected"))},onMouseLeaveSelection:function(e){$(".serp-content").find(".item-result").removeClass("selected")},parseLink:function(e){var t=/^https?:\/\//,s=/^[^\/]/;return t.test(e)?e=e:s.test(e)&&(e="/"+e),e},onTutorSelectionClick:function(e){var t=$(e.target).closest(".tutor-card").find("a").attr("href");return t&&C.utility.navigate(this.parseLink(t)),!1},onSelectionClick:function(e){var t=$(e.target).closest(".item-result").find("a").attr("href");return t&&C.utility.navigate(this.parseLink(t)),!1},showNoResults:function(){if(this.hideSpinner(),0===this.$(".no-results").length){var e=this.getQuery();e=decodeURIComponent(e);var t=window.location.pathname;if(-1!==t.indexOf("/")){var s=t.split("/"),i=s[3],r={searchTerm:e},n=null,o=".serp-container";"books"===i?n=this.tmplNoResults:"textbook-solutions"===i?n=this.tmplTBSNoResults:"questions-and-answers"===i?n=this.tmplQNANoResults:"tutors"===i?(n=this.tmplTutorNoResults,o=".serp-list",$("#tutors-search-content .placeholder").hide(),r.links=this.getPopularSubjects(),r.trackParams=this.getTrackParams()):o=null,n&&o&&this.$(o).append($(n(r)))}}},showNoResults2:function(){if(this.hideSpinner(),0===this.$(".no-results").length){var e=this.getQuery();e=decodeURIComponent(e);var t=window.location.pathname;if(-1!==t.indexOf("/")){var s=t.split("/");if(Array.isArray(s)&&s[2]){var i=s[2];"books"==i?this.$(".serp-container").append($(this.tmplNoResults({searchTerm:e}))):"textbook-solutions"==i?this.$(".serp-container").append($(this.tmplTBSNoResults({searchTerm:e}))):"questions-and-answers"==i?this.$(".serp-container").append($(this.tmplQNANoResults({searchTerm:e}))):"tutors"==i&&($("#tutors-search-content .placeholder").hide(),this.$(".serp-list").append($(this.tmplTutorNoResults({searchTerm:e,links:this.getPopularSubjects(),trackParams:this.getTrackParams()}))))}}}},events:{"mouseover .item-result":"onMouseOverSelection","mouseleave .serp-content":"onMouseLeaveSelection","click .item-result .tutor-card a":"onTutorSelectionClick","click .item-result a":"onSelectionClick"},tmplNoResults:_.template('<div class="no-results"><div class="no-results-img"><img src="/s/search/images/gary_no_serp_results.png"/></div><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2">We can\'t find <span class="search-term"><%- searchTerm %></span></p><p class="title-3"><span class="title-bold">Double check the ISBN or spelling.</span><span> You can search title, ISBN or author\'s name.</span></p></div></div>'),tmplTBSNoResults:_.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2">We can\'t find any textbook solutions for <span class="search-term"><%- searchTerm %></span></p><p class="title-2">Please double check the ISBN or spelling.<br><span class="subtext"> You can search title, ISBN or author\'s name.</span></p></div></div>'),tmplQNANoResults:_.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2">We can\'t find any questions for <span class="search-term"><%- searchTerm %></span></p></div></div>'),tmplTutorNoResults:_.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2">We can\'t find any tutoring for <span class="search-term"><%- searchTerm %></span></p><p class="title-2">Please select one of the following popular tutoring subjects:</p></div><ul class="popular-subjects"><% _.each(links, function(link){ %><li><a href="/search/<%- link.replace(\' \', \'-\') %>/tutors/<%- trackParams %>"><%- link %></a></li><% }) %></ul></div>')});return t}()),Eggshell.define("C.common.search.list",{inputs:{render:{payload:{ajaxEndpoint:"string",target:"object",filters:"object",source:"string",token:"string"}},show:{payload:null},hide:{payload:null},update:{payload:{query:"string"}},"go to the next search result":{payload:null},"go to the previous search result":{payload:null},"disable auto resize":{payload:null}},outputs:{},strict:!1},function(){var e=Backbone.Model.extend({load:function(e){this.set("uqry",e.query),$.cjax({url:this.url,type:"get",dataType:"json",timeout:3e3,data:{query:e.query,filters:this.filters,source:this.source,format:this.filters.format,token:this.token},context:this,success:function(e){this.set("searchResult",e),"undefined"!=typeof e.trackId&&(C.global.pageObject.opts.searchTrackId=e.trackId),this.trigger("loaded")},error:function(e){this.trigger("failToLoad")}})},setup:function(e){this.url=e.ajaxEndpoint,this.target=e.target,this.filters=e.filters,this.source=e.source?e.source:null,this.token=e.token,this.set("target",this.target)}}),t=Backbone.View.extend({initialize:function(){this.model=new e,this.model.on("loaded",this.render,this),this.model.on("failToLoad",this.renderError,this),this.model.on("list loaded",this.postRender,this),Eggshell.find(this).on("update",this.load).on("render",this.setup).on("show",this.show).on("hide",this.hide);var t=Eggshell.create("C.Eggshell.window.resize.tracker");t.on("resize",this.handleResize,this),this.mouseInDropdown=!1},postRender:function(){var e=this.model.get("searchResult").trackId,t=encodeURIComponent(this.model.target.val());if("tbsglass"===this.model.source){var s=C.global.cheggSiteUrl+"search/"+t+"/textbook-solutions?trackid="+e;this.$searchlist.append('<li><a href="'+s+'"><div class="tbs-view-all">View all search results</div></a></li>')}else if("qnaglass"===this.model.source){var s=C.global.cheggSiteUrl+"search/"+t+"/questions-and-answers?trackid="+e;this.$searchlist.append('<li class="qna-view-all"><a href="'+s+'">View all search results</a><input type="button" class="btn-secondary-sm post-question-button" value="Post new question"/></li>')}this.show()},render:function(){var e="",t=this.model.source;if(e="tbsglass"===t?"tbs":"qnaglass"===t?"qna":"textbooks"===t?"textbooks":"tutor","textbooks"==e)var s=this.model.get("searchResult");else var s=this.model.get("searchResult").searchResult[e];$(".search-list").remove(),this.$el.append('<ul class="search-list"></ul>'),this.$searchlist=$(".search-list");for(var i=this.model.filters.count?this.model.filters.count:5,r=s.length<i?s.length:i,n=0;r>n;n++)0==n&&$(".item-result").addClass("first"),"qnaglass"===t&&this.trimText(s[n]),"tutorsglass"===t&&(s[n].component="C.common.search.result.subject"),s[n].searchBy=this.model.get("uqry"),Eggshell.create(s[n].component,{el:$('<li class="item-result" id='+s[n].id+"></li>").appendTo(this.$searchlist)}).trigger("render",s[n]);this.handleResize(),this.trigger("list loaded")},trimText:function(e){e.transcribedData?e.transcribedData.length>130&&(e.transcribedData=e.transcribedData.substring(0,130)+"..."):e.text.length>130&&(e.text=e.text.substring(0,130)+"...")},handleResize:function(){var e=this.model.get("target");this.$searchlist&&(void 0!==this.model.filters.listPadding?this.$searchlist.width(e.width()+this.model.filters.listPadding):"textbooks"==this.model.source?this.$searchlist.width(e.width()+32):this.$searchlist.width(e.width()+20)),this.$(".result-header, .result-sub-header, .result-detail").css("maxWidth",e.width()-70+"px")},show:function(){$(".C-common-search-list").css({visibility:"visible",opacity:"1",display:"block"})},hide:function(){$(".C-common-search-list").css({visibility:"hidden"})},setup:function(e,t){var s={};jQuery.extend(s,t),s.target.prev().click($.proxy(function(e){var t=this.getDestination(),i=encodeURIComponent(s.target.val());return C.utility.navigate(C.global.cheggSiteUrl+"search/"+i+"/"+t),!1},this)),s.target.next().click($.proxy(function(e){this.resetSearch(e,s.target)},this)),s.target.keyup($.proxy(function(e){this.onKeyUp(e)},this)),s.target.click($.proxy(function(e){this.onKeyUp(e)},this)),s.target.blur($.proxy(function(e){this.onTextboxBlur(e,s)},this)),this.model.setup(s)},renderError:function(){$(".search-list").remove(),this.$el.append($('<ul class="search-list"></ul>')),this.$searchlist=$(".search-list"),this.getSearchCategories();var e=this.model.get("target");this.$searchlist.height(115),this.$searchlist.width(e.width()+105+30+15+20)},load:function(e){this.model.load(e)},resetSearch:function(e,t){e.preventDefault(),e.stopPropagation(),t.val(""),t.next().hide(),this.$currentSelectedItem=null},onMouseOverSelection:function(e){var t=$(e.target).closest(".item-result");t.length&&($(".search-list").find(".item-result").removeClass("selected"),t.addClass("selected")),this.changeSelection(t)},onMouseOutSelection:function(e){var t=$(e.target).closest(".item-result");t.removeClass("selected")},generateTrackId:function(){var e=Math.abs(4294967295*Math.random()<<0).toString(16);return("000000000"+e).slice(-8)},onSelectionClick:function(e){if(this.hide(),null==this.$currentSelectedItem){if("tutorsglass"!==this.model.source){var t=encodeURIComponent($(e.target).val()),s=this.getDestination(),i=this.model.get("searchResult").trackId;"undefined"==typeof i&&(i=this.generateTrackId()),C.utility.navigate(C.global.cheggSiteUrl+"search/"+t+"/"+s+"?trackid="+i)}return!1}var r=this.$currentSelectedItem.find("a").attr("href");return r&&C.utility.navigate(C.global.cheggSiteUrl+r),!1},onKeyUp:function(e){var t=$(e.target).val();e.stopPropagation(),40==e.keyCode?(this.doNextSelection(e),e.preventDefault(),this.trigger("go to the next search result")):38==e.keyCode?(this.doPrevSelection(e),e.preventDefault(),this.trigger("go to the previous search result")):27==e.keyCode?(this.hide(),this.trigger("hide")):13==e.keyCode?(this.onSelectionClick(e),this.hide(),this.$currentSelectedItem=null):46==e.keyCode||8==e.keyCode?t.length<3?(this.hide(),0==t.length&&$(e.target).next().hide()):(this.load({query:t}),this.show()):(t.length>0&&$(e.target).next().show(),t.length>=2&&(this.load({query:t}),this.show()))},events:{"mouseover .item-result":"onMouseOverSelection","mouseout .item-result":"onMouseOutSelection","click .item-result a":"onSelectionClick","keydown .search-list":"onKeyUp","mouseenter .search-list":"onMouseEnter","mouseleave .search-list":"onMouseLeave"},hideResults:function(){$(".search-list").hide()},onTextboxBlur:function(e,t){this.mouseInDropdown||t.target.is(":focus")||(this.hide(),this.$currentSelectedItem=null)},onMouseEnter:function(){this.mouseInDropdown||(this.mouseInDropdown=!0)},onMouseLeave:function(){this.mouseInDropdown&&(this.mouseInDropdown=!1),this.$currentSelectedItem=null,$(".search-list").find(".item-result").removeClass("selected")},doNextSelection:function(e){var t=$(".search-list").find(".item-result"),s=t.index($(".search-list").find(".selected"));if(t.removeClass("selected"),-1==s||s>=t.length-1)var i=t.eq(0).addClass("selected");else var i=t.eq(s+1).addClass("selected");this.changeSelection(i)},doPrevSelection:function(e){var t=$(".search-list").find(".item-result"),s=t.index($(".search-list").find(".selected"));if(t.removeClass("selected"),-1==s||0===s)var i=t.eq(t.length-1).addClass("selected");else var i=t.eq(s-1).addClass("selected");this.changeSelection(i)},changeSelection:function(e){this.$currentSelectedItem=e},getDestination:function(){switch(this.model.source){case"tbsglass":return"textbook-solutions";case"qnaglass":return"questions-and-answers";case"textbooks":return"books"}return!1}});return t}()),Eggshell.define("C.common.search.serp.filter",{inputs:{"set tab options":{payload:"object"},"set selected filter":{payload:"string"},render:{payload:null}},outputs:{"filter selected":{payload:"string"},rendered:{payload:null}}},function(){var e=Backbone.Model.extend({initialize:function(){this.set("currentTab",null),this.set("tabs",[])}}),t=Backbone.View.extend({tmpl:_.template('<ul><li class="title"><%- title %></li><% _.each(tabs, function(tab, key) { %> <li class="<% if(tab.class){ %><%-tab.class%><% } %><% if(currentTab == key){ %> active<% } %>" data-id="<%- key %>"><a href="<%- tab.url %>"><%- tab.name %></a></li><%}) %></ul>'),events:{"click ul li[data-id] a":"tabClick"},initialize:function(){this.model=new e,Eggshell.find(this).on("set tab options",this.setTabOptions).on("set selected filter",this.setSelectedFilter).on("render",this.render)},render:function(e,t){this.$el.prepend(this.tmpl({title:C.resource.fetch("C.common.search.serp.filter.title"),tabs:this.model.get("tabs"),currentTab:this.model.get("currentTab")})),Eggshell.find(this).trigger("rendered")},setTabOptions:function(e,t){if(!t)throw"Empty payload";this.model.set("tabs",t),_.size(t)>0&&this.model.set("currentTab",_.pairs(t)[0])},setSelectedFilter:function(e,t){this.model.set("currentTab",t),this.$("ul li[data-id]").removeClass("active"),this.$('ul li[data-id="'+t+'"]').addClass("active")},tabClick:function(e){e.preventDefault(),Eggshell.find("C.search.firehose").on("firehose tracking complete",$.proxy(function(){C.utility.navigate(e.target.getAttribute("href"))},this));var t=$(e.currentTarget).parent("li[data-id]").data("id");this.model.get("currentTab")!=t&&(this.setSelectedFilter(e,t),Eggshell.find(this).trigger("filter selected",t))}});return t}()),Eggshell.define("C.common.search.serp.header",{inputs:{render:{payload:{count:"string",trackid:"string",strackid:"string"}}},outputs:{"search result item clicked":{payload:"object"}},strict:!1},function(){var e=Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(e,t){var s=this.getQuery();t.count>500&&(t.count="500+"),this.$el.prepend(this.template({headline:{count:t.count,trackid:t.trackid,strackid:t.strackid,query:decodeURIComponent(s),urlquery:s}})),this.getSelectedTab()},onTabClick:function(e){e.preventDefault();var t=$(e.target).find("a").attr("href");return C.utility.navigate(C.global.cheggSiteUrl+t),!1},getSelectedTab:function(){var e=window.location.pathname;if(-1!==e.indexOf("/")){var t=e.split("/"),s=t[3];"books"==s?this.$el.find(".books").addClass("selected"):"textbook-solutions"==s?this.$el.find(".textbook-solutions").addClass("selected"):"questions-and-answers"==s?this.$el.find(".questions-and-answers").addClass("selected"):"tutors"==s&&this.$el.find(".tutors").addClass("selected")}},getQuery:function(){var e=window.location.pathname,t="";if(-1!==e.indexOf("/")){var s=e.split("/");t=s[2]}return t},events:{"click .serp-single-tab a":"onTabClick"},template:_.template('<div class="serp-header"><div class="serp-tabs"><a href="/search/<%-headline.urlquery%>/books?trackid=<%- headline.trackid %>&strackid=<%- headline.strackid %>&event=filter_select" class="serp-single-tab books"><h2>Books</h2></a><a href="/search/<%-headline.urlquery%>/textbook-solutions?trackid=<%- headline.trackid %>&strackid=<%- headline.strackid %>&event=filter_select" class="serp-single-tab textbook-solutions"><h2>Textbook Solutions</h2></a><a href="/search/<%-headline.urlquery%>/questions-and-answers?trackid=<%- headline.trackid %>&strackid=<%- headline.strackid %>&event=filter_select" class="serp-single-tab questions-and-answers"><h2>Q&A</h2></a><a href="/search/<%-headline.urlquery%>/tutors?trackid=<%- headline.trackid %>&strackid=<%- headline.strackid %>&event=filter_select" class="serp-single-tab tutors"><h2>Tutors</h2></a></div><div class="result-details"><h2><span class="result-count"><%- headline.count %> </span>results for<span class="result-query"> <%- headline.query %></span></h2></div></div>')});return e}()),Eggshell.define("C.common.search.serp.tutor",{inputs:{render:{payload:{}}},outputs:{},strict:!1},function(){var e=Backbone.Model.extend({urlRoot:"/_ajax/tutors",getTutorsBySubject:function(e){var t="undefined"!=typeof e.count?e.count:3,s="undefined"!=typeof e.noSubjectCheck?e.noSubjectCheck:1;return this.fetch({data:{token:C.global.csrfToken,subjectId:e.subjectId,subjectName:e.subjectName,campaign:"Chegg_SERP-tutor-page",limit:t,noSubjectCheck:s}})}}),t=Backbone.View.extend({templates:{tutorCard:_.template('<div class="col-4 <%= cssClassName %>"><%= result %></div>'),viewAll:_.template('<div class="view-all col-4 col-last"><a href="<%= url %>">View All</a></div>'),tutorList:_.template('<div class="tutor-list row"><%= result %></div>'),noTutorAvailable:_.template('<div class="msg-info-lg"><div class="msg-icon"><div class="msg-header">No Tutors Available</div><div class="msg-text">All tutors are offline for this subject currently, please check back later.</div></div></div>')},render:function(e){if(_.isNull(e))var t=this.templates.noTutorAvailable();else{var s=$("<div></div>"),i=e.tutors||[],r=C.utility.getParamsByUrl(e.subjectURL),n=r.trackid,o=r.strackid,a=r.ii;_.each(i,_.bind(function(e,t){var i=t%2==0?"col-first":"col-last",r=$('<div class="tutor-card tutor-row col-4 '+i+'"></div>');Eggshell.create("C.common.tutors.tutor",{el:r}).trigger("get tbs tutor",e),tutorLink=r.find("a").attr("href"),r.find("a").attr("href",tutorLink+"&trackid="+n+"&strackid="+o+"&ii="+a),s.append(r)},this)),s.append(this.templates.viewAll({url:e.subjectURL}));var t=this.templates.tutorList({result:s.html()});this.$el.html(t)}}}),s=Backbone.View.extend({subjectTemplate:_.template('<div class="serp-tutor-subject-container row" data-name="<%= subject.nameOriginal %>" id="<%= subject.id %>"><div class="col-4 col-first subject-name"><a href="/tutors/<%= subject.url %>" ><%= subject.name %></a></div><div class="col-8 tutor_list_<%= subject.id %>"><div class="tutor-list row"><div class="view-all tutor-card tutor-row col-4 col-first"></div><div class="view-all tutor-card tutor-row col-4 col-last"></div><div class="view-all tutor-card tutor-row col-4 col-first"></div><div class="view-all col-4 col-last"></div></div></div></div>'),noSubjectTemplate:_.template('<div class="serp-tutor-subject-container row""><div class="msg-info-lg"><div class="msg-icon"><div class="msg-header">Subject not exist ?</div><div class="msg-text">Please try use another subject keyword to search your tutors.</div></div></div></div>'),initialize:function(){Eggshell.find(this).on("render",this.render),this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;"},render:function(e,t){t&&t.id&&t.name?(this.$el.html(this.subjectTemplate({subject:{id:t.id,nameOriginal:t.name,name:t.name,url:t.url.replace("?","-online-tutoring/?")}})),this.getTutorsBySubject(t)):this.$el.html(this.noSubjectTemplate())},getTutorsBySubject:function(s){var i=new e,r=i.getTutorsBySubject({subjectId:s.id,subjectName:s.name}),n=new t({el:this.$(".tutor_list_"+s.id)});r.done(_.bind(function(e){_.has(e,"tutors")?n.render({tutors:e.tutors,url:e.url,subjectURL:this.$(".subject-name a").attr("href")}):n.render(null)},this)),r.fail(function(){n.render(null)})}});return s}()),Eggshell.define("C.common.search.serp.tutor.mobile",{inputs:{render:{payload:{}}},outputs:{},strict:!1},function(){var e=Backbone.Model.extend({urlRoot:function(){var e="undefined"!=typeof C&&C.global&&C.global.cheggSiteSecureUrl?C.global.cheggSiteSecureUrl:"/";return e+"_ajax/tutors"},getTutorsBySubject:function(e){var t="undefined"!=typeof e.count?e.count:3,s="undefined"!=typeof e.noSubjectCheck?e.noSubjectCheck:1,i=this;this.fetch({data:{token:C.global.csrfToken,subjectId:e.subjectId,subjectName:e.subjectName,campaign:"Chegg_SERP-tutor-page",limit:t,noSubjectCheck:s},success:function(e,t){i.trigger("loaded",t)},error:function(){i.trigger("failToLoad")}})}}),t=Backbone.View.extend({temp:{list:_.template('<div class="serp-tutor-subject-container"><div href="/tutors/<%- url %>"><a class="subject-name"><%= name %></a><span class="see_all">See all &rsaquo;</span></div><ul class="tutor-list"></ul></div>'),item:_.template('<li class="tutor-card"></li>')},initialize:function(e){this.$list=$(this.temp.list(e.subject)),this.$el.html(this.$list),this.$list=this.$list.find(".tutor-list")},append:function(e){var t=$(this.temp.item());Eggshell.create("C.common.tutors.tutor",{el:t}).trigger("get tbs tutor",e),this.$list.append(t)}}),s=(Backbone.View.extend({temp:{list:_.template('<div class="list"></div>'),item:_.template('<div class="item"></div>')},initialize:function(){this.$list=$(this.temp.list(opts.subject)),this.$el.html(this.$list)},append:function(e){this.$list.append(this.temp.item(e))}}),Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(s,i){if(i&&i.id&&i.name){var r=this.$el.append("<li></li>"),n=new t({el:r,subject:{id:i.id,nameOriginal:i.name,name:i.name,url:i.url.replace("?","-online-tutoring/?")}}),o=new e;o.on("loaded",function(e){"tutors"in e&&_.each(e.tutors,function(e){n.append(e)})}),o.on("failToLoad",function(){});o.getTutorsBySubject({subjectId:i.id,subjectName:i.name})}}}));return s}()),Eggshell.define("C.common.search.result.category",{inputs:{render:{payload:{component:"string",id:"string",searchBy:"string",type:"string",url:"string"}}},outputs:{},strict:!1},function(){var e=Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(e,t){var s=t.searchBy.charAt(0).toUpperCase()+t.searchBy.slice(1);s=$("<div/>").text(s).html();var i=t.url+"&event=filter_submit&filterloc=segue";this.$el.append($('<a href="'+i+'"><div class="search-link"><div class="icon-chegg-search"></div><span class="chg-suggest-term search-query">'+s+'</span><span class="search-type"> in '+t.type+"</span></div></a>"))}});return e}()),Eggshell.define("C.common.search.result.tutor",{inputs:{render:{payload:{id:"string",url:"string",name:"string",searchBy:"string"}}},outputs:{},strict:!1},function(){var e=Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(e,t){var s=this.renderUrl(t.url);this.$el.html(this.subjectTemplate({subject:{id:t.id,url:s,nameOriginal:t.name,name:this.highlightText(t)}})),$(".C-common-search-groupV1_6 .category-name").css("padding-top","10px")},renderUrl:function(e){var t=e.substr(0,e.indexOf("?")),s=e.substr(e.indexOf("?"));return e=C.global.instaEdu?"tutors/"+t+"-online-tutoring/"+s:"search/"+t+"/tutors"+s,e=C.global.liveSiteUrl+e},highlightText:function(e){var t='<span class="highlighted-text">$1</span>',s=e.searchBy,i=new RegExp("("+this.regExpQuote(s)+")","i");return e.name.replace(i,t)},regExpQuote:function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},subjectTemplate:_.template('<a href="<%= subject.url %>"><div class="tutor-subject-result" data-name="<%= subject.nameOriginal %>" id="<%= subject.id %>"><%= subject.name %></div></a>')});return e}()),Eggshell.define("C.search.mobile.FederatedSearch",{inputs:{find:{query:"string",filter:"string",page:"string"},reset:{},recover:{}},output:{"before find":{query:"string",filter:"string",page:"string"}}},function(){var e=Backbone.View.extend({search:null,track:null,query:null,lastFilter:null,lastPage:null,withoutFed:!1,initialize:function(e){this.$el=e.el,this.withoutFed=e.withoutAllMathes,this.search=Eggshell.create("C.common.search",{el:this.$el}),this.track=Eggshell.find("C.search.trackid");var t=this;Eggshell.create("C.search.configuration").trigger("get mobile filters config",function(e){t.filters=e}),this.Eggshell.listen("find",this.find),this.Eggshell.listen("reset",this.reset),this.Eggshell.listen("recover",this.setFilterListeners),this.Eggshell.listen("destroy",this.destroy),this.setFilterListeners()},find:function(e,t){this.query=t.query;var s=t.filter||this.lastFilter||"all",i=t.page||this.lastPage||null;this.withoutFed&&"all"==s&&(s="books"),this.Eggshell.trigger("before find",{query:this.query,filter:s,page:i});var r=this.getProfile(this.query,s,i);this.search.trigger("set query",{query:this.query}).trigger("render with profile id",{profile:r})},reset:function(){this.lastFilter=null,this.search&&this.search.trigger("hide results")},getProfile:function(e,t,s){var i=e.split(" ").length,r=i>15,n=this.filters[t];return null!==s&&n.filters&&n.filters[s]&&(n=n.filters[s]),r&&n.queryIntentProfileId?n.queryIntentProfileId:n.profileId},setFilterListeners:function(){var e=this,t=_.keys(e.filters);_.each(t,function(t){if(e.$el.on("click.FederatedSearch",'[data-id="'+t+'"]',function(){return Eggshell.find(e).trigger("find",{query:e.query,filter:t}),e.lastFilter=t,e.lastPage=null,!1}),_.isObject(e.filters[t].filters)){var s=_.keys(e.filters[t].filters);_.each(s,function(s){e.$el.on("click.FederatedSearch",'[data-id="'+s+'"]',function(){return Eggshell.find(e).trigger("find",{query:e.query,filter:t,page:s}),e.lastFilter=t,e.lastPage=s,!1})})}}),e.$el.on("click.FederatedSearch",'[data-id="findByQuery"]',function(){var t=$(this).data("query");return Eggshell.find(e).trigger("find",{query:t,filter:e.lastFilter,page:e.lastPage}),!1})},destroy:function(){this.$el.off("click.FederatedSearch"),null!==this.search&&this.search.trigger("destroy"),null!==this.track&&this.track.trigger("destroy")}});return e}()),Eggshell.define("C.search.mobile.FederatedSearchbar",{input:["open","close"],
output:["opened","closed"]},function(){var e=Backbone.View.extend({actions:["open","close"],current_value:"",init_first:!0,focus_input:!0,history_id:"FederatedSearch",search_title:"Search",active:!1,first_open:!0,history:{name:"federated-search-dialog",set:"open",unset:"close",setEvent:"opened",unsetEvent:"closed"},_searchTpl:_.template('<form class="form" action="javascript:;"><input type="search" class="input" name="search" placeholder="Search by title, author or ISBN"><span class="cancel">Cancel</span></form><div class="results-outer-box"></div>'),test:function(){return!!document.querySelector(".FederatedSearchbar")},initialize:function(){this.$el.html(this._searchTpl()),this.$el.hide(),this.generate(),this.searchDialog=Eggshell.create("C.search.mobile.SearchDialog"),this.searchDialog.trigger("set elements",this.elements),Eggshell.find(this).on("close search",this.closeSearch).on("on search open",this.onSearchOpen).on("on search close",this.onSearchClose).on("fetch data",this.fetchData),this.attach()},closeSearch:function(){this.active=!1,this.elements.background.show()},generate:function(){var e=this;this.elements={body:$("body"),background:$("section.Page, header.Toolbar"),search_dialog:this.$el,search:$('input[name="search"]',this.$el),results:$(".results-outer-box",this.$el),form:$("form",this.$el),search_icon:$(".Toolbar .search"),cancel:$(".cancel",this.$el),close:$(""),search_handle:$(".open-chegg-oc-search"),search_field:$(".page-searchbar input.open-search")},this.filter=this.elements.search_field.length&&this.elements.search_field.data("filter")?this.elements.search_field.data("filter"):"",this.isNotApp=!this.elements.body.hasClass("in-app"),this.elements.form.attr("action","javascript:;"),this.should_be_hidden=this.$el.hasClass("hidden"),this.federatedSearch=Eggshell.create("C.search.mobile.FederatedSearch",{el:this.elements.results,withoutAllMathes:this.$el.hasClass("without-all-matches")}),this.federatedSearch.on("before find",function(t,s){e.elements.results.removeClass("empty-results"),e.elements.search.val(s.query)}),$(this.elements.search_handle).click(function(t){e.active=!0})},onSearchOpen:function(){this.$el.show();var e=this.elements.search.val();this.active&&(this.isNotApp===!0&&this.elements.background.hide(),this.elements.body.css("overflow","hidden"),$(".native-dialog").css("position","absolute"),this.elements.results.addClass("mobile-overflow").addClass("empty-results")),this.Eggshell.trigger("opened"),this.first_open||this.federatedSearch.trigger("recover"),e&&this.federatedSearch.trigger("find",{query:e,filter:this.filter}),this.first_open=!1},onSearchClose:function(){this.elements.body.css("overflow","auto"),$(".native-dialog").css("position","fixed"),this.Eggshell.trigger("closed"),this.elements.results.removeClass("mobile-overflow")},reset:function(){this.federatedSearch.trigger("reset")},fetchData:function(e,t){this.elements.results.removeClass("empty-results"),this.federatedSearch.trigger("find",{query:t,filter:this.filter})},attach:function(){this.searchDialog.trigger("attach search"),$(this.elements.search_handle).keyup(function(e){e.preventDefault()})}});return e}()),Eggshell.define("C.search.mobile.dialog",{},function(){var e=Backbone.Model.extend({defaults:{hidden:!0,headline:"Search",baseLine:"",isFullPage:!0,closeTitle:"Cancel"}}),t=Backbone.View.extend({_dialogTpl:_.template('<div class="native-dialog hidden"><div class="wrapper"><div class="content"></div></div></div>'),initialize:function(t){this.$el.html(this._dialogTpl()),this.model=new e(t),this.elements={back:this.$el.find(".cancel"),title:this.$el.find(".title"),right:this.$el.find(".right"),wrapper:this.$el.find(".wrapper"),content:this.$el.find(".content")},this.stack=[],this.attach()},attach:function(){Eggshell.find(this).on("push",this.push).on("show",this.show).on("hide",this.close),this.elements.back.on("click",this.back.bind(this)),this.elements.right.on("click",this.right.bind(this))},show:function(){Eggshell.find("C.search.mobile.FederatedSearchbar").trigger("on search open");var e=this.stack[this.stack.length-1];this.open=!0,this.elements.wrapper.css("top",window.innerHeight),this.$el.find(".native-dialog").removeClass("hidden"),this.elements.wrapper.animate({top:0},function(){this.elements.top_element=e.element}.bind(this))},close:function(){this.open=!1,Eggshell.find("C.search.mobile.FederatedSearchbar").trigger("on search close"),this.elements.wrapper.animate({top:window.innerHeight},$.proxy(function(){this.$el.find(".native-dialog").addClass("hidden")},this))},updateRightButton:function(e){e.right_button?(this.elements.right.html(e.right_button),this.elements.right.removeClass("hidden")):this.elements.right.addClass("hidden")},updateLeftButton:function(e){var t=e.left_button||"cancel";1==this.stack.length?(this.elements.back.html(t),this.elements.back.removeClass("back")):(this.elements.back.html("back"),this.elements.back.addClass("back"))},updateTitle:function(e){this.elements.title.html(e.title)},createWrapper:function(e){var t=$('<div class="wrapper"></div>');t.append(e.element),e.element=t,e.element.attr("data-index",this.stack.length),e.index=this.stack.length},push:function(e,t){var s=this.elements.top_element?this.$el.find(".native-dialog").width():0;this.createWrapper(t),this.stack.push(t),this.updateRightButton(t),this.updateLeftButton(t),this.updateTitle(t),t.element.css({left:s,"z-index":this.stack.length}),this.elements.content.append(t.element),this.elements.top_element?t.element.animate({left:0},function(){var e=this.elements.top_element.attr("data-index");this.elements.top_element.detach(),this.elements.top_element=t.element,helpers.call(this.stack[e],"onHide"),this.open&&helpers.call(t,"onShow")}.bind(this)):this.show()},replace:function(e){var t=this.stack.pop(),s=this.elements.top_element?this.$el.find(".native-dialog").width():0;this.createWrapper(e),this.stack.push(e),this.updateRightButton(e),this.updateLeftButton(e),this.updateTitle(e),e.element.css({left:s,"z-index":this.stack.length}),t&&t.element.css({"z-index":this.stack.length-1}),this.elements.content.append(e.element),this.elements.top_element?e.element.animate({left:0},function(){this.elements.top_element.attr("data-index");this.elements.top_element.remove(),this.elements.top_element=e.element,helpers.call(t,"onHide"),helpers.call(e,"onShow")}.bind(this)):this.show()},pop:function(){var e=this.stack.pop(),t=this.stack[this.stack.length-1];return 0==this.stack.length?(helpers.call(e,"onHide"),void this.close()):(this.elements.content.append(t.element),void e.element.animate({left:window.innerWidth},function(){e.element.remove(),this.elements.top_element=t.element,this.updateRightButton(t),this.updateLeftButton(t),this.updateTitle(t),helpers.call(e,"onHide"),helpers.call(t,"onShow")}.bind(this)))},back:function(){this.pop()},right:function(){var e=this.elements.top_element.attr("data-index");helpers.call(this.stack[e],"onButtonClick")},setTitle:function(e,t){var s=this.stack[this.stack.length-1];s&&(s.title=e,this.updateTitle(s),t&&t())},setRightButton:function(e,t,s){var i=this.stack[this.stack.length-1];i&&(i.right_button=e,this.updateRightButton(i),s&&s())}});return t}()),Eggshell.define("C.search.mobile.loader",{inputs:{show:null,hide:null},output:{}},function(){var e=Backbone.View.extend({options:{target:null},initialize:function(){this.element=$('<span class="Loader"></span>'),Eggshell.find(this).on("show",this.show).on("hide",this.hide).on("destroy",this.destroy)},show:function(e,t){return this.$el.append(this.element),t.append(this.$el),this.$el.show(),this},hide:function(){return this.$el.hide(),this},destroy:function(){this.element&&this.element.remove()}});return e}()),Eggshell.define("C.search.mobile.SearchDialog",{inputs:{"attach search":{},"set elements":{}},output:{}},function(){var e=Backbone.View.extend({initialize:function(e){Eggshell.find(this).on("attach search",this.attachSearch).on("set elements",this.setElements)},setElements:function(e,t){this.elements=t,this.min_chars=3,this.should_be_hidden=this.elements.search_dialog.hasClass("hidden")},onHide:function(){this.$search_opened=!1,this.elements.search.val(""),this.current_value="",this.elements.search_dialog.removeClass("fs-dialog"),this.should_be_hidden&&this.elements.search_dialog.addClass("hidden"),Eggshell.find("FederatedSearch").trigger("reset"),this.onSearchClose&&this.onSearchClose()},openSearch:function(){return this.$search_opened?void 0:(this.$search_opened=!0,this.elements.search_dialog.addClass("fs-dialog"),document.activeElement.blur(),this.elements.search_handle.blur(),Eggshell.create("C.search.mobile.dialog").trigger("push",{element:this.elements.search_dialog}),this.should_be_hidden&&this.elements.search_dialog.removeClass("hidden"),this.focus_input&&($(this.elements.search).focus(),setTimeout(function(){$(this.elements.search).focus()}.bind(this),1e3),window.scrollTo(0,1)),this.attachSearchInternals(),this)},closeSearch:function(e){if(this.$search_opened){this.$search_opened=!1,Eggshell.find("C.search.mobile.dialog").trigger("hide"),Eggshell.find("C.search.mobile.FederatedSearchbar").trigger("close search"),this.elements.search.blur();var t=$(".back.cancel");return t.length?void t.click().off("click"):this}},attachSearch:function(){var e=this;return this.$delegates={itemClick:function(t){e.itemClick(this,t)},submit:function(t){e.search(t),e.elements.search.blur()},paste:function(t){setTimeout(function(){e.search({})},20)}},$(this.elements.search_handle).click($.proxy(this.openSearch,this)),$(this.elements.search_handle).keyup($.proxy(this.typingIntoHandle,this)),$(this.elements.search_handle).is(":focus")&&this.typingIntoHandle(),$(this.elements.cancel).click($.proxy(this.closeSearch,this)),this},attachSearchInternals:function(){var e=this;$(this.elements.search).on("keyup",$.proxy(this.search,this)),$(this.elements.results).on("touchstart",$.proxy(this.closeKeyboard(),this)),this.elements.results.on("click",".result",this.$delegates.itemClick),$.each(this.elements.search,function(){this.addEventListener("paste",e.$delegates.paste)}),this.elements.form&&this.elements.form.on("submit",this.$delegates.submit)},syncInputText:function(){var e=this.elements.search_handle.val();e&&(this.elements.search.val(e),this.elements.search_handle.val(""))},typingIntoHandle:function(){this.openSearch(),this.syncInputText(),this.search()},closeKeyboard:function(){this.elements.search.blur()},detachSearch:function(){return this.element.off("click",".close",this.closeSearch),this.elements.results.off("click",".result",this.$delegates.itemClick),this.elements.form&&this.elements.form.off("submit",this.$delegates.submit),this},search:function(e){var t=this.elements.search.val();if(e&&27==e.keyCode)return this.closeSearch();if(!(t.length<this.min_chars)&&t!=this.current_value)return this.current_value=t,Eggshell.find("C.search.mobile.FederatedSearchbar").trigger("fetch data",t),this}});return e}());}